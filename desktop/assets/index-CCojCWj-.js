(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))d(v);new MutationObserver(v=>{for(const g of v)if(g.type==="childList")for(const R of g.addedNodes)R.tagName==="LINK"&&R.rel==="modulepreload"&&d(R)}).observe(document,{childList:!0,subtree:!0});function f(v){const g={};return v.integrity&&(g.integrity=v.integrity),v.referrerPolicy&&(g.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?g.credentials="include":v.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function d(v){if(v.ep)return;v.ep=!0;const g=f(v);fetch(v.href,g)}})();const Ns="modulepreload",Ds=function(rt){return"/desktop/"+rt},kr={},Cs=function(l,f,d){let v=Promise.resolve();if(f&&f.length>0){let w=function(m){return Promise.all(m.map(a=>Promise.resolve(a).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};var R=w;document.getElementsByTagName("link");const E=document.querySelector("meta[property=csp-nonce]"),k=E?.nonce||E?.getAttribute("nonce");v=w(f.map(m=>{if(m=Ds(m),m in kr)return;kr[m]=!0;const a=m.endsWith(".css"),b=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${b}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":Ns,a||(u.as="script"),u.crossOrigin="",u.href=m,k&&u.setAttribute("nonce",k),document.head.appendChild(u),a)return new Promise((N,L)=>{u.addEventListener("load",N),u.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${m}`)))})}))}function g(E){const k=new Event("vite:preloadError",{cancelable:!0});if(k.payload=E,window.dispatchEvent(k),!k.defaultPrevented)throw E}return v.then(E=>{for(const k of E||[])k.status==="rejected"&&g(k.reason);return l().catch(g)})};function As(rt={}){const{immediate:l=!1,onNeedRefresh:f,onOfflineReady:d,onRegistered:v,onRegisteredSW:g,onRegisterError:R}=rt;let E,k;const w=async(a=!0)=>{await k};async function m(){if("serviceWorker"in navigator){if(E=await Cs(async()=>{const{Workbox:a}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:a}},[]).then(({Workbox:a})=>new a("/desktop/sw.js",{scope:"/desktop/",type:"classic"})).catch(a=>{R?.(a)}),!E)return;E.addEventListener("activated",a=>{(a.isUpdate||a.isExternal)&&window.location.reload()}),E.addEventListener("installed",a=>{a.isUpdate||d?.()}),E.register({immediate:l}).then(a=>{g?g("/desktop/sw.js",a):v?.(a)}).catch(a=>{R?.(a)})}}return k=m(),w}const Oe=document.getElementById("desktop");class Ms{constructor(l,f){this.fs=l,this.wm=f,this.currentPath=["home","reeyuki"],this.history=[],this.historyIndex=-1,this.username="reeyuki",this.hostname="desktop-os",this.printQueue=Promise.resolve(),this.commands={},this.pageLoadTime=Date.now(),this.isPrinting=!1,this.inputBuffer="",this.printDepth=0,this.registerDefaultCommands()}async print(l,f=null,d=!1,v=null,g=30){this.printDepth++,this.printDepth===1&&(this.isPrinting=!0,this.inputBuffer=this.terminalInput.value,this.terminalInput.value="",this.terminalInputLine.style.display="none");const R=document.createElement("div"),E=document.createElement("span");if(d){const k=document.createElement("span");k.textContent=v||this.terminalPrompt.textContent,k.style.color="white",R.appendChild(k),R.appendChild(E)}else f&&(E.style.color=f),R.appendChild(E);this.terminalOutput.appendChild(R);for(let k=0;k<l.length;k++)E.textContent+=l[k],await new Promise(w=>setTimeout(w,g)),this.terminalOutput.parentElement.scrollTop=this.terminalOutput.parentElement.scrollHeight;this.printDepth--,this.printDepth===0&&(this.isPrinting=!1,this.terminalInputLine.style.display="flex",this.terminalInput.value=this.inputBuffer,this.terminalInput.focus())}enqueuePrint(l,f=null,d=!1,v=null,g=6){return this.printQueue=this.printQueue.then(()=>this.print(l,f,d,v,g)),this.printQueue}setupEventHandlers(){this.terminalInput.addEventListener("keydown",l=>{if(l.key==="Enter"){l.preventDefault();const f=this.terminalInput.value.trim();if(!f)return;this.history.push(f),this.historyIndex=this.history.length,this.terminalInput.value="",this.executeCommand(f)}else l.key==="ArrowUp"&&this.historyIndex>0?(l.preventDefault(),this.terminalInput.value=this.history[--this.historyIndex]):l.key==="ArrowDown"?(l.preventDefault(),this.historyIndex=Math.min(this.historyIndex+1,this.history.length),this.terminalInput.value=this.historyIndex<this.history.length?this.history[this.historyIndex]:""):l.key==="Tab"?(l.preventDefault(),this.handleTabCompletion()):l.ctrlKey&&l.key==="l"?(l.preventDefault(),this.cmdClear()):l.ctrlKey&&l.key==="c"&&(l.preventDefault(),this.enqueuePrint("^C","white",!0,this.terminalPrompt.textContent),this.terminalInput.value="")}),document.getElementById("terminal-win").addEventListener("click",()=>{this.terminalInput.focus()})}expandGlob(l,f){const d=Object.keys(this.fs.getFolder(f)),v=new RegExp("^"+l.replace(/\*/g,".*").replace(/\?/g,".")+"$");return d.filter(g=>v.test(g))}expandGlobsInArgs(l,f){const d=[];for(const v of l)if(v.includes("*")||v.includes("?")){const g=this.expandGlob(v,f);g.length>0?d.push(...g):d.push(v)}else d.push(v);return d}parseCommand(l){return l.split("|").map(d=>d.trim()).map(d=>{const g=(d.match(/(?:[^\s"]+|"[^"]*")+/g)||[]).map(w=>w.replace(/^"(.*)"$/,"$1")),R=g[0],E=[],k=[];for(let w=1;w<g.length;w++)g[w].startsWith("-")?k.push(g[w]):E.push(g[w]);return{command:R,args:E,flags:k}})}async executePipeline(l){let f=null;for(let d=0;d<l.length;d++){const{command:v,args:g,flags:R}=l[d],E=this.expandGlobsInArgs(g,this.currentPath);f!==null&&E.unshift(f);const k=this.commands[v];if(!k){v&&await this.enqueuePrint(`bash: ${v}: command not found`);return}d<l.length-1?f=await this.captureOutput(()=>k(E,R)):await k(E,R)}}async captureOutput(l){const f=this.print.bind(this),d=[];return this.print=async v=>{d.push(v)},await l(),await this.printQueue,this.print=f,d.join(`
`)}async executeCommand(l){await this.enqueuePrint(l,null,!0,this.terminalPrompt.textContent);const f=this.parseCommand(l);await this.executePipeline(f),this.updatePrompt()}handleTabCompletion(){const l=this.terminalInput.value,f=this.terminalInput.selectionStart,d=l.slice(0,f),v=d.match(/(\S+)$/);if(!v)return;const g=v[1],R=d.slice(0,d.length-g.length);let E,k;if(g.includes("/")){const a=g.split("/");k=a.pop(),E=this.fs.resolvePath(a.join("/"),this.currentPath)}else E=[...this.currentPath],k=g;let w;try{w=Object.keys(this.fs.getFolder(E))}catch{return}const m=w.filter(a=>a.startsWith(k));if(m.length)if(m.length===1){const a=m[0]+(this.fs.isFile(E,m[0])?"":"/");this.terminalInput.value=R+a+l.slice(f),this.terminalInput.selectionStart=this.terminalInput.selectionEnd=R.length+a.length}else{const a=m.reduce((b,u)=>{let N=0;for(;N<b.length&&N<u.length&&b[N]===u[N];)N++;return b.slice(0,N)},m[0]);a.length>k.length?(this.terminalInput.value=R+a+l.slice(f),this.terminalInput.selectionStart=this.terminalInput.selectionEnd=R.length+a.length):this.print(m.join("  "))}}open(){const l=document.getElementById("terminal-win");if(l)return this.wm.bringToFront(l);const f=this.wm.createWindow("terminal-win","Terminal","700px","500px");Object.assign(f.style,{left:"200px",top:"100px"}),f.innerHTML=`
      <div class="window-header">
        <span>Terminal</span>
        <div class="window-controls">
          <button class="minimize-btn">−</button>
          <button class="maximize-btn">□</button>
          <button class="close-btn">X</button>
        </div>
      </div>
      <div class="window-content" style="background:#000;color:white;font-family:monospace;padding:10px;overflow-y:auto;height:calc(100% - 40px);">
        <div id="terminal-output" style="white-space:pre;"></div>
        <div id="terminal-input-line" style="display:flex;">
          <span id="terminal-prompt"></span>
          <input id="terminal-input" style="flex:1;background:transparent;border:none;color:white;font-family:monospace;outline:none;margin-left:5px;">
        </div>
      </div>
    `,Oe.appendChild(f),this.wm.makeDraggable(f),this.wm.makeResizable(f),this.wm.setupWindowControls(f),this.wm.addToTaskbar(f.id,"Terminal","/static/icons/terminal.png"),this.terminalOutput=f.querySelector("#terminal-output"),this.terminalInput=f.querySelector("#terminal-input"),this.terminalPrompt=f.querySelector("#terminal-prompt"),this.terminalInputLine=f.querySelector("#terminal-input-line"),this.updatePrompt(),this.print("Welcome to Reeyuki's terminal"),this.print(`Type 'help' for available commands
`),this.setupEventHandlers(),this.terminalInput.focus()}updatePrompt(){const l=this.currentPath.length?"/"+this.currentPath.join("/"):"/";this.terminalPrompt.textContent=`${this.username}@${this.hostname}:${l}$ `}registerCommand(l,f){this.commands[l]=f}registerDefaultCommands(){this.registerCommand("help",()=>this.cmdHelp()),this.registerCommand("clear",()=>this.cmdClear()),this.registerCommand("pwd",()=>this.print(this.currentPath.length?"/"+this.currentPath.join("/"):"/")),this.registerCommand("ls",(l,f)=>this.cmdLs(l,f)),this.registerCommand("cd",l=>this.cmdCd(l)),this.registerCommand("mkdir",l=>this.cmdMkdir(l)),this.registerCommand("touch",l=>this.cmdTouch(l)),this.registerCommand("rm",(l,f)=>this.cmdRm(l,f)),this.registerCommand("cat",l=>this.cmdCat(l)),this.registerCommand("echo",l=>this.print(l.join(" "))),this.registerCommand("whoami",()=>this.print(this.username)),this.registerCommand("hostname",()=>this.print(this.hostname)),this.registerCommand("date",()=>this.print(new Date().toString())),this.registerCommand("history",()=>this.history.forEach((l,f)=>this.print(`  ${f+1}  ${l}`))),this.registerCommand("tree",()=>this.cmdTree()),this.registerCommand("uname",()=>this.print("Linux reeyuki-desktop 6.1.23-arch1-1 #1 SMP PREEMPT x86_64 GNU/Linux")),this.registerCommand("ping",l=>this.cmdPing(l)),this.registerCommand("curl",l=>this.cmdCurl(l)),this.registerCommand("neofetch",()=>this.cmdNeofetch()),this.registerCommand("ps",()=>this.cmdPs()),this.registerCommand("grep",l=>this.cmdGrep(l)),this.registerCommand("wc",l=>this.cmdWc(l))}cmdClear(){this.terminalOutput.innerHTML=""}cmdLs(l=[],f=[]){const d=f.some(a=>a.includes("a")),v=f.some(a=>a.includes("l")),g=f.some(a=>a.includes("h")),R=f.some(a=>a.includes("R")),E=f.some(a=>a.includes("r")),k=a=>{if(!g)return a;const b=["B","K","M","G"];let u=0,N=a;for(;N>=1024&&u<b.length-1;)N/=1024,u++;return`${Math.round(N)}${b[u]}`},w=(a,b="")=>{try{const u=this.fs.getFolder(a);let N=Object.keys(u);d||(N=N.filter(L=>!L.startsWith("."))),E&&(N=N.reverse()),N.forEach(L=>{const O=this.fs.isFile(a,L),C=v?`${O?"-":"d"} ${L}${O?"":"/"}${O&&u[L].size!=null?` ${k(u[L].size)}`:""}`:L+(O?"":"/");this.print(b+C,O?null:"blue"),R&&!O&&w(this.fs.resolvePath(L,a),b+"  ")})}catch{this.print(`ls: cannot access '${a}': No such file or directory`)}},m=l.length?this.fs.resolvePath(l[0],this.currentPath):this.currentPath;w(m)}cmdCd(l){if(!l.length||l[0]==="~"){this.currentPath=["home",this.username];return}try{const f=this.fs.resolvePath(l[0],this.currentPath);this.fs.getFolder(f),this.currentPath=f}catch{this.print(`cd: ${l[0]}: No such file or directory`)}}cmdMkdir(l){if(!l.length)return this.print("mkdir: missing operand");l.forEach(f=>{this.fs.createFolder(this.currentPath,f),this.print(`Created directory: ${f}`)})}cmdTouch(l){if(!l.length)return this.print("touch: missing file operand");l.forEach(f=>{this.fs.createFile(this.currentPath,f,""),this.print(`Created file: ${f}`)})}cmdRm(l=[],f=[]){if(!l.length)return this.print("rm: missing operand");const d=f.some(R=>R.includes("r")),v=f.some(R=>R.includes("f")),g=R=>{try{const E=R.slice(0,-1),k=R[R.length-1];if(this.fs.isFile(E,k))this.fs.deleteItem(E,k);else{if(!d)throw new Error("is a directory");Object.keys(this.fs.getFolder(R)).forEach(m=>g([...R,m])),this.fs.deleteItem(E,k)}}catch(E){v||this.print(`rm: cannot remove '${R.join("/")}': ${E.message}`)}};l.forEach(R=>{let E=R.startsWith("/")?this.fs.resolvePath(R,[]):this.fs.resolvePath(R,this.currentPath);g(E)})}cmdCat(l){if(!l.length)return this.print("cat: missing file operand");l.forEach(f=>{f.includes(`
`)?this.print(f):this.fs.isFile(this.currentPath,f)?this.print(this.fs.getFileContent(this.currentPath,f)||"(empty file)"):this.print(`cat: ${f}: Is a directory`)})}cmdGrep(l){if(l.length<1)return this.print("grep: missing pattern");const f=l[0],v=l.slice(1).join(" ").split(`
`),g=new RegExp(f,"i");v.forEach(R=>{g.test(R)&&this.print(R)})}cmdWc(l){const f=l.join(" "),d=f.split(`
`).filter(R=>R.length>0),v=f.split(/\s+/).filter(R=>R.length>0),g=f.length;this.print(`  ${d.length}  ${v.length}  ${g}`)}cmdTree(l=this.currentPath,f=""){f||this.print(l.length?"/"+l.join("/"):"/");const d=Object.keys(this.fs.getFolder(l));d.forEach((v,g)=>{const R=this.fs.isFile(l,v),E=g===d.length-1;this.print(f+(E?"└── ":"├── ")+v+(R?"":"/")),R||this.cmdTree([...l,v],f+(E?"    ":"│   "))})}async cmdPing(l){if(!l.length)return this.print("Usage: ping <host>");await this.print(`PING ${l[0]} ...`);const f=performance.now();try{await fetch("https://"+l[0],{method:"HEAD",mode:"no-cors"})}catch(d){console.error(d)}await this.print(`Reply from ${l[0]}: time=${(performance.now()-f).toFixed(2)}ms`)}async cmdCurl(l){if(!l.length)return this.print("Usage: curl <url>");try{const f=await(await fetch(l[0])).text();this.print(f.slice(0,1e3))}catch{this.print(`curl: (6) Could not resolve host: ${l[0]}`)}}async cmdNeofetch(){const l=navigator.userAgent,f=navigator.userAgentData?.platform||navigator.platform||l||"Unknown";let d="Unknown";/Windows/i.test(f)?d="Windows":/Mac/i.test(f)?d="macOS":/Android/i.test(f)?d="Android":/iPhone|iPad|iOS/i.test(f)?d="iOS":/Linux/i.test(f)&&(d="Linux");const v=d==="Windows"?"Eww a windows!":d;let g="Unknown";/Firefox\/\d+/i.test(l)?g="Firefox":/Edg\/\d+/i.test(l)?g="Edge":/Chrome\/\d+/i.test(l)?g="Chrome":/Safari\/\d+/i.test(l)&&(g="Safari");const R=g==="Chrome"||g==="Edge"?"eww a chromium?!":g,E=navigator.hardwareConcurrency??"Unknown",k=typeof E=="number"&&E>10?`${E} (WOW ITS SO BIG!)`:E;let w="Unknown",m=0;try{const C=document.createElement("canvas"),A=C.getContext("webgl2")||C.getContext("webgl");if(A){w=A.getParameter(A.RENDERER);const J=A.getParameter(A.MAX_TEXTURE_SIZE),B=A.getParameter(A.MAX_VARYING_VECTORS),H=A.getParameter(A.MAX_VERTEX_UNIFORM_VECTORS);m=Math.min(8,Math.floor((J/2048+B/16+H/128)*1.2))}}catch(C){console.error(C)}let a="Unknown";typeof InstallTrigger<"u"?a="SpiderMonkey":typeof window.chrome<"u"?a="V8":/Apple/.test(navigator.vendor)&&(a="JavaScriptCore");const b=navigator.deviceMemory?`${navigator.deviceMemory} GB`:"Unknown",u=navigator.doNotTrack==="1"||window.doNotTrack==="1"?"Enabled":"Disabled",N=Date.now()-this.pageLoadTime,L=`${Math.floor(N/36e5)}h, ${Math.floor(N%36e5/6e4)}m`,O=["","","                     "+this.username+"@"+this.hostname,`        /\\           OWOS     ${v}`,`       /  \\          KEWNEL   ${a}wu`,`      /\\   \\         CPUWU    Cwpu Cowes: ${k}`,`     / > ω <\\        BROWSEWU  ${R}`,`    /   __   \\       GWAPHU    ${w}`,`   / __|  |__-\\      WENDAWU   ${m}`,`  /_-''    ''-_\\     MEMOWY    ${b}`,`                     DoNawtTWACKWU  ${u}`,`                     RESOWUW   ${window.innerWidth}x${window.innerHeight}`,`                     UWUPTIME  ${L}`];for(const C of O)await this.enqueuePrint(C)}cmdPs(){const l=Array.from(document.querySelectorAll(".window"));this.print("  PID   TTY      TIME CMD"),l.forEach((f,d)=>{const v=f.querySelector(".window-header span")?.textContent||"unknown";this.print(`  ${1e3+d}  pts/0  0:00 ${v}`)})}cmdHelp(){const l=[["help","Show this help message"],["neofetch","Display system/browser summary"],["clear","Clear the terminal screen"],["ls","List directory contents"],["pwd","Print working directory"],["cd [dir]","Change directory"],["mkdir","Create a new directory"],["touch","Create a new file"],["rm","Remove file or directory"],["cat","Display file contents"],["echo","Display a line of text"],["grep","Search for pattern in input"],["wc","Count lines, words, and characters"],["whoami","Display current user"],["hostname","Display hostname"],["date","Display current date and time"],["history","Show command history"],["tree","Display directory tree"]];this.print("Available commands:"),l.forEach(([f,d])=>this.print(`  ${f.padEnd(10)} - ${d}`)),this.print(""),this.print("Glob patterns: * (match any), ? (match one)"),this.print("Pipes: command1 | command2")}}function Ps(rt){return rt&&rt.__esModule&&Object.prototype.hasOwnProperty.call(rt,"default")?rt.default:rt}var Hn={exports:{}},Bs=Hn.exports,Ir;function Us(){return Ir||(Ir=1,(function(rt,l){(function(d,v){rt.exports=v()})(Bs,function(){return(function(f){var d={};function v(g){if(d[g])return d[g].exports;var R=d[g]={exports:{},id:g,loaded:!1};return f[g].call(R.exports,R,R.exports,v),R.loaded=!0,R.exports}return v.m=f,v.c=d,v.p="",v(0)})([function(f,d,v){(function(g,R,E,k){Object.defineProperty(d,"__esModule",{value:!0});var w=v(2),m=v(9),a;(function(i){i[i.EPERM=1]="EPERM",i[i.ENOENT=2]="ENOENT",i[i.EIO=5]="EIO",i[i.EBADF=9]="EBADF",i[i.EACCES=13]="EACCES",i[i.EBUSY=16]="EBUSY",i[i.EEXIST=17]="EEXIST",i[i.ENOTDIR=20]="ENOTDIR",i[i.EISDIR=21]="EISDIR",i[i.EINVAL=22]="EINVAL",i[i.EFBIG=27]="EFBIG",i[i.ENOSPC=28]="ENOSPC",i[i.EROFS=30]="EROFS",i[i.ENOTEMPTY=39]="ENOTEMPTY",i[i.ENOTSUP=95]="ENOTSUP"})(a||(a={}));var b={};b[a.EPERM]="Operation not permitted.",b[a.ENOENT]="No such file or directory.",b[a.EIO]="Input/output error.",b[a.EBADF]="Bad file descriptor.",b[a.EACCES]="Permission denied.",b[a.EBUSY]="Resource busy or locked.",b[a.EEXIST]="File exists.",b[a.ENOTDIR]="File is not a directory.",b[a.EISDIR]="File is a directory.",b[a.EINVAL]="Invalid argument.",b[a.EFBIG]="File is too big.",b[a.ENOSPC]="No space left on disk.",b[a.EROFS]="Cannot modify a read-only file system.",b[a.ENOTEMPTY]="Directory is not empty.",b[a.ENOTSUP]="Operation is not supported.";var u=(function(i){function t(n,e,r){e===void 0&&(e=b[n]),i.call(this,e),this.syscall="",this.errno=n,this.code=a[n],this.path=r,this.stack=new i().stack,this.message="Error: "+this.code+": "+e+(this.path?", '"+this.path+"'":"")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.fromJSON=function(e){var r=new t(0);return r.errno=e.errno,r.code=e.code,r.path=e.path,r.stack=e.stack,r.message=e.message,r},t.fromBuffer=function(e,r){return r===void 0&&(r=0),t.fromJSON(JSON.parse(e.toString("utf8",r+4,r+4+e.readUInt32LE(r))))},t.FileError=function(e,r){return new t(e,b[e],r)},t.ENOENT=function(e){return this.FileError(a.ENOENT,e)},t.EEXIST=function(e){return this.FileError(a.EEXIST,e)},t.EISDIR=function(e){return this.FileError(a.EISDIR,e)},t.ENOTDIR=function(e){return this.FileError(a.ENOTDIR,e)},t.EPERM=function(e){return this.FileError(a.EPERM,e)},t.ENOTEMPTY=function(e){return this.FileError(a.ENOTEMPTY,e)},t.prototype.toString=function(){return this.message},t.prototype.toJSON=function(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}},t.prototype.writeToBuffer=function(e,r){e===void 0&&(e=g.alloc(this.bufferSize())),r===void 0&&(r=0);var o=e.write(JSON.stringify(this.toJSON()),r+4);return e.writeUInt32LE(o,r),e},t.prototype.bufferSize=function(){return 4+g.byteLength(JSON.stringify(this.toJSON()))},t})(Error),N=Object.freeze({get ErrorCode(){return a},ErrorStrings:b,ApiError:u}),L;(function(i){i[i.NOP=0]="NOP",i[i.THROW_EXCEPTION=1]="THROW_EXCEPTION",i[i.TRUNCATE_FILE=2]="TRUNCATE_FILE",i[i.CREATE_FILE=3]="CREATE_FILE"})(L||(L={}));var O=function i(t){if(this.flagStr=t,i.validFlagStrs.indexOf(t)<0)throw new u(a.EINVAL,"Invalid flag: "+t)};O.getFileFlag=function(t){return O.flagCache.hasOwnProperty(t)?O.flagCache[t]:O.flagCache[t]=new O(t)},O.prototype.getFlagString=function(){return this.flagStr},O.prototype.isReadable=function(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1},O.prototype.isWriteable=function(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1},O.prototype.isTruncating=function(){return this.flagStr.indexOf("w")!==-1},O.prototype.isAppendable=function(){return this.flagStr.indexOf("a")!==-1},O.prototype.isSynchronous=function(){return this.flagStr.indexOf("s")!==-1},O.prototype.isExclusive=function(){return this.flagStr.indexOf("x")!==-1},O.prototype.pathExistsAction=function(){return this.isExclusive()?L.THROW_EXCEPTION:this.isTruncating()?L.TRUNCATE_FILE:L.NOP},O.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"?L.CREATE_FILE:L.THROW_EXCEPTION},O.flagCache={},O.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var C;(function(i){i[i.FILE=32768]="FILE",i[i.DIRECTORY=16384]="DIRECTORY",i[i.SYMLINK=40960]="SYMLINK"})(C||(C={}));var A=function(t,n,e,r,o,s){if(r===void 0&&(r=new Date),o===void 0&&(o=new Date),s===void 0&&(s=new Date),this.size=n,this.atime=r,this.mtime=o,this.ctime=s,this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0,this.birthtime=new Date(0),this.fileData=null,e)this.mode=e;else switch(t){case C.FILE:this.mode=420;break;case C.DIRECTORY:default:this.mode=511}this.blocks=Math.ceil(n/512),this.mode<4096&&(this.mode|=t)};A.fromBuffer=function(t){var n=t.readUInt32LE(0),e=t.readUInt32LE(4),r=t.readDoubleLE(8),o=t.readDoubleLE(16),s=t.readDoubleLE(24);return new A(e&61440,n,e&4095,new Date(r),new Date(o),new Date(s))},A.prototype.toBuffer=function(){var t=g.alloc(32);return t.writeUInt32LE(this.size,0),t.writeUInt32LE(this.mode,4),t.writeDoubleLE(this.atime.getTime(),8),t.writeDoubleLE(this.mtime.getTime(),16),t.writeDoubleLE(this.ctime.getTime(),24),t},A.prototype.clone=function(){return new A(this.mode&61440,this.size,this.mode&4095,this.atime,this.mtime,this.ctime)},A.prototype.isFile=function(){return(this.mode&61440)===C.FILE},A.prototype.isDirectory=function(){return(this.mode&61440)===C.DIRECTORY},A.prototype.isSymbolicLink=function(){return(this.mode&61440)===C.SYMLINK},A.prototype.chmod=function(t){this.mode=this.mode&61440|t},A.prototype.isSocket=function(){return!1},A.prototype.isBlockDevice=function(){return!1},A.prototype.isCharacterDevice=function(){return!1},A.prototype.isFIFO=function(){return!1};var J=function(i,t){return i};function B(i){if(i)return i;throw new u(a.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function H(i,t){switch(typeof i){case"number":return i;case"string":var n=parseInt(i,8);return isNaN(n)?t:n;default:return t}}function St(i){if(i instanceof Date)return i;if(typeof i=="number")return new Date(i*1e3);throw new u(a.EINVAL,"Invalid time.")}function tt(i){if(i.indexOf("\0")>=0)throw new u(a.EINVAL,"Path must be a string without null bytes.");if(i==="")throw new u(a.EINVAL,"Path must not be empty.");return m.resolve(i)}function kt(i,t,n,e){switch(typeof i){case"object":return{encoding:typeof i.encoding<"u"?i.encoding:t,flag:typeof i.flag<"u"?i.flag:n,mode:H(i.mode,e)};case"string":return{encoding:i,flag:n,mode:e};default:return{encoding:t,flag:n,mode:e}}}function dt(){}var z=function(){this.F_OK=0,this.R_OK=4,this.W_OK=2,this.X_OK=1,this.root=null,this.fdMap={},this.nextFd=100};z.prototype.initialize=function(t){if(!t.constructor.isAvailable())throw new u(a.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.");return this.root=t},z.prototype._toUnixTimestamp=function(t){if(typeof t=="number")return t;if(t instanceof Date)return t.getTime()/1e3;throw new Error("Cannot parse time: "+t)},z.prototype.getRootFS=function(){return this.root?this.root:null},z.prototype.rename=function(t,n,e){e===void 0&&(e=dt);var r=J(e,1);try{B(this.root).rename(tt(t),tt(n),r)}catch(o){r(o)}},z.prototype.renameSync=function(t,n){B(this.root).renameSync(tt(t),tt(n))},z.prototype.exists=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{return B(this.root).exists(tt(t),e)}catch{return e(!1)}},z.prototype.existsSync=function(t){try{return B(this.root).existsSync(tt(t))}catch{return!1}},z.prototype.stat=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{return B(this.root).stat(tt(t),!1,e)}catch(r){return e(r)}},z.prototype.statSync=function(t){return B(this.root).statSync(tt(t),!1)},z.prototype.lstat=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{return B(this.root).stat(tt(t),!0,e)}catch(r){return e(r)}},z.prototype.lstatSync=function(t){return B(this.root).statSync(tt(t),!0)},z.prototype.truncate=function(t,n,e){n===void 0&&(n=0),e===void 0&&(e=dt);var r=0;typeof n=="function"?e=n:typeof n=="number"&&(r=n);var o=J(e,1);try{if(r<0)throw new u(a.EINVAL);return B(this.root).truncate(tt(t),r,o)}catch(s){return o(s)}},z.prototype.truncateSync=function(t,n){if(n===void 0&&(n=0),n<0)throw new u(a.EINVAL);return B(this.root).truncateSync(tt(t),n)},z.prototype.unlink=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{return B(this.root).unlink(tt(t),e)}catch(r){return e(r)}},z.prototype.unlinkSync=function(t){return B(this.root).unlinkSync(tt(t))},z.prototype.open=function(t,n,e,r){var o=this;r===void 0&&(r=dt);var s=H(e,420);r=typeof e=="function"?e:r;var c=J(r,2);try{B(this.root).open(tt(t),O.getFileFlag(n),s,function(y,S){S?c(y,o.getFdForFile(S)):c(y)})}catch(y){c(y)}},z.prototype.openSync=function(t,n,e){return e===void 0&&(e=420),this.getFdForFile(B(this.root).openSync(tt(t),O.getFileFlag(n),H(e,420)))},z.prototype.readFile=function(t,n,e){n===void 0&&(n={}),e===void 0&&(e=dt);var r=kt(n,null,"r",null);e=typeof n=="function"?n:e;var o=J(e,2);try{var s=O.getFileFlag(r.flag);return s.isReadable()?B(this.root).readFile(tt(t),r.encoding,s,o):o(new u(a.EINVAL,"Flag passed to readFile must allow for reading."))}catch(c){return o(c)}},z.prototype.readFileSync=function(t,n){n===void 0&&(n={});var e=kt(n,null,"r",null),r=O.getFileFlag(e.flag);if(!r.isReadable())throw new u(a.EINVAL,"Flag passed to readFile must allow for reading.");return B(this.root).readFileSync(tt(t),e.encoding,r)},z.prototype.writeFile=function(t,n,e,r){e===void 0&&(e={}),r===void 0&&(r=dt);var o=kt(e,"utf8","w",420);r=typeof e=="function"?e:r;var s=J(r,1);try{var c=O.getFileFlag(o.flag);return c.isWriteable()?B(this.root).writeFile(tt(t),n,o.encoding,c,o.mode,s):s(new u(a.EINVAL,"Flag passed to writeFile must allow for writing."))}catch(y){return s(y)}},z.prototype.writeFileSync=function(t,n,e){var r=kt(e,"utf8","w",420),o=O.getFileFlag(r.flag);if(!o.isWriteable())throw new u(a.EINVAL,"Flag passed to writeFile must allow for writing.");return B(this.root).writeFileSync(tt(t),n,r.encoding,o,r.mode)},z.prototype.appendFile=function(t,n,e,r){r===void 0&&(r=dt);var o=kt(e,"utf8","a",420);r=typeof e=="function"?e:r;var s=J(r,1);try{var c=O.getFileFlag(o.flag);if(!c.isAppendable())return s(new u(a.EINVAL,"Flag passed to appendFile must allow for appending."));B(this.root).appendFile(tt(t),n,o.encoding,c,o.mode,s)}catch(y){s(y)}},z.prototype.appendFileSync=function(t,n,e){var r=kt(e,"utf8","a",420),o=O.getFileFlag(r.flag);if(!o.isAppendable())throw new u(a.EINVAL,"Flag passed to appendFile must allow for appending.");return B(this.root).appendFileSync(tt(t),n,r.encoding,o,r.mode)},z.prototype.fstat=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{var r=this.fd2file(t);r.stat(e)}catch(o){e(o)}},z.prototype.fstatSync=function(t){return this.fd2file(t).statSync()},z.prototype.close=function(t,n){var e=this;n===void 0&&(n=dt);var r=J(n,1);try{this.fd2file(t).close(function(o){o||e.closeFd(t),r(o)})}catch(o){r(o)}},z.prototype.closeSync=function(t){this.fd2file(t).closeSync(),this.closeFd(t)},z.prototype.ftruncate=function(t,n,e){e===void 0&&(e=dt);var r=typeof n=="number"?n:0;e=typeof n=="function"?n:e;var o=J(e,1);try{var s=this.fd2file(t);if(r<0)throw new u(a.EINVAL);s.truncate(r,o)}catch(c){o(c)}},z.prototype.ftruncateSync=function(t,n){n===void 0&&(n=0);var e=this.fd2file(t);if(n<0)throw new u(a.EINVAL);e.truncateSync(n)},z.prototype.fsync=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{this.fd2file(t).sync(e)}catch(r){e(r)}},z.prototype.fsyncSync=function(t){this.fd2file(t).syncSync()},z.prototype.fdatasync=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{this.fd2file(t).datasync(e)}catch(r){e(r)}},z.prototype.fdatasyncSync=function(t){this.fd2file(t).datasyncSync()},z.prototype.write=function(t,n,e,r,o,s){s===void 0&&(s=dt);var c,y,S,D=null;if(typeof n=="string"){var M="utf8";switch(typeof e){case"function":s=e;break;case"number":D=e,M=typeof r=="string"?r:"utf8",s=typeof o=="function"?o:s;break;default:return s=typeof r=="function"?r:typeof o=="function"?o:s,s(new u(a.EINVAL,"Invalid arguments."))}c=g.from(n,M),y=0,S=c.length}else c=n,y=e,S=r,D=typeof o=="number"?o:null,s=typeof o=="function"?o:s;var q=J(s,3);try{var $=this.fd2file(t);D==null&&(D=$.getPos()),$.write(c,y,S,D,q)}catch(nt){q(nt)}},z.prototype.writeSync=function(t,n,e,r,o){var s,c=0,y,S;if(typeof n=="string"){S=typeof e=="number"?e:null;var D=typeof r=="string"?r:"utf8";c=0,s=g.from(n,D),y=s.length}else s=n,c=e,y=r,S=typeof o=="number"?o:null;var M=this.fd2file(t);return S==null&&(S=M.getPos()),M.writeSync(s,c,y,S)},z.prototype.read=function(t,n,e,r,o,s){s===void 0&&(s=dt);var c,y,S,D,M;if(typeof n=="number"){S=n,c=e;var q=r;s=typeof o=="function"?o:s,y=0,D=g.alloc(S),M=J(function(nt,ut,yt){if(nt)return s(nt);s(nt,yt.toString(q),ut)},3)}else D=n,y=e,S=r,c=o,M=J(s,3);try{var $=this.fd2file(t);c==null&&(c=$.getPos()),$.read(D,y,S,c,M)}catch(nt){M(nt)}},z.prototype.readSync=function(t,n,e,r,o){var s=!1,c,y,S,D,M="utf8";typeof n=="number"?(S=n,D=e,M=r,y=0,c=g.alloc(S),s=!0):(c=n,y=e,S=r,D=o);var q=this.fd2file(t);D==null&&(D=q.getPos());var $=q.readSync(c,y,S,D);return s?[c.toString(M),$]:$},z.prototype.fchown=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{this.fd2file(t).chown(n,e,o)}catch(s){o(s)}},z.prototype.fchownSync=function(t,n,e){this.fd2file(t).chownSync(n,e)},z.prototype.fchmod=function(t,n,e){var r=J(e,1);try{var o=typeof n=="string"?parseInt(n,8):n;this.fd2file(t).chmod(o,r)}catch(s){r(s)}},z.prototype.fchmodSync=function(t,n){var e=typeof n=="string"?parseInt(n,8):n;this.fd2file(t).chmodSync(e)},z.prototype.futimes=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{var s=this.fd2file(t);typeof n=="number"&&(n=new Date(n*1e3)),typeof e=="number"&&(e=new Date(e*1e3)),s.utimes(n,e,o)}catch(c){o(c)}},z.prototype.futimesSync=function(t,n,e){this.fd2file(t).utimesSync(St(n),St(e))},z.prototype.rmdir=function(t,n){n===void 0&&(n=dt);var e=J(n,1);try{t=tt(t),B(this.root).rmdir(t,e)}catch(r){e(r)}},z.prototype.rmdirSync=function(t){return t=tt(t),B(this.root).rmdirSync(t)},z.prototype.mkdir=function(t,n,e){e===void 0&&(e=dt),typeof n=="function"&&(e=n,n=511);var r=J(e,1);try{t=tt(t),B(this.root).mkdir(t,n,r)}catch(o){r(o)}},z.prototype.mkdirSync=function(t,n){B(this.root).mkdirSync(tt(t),H(n,511))},z.prototype.readdir=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{t=tt(t),B(this.root).readdir(t,e)}catch(r){e(r)}},z.prototype.readdirSync=function(t){return t=tt(t),B(this.root).readdirSync(t)},z.prototype.link=function(t,n,e){e===void 0&&(e=dt);var r=J(e,1);try{t=tt(t),n=tt(n),B(this.root).link(t,n,r)}catch(o){r(o)}},z.prototype.linkSync=function(t,n){return t=tt(t),n=tt(n),B(this.root).linkSync(t,n)},z.prototype.symlink=function(t,n,e,r){r===void 0&&(r=dt);var o=typeof e=="string"?e:"file";r=typeof e=="function"?e:r;var s=J(r,1);try{if(o!=="file"&&o!=="dir")return s(new u(a.EINVAL,"Invalid type: "+o));t=tt(t),n=tt(n),B(this.root).symlink(t,n,o,s)}catch(c){s(c)}},z.prototype.symlinkSync=function(t,n,e){if(!e)e="file";else if(e!=="file"&&e!=="dir")throw new u(a.EINVAL,"Invalid type: "+e);return t=tt(t),n=tt(n),B(this.root).symlinkSync(t,n,e)},z.prototype.readlink=function(t,n){n===void 0&&(n=dt);var e=J(n,2);try{t=tt(t),B(this.root).readlink(t,e)}catch(r){e(r)}},z.prototype.readlinkSync=function(t){return t=tt(t),B(this.root).readlinkSync(t)},z.prototype.chown=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{t=tt(t),B(this.root).chown(t,!1,n,e,o)}catch(s){o(s)}},z.prototype.chownSync=function(t,n,e){t=tt(t),B(this.root).chownSync(t,!1,n,e)},z.prototype.lchown=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{t=tt(t),B(this.root).chown(t,!0,n,e,o)}catch(s){o(s)}},z.prototype.lchownSync=function(t,n,e){t=tt(t),B(this.root).chownSync(t,!0,n,e)},z.prototype.chmod=function(t,n,e){e===void 0&&(e=dt);var r=J(e,1);try{var o=H(n,-1);if(o<0)throw new u(a.EINVAL,"Invalid mode.");B(this.root).chmod(tt(t),!1,o,r)}catch(s){r(s)}},z.prototype.chmodSync=function(t,n){var e=H(n,-1);if(e<0)throw new u(a.EINVAL,"Invalid mode.");t=tt(t),B(this.root).chmodSync(t,!1,e)},z.prototype.lchmod=function(t,n,e){e===void 0&&(e=dt);var r=J(e,1);try{var o=H(n,-1);if(o<0)throw new u(a.EINVAL,"Invalid mode.");B(this.root).chmod(tt(t),!0,o,r)}catch(s){r(s)}},z.prototype.lchmodSync=function(t,n){var e=H(n,-1);if(e<1)throw new u(a.EINVAL,"Invalid mode.");B(this.root).chmodSync(tt(t),!0,e)},z.prototype.utimes=function(t,n,e,r){r===void 0&&(r=dt);var o=J(r,1);try{B(this.root).utimes(tt(t),St(n),St(e),o)}catch(s){o(s)}},z.prototype.utimesSync=function(t,n,e){B(this.root).utimesSync(tt(t),St(n),St(e))},z.prototype.realpath=function(t,n,e){e===void 0&&(e=dt);var r=typeof n=="object"?n:{};e=typeof n=="function"?n:dt;var o=J(e,2);try{t=tt(t),B(this.root).realpath(t,r,o)}catch(s){o(s)}},z.prototype.realpathSync=function(t,n){return n===void 0&&(n={}),t=tt(t),B(this.root).realpathSync(t,n)},z.prototype.watchFile=function(t,n,e){throw new u(a.ENOTSUP)},z.prototype.unwatchFile=function(t,n){throw new u(a.ENOTSUP)},z.prototype.watch=function(t,n,e){throw new u(a.ENOTSUP)},z.prototype.access=function(t,n,e){throw new u(a.ENOTSUP)},z.prototype.accessSync=function(t,n){throw new u(a.ENOTSUP)},z.prototype.createReadStream=function(t,n){throw new u(a.ENOTSUP)},z.prototype.createWriteStream=function(t,n){throw new u(a.ENOTSUP)},z.prototype.wrapCallbacks=function(t){J=t},z.prototype.getFdForFile=function(t){var n=this.nextFd++;return this.fdMap[n]=t,n},z.prototype.fd2file=function(t){var n=this.fdMap[t];if(n)return n;throw new u(a.EBADF,"Invalid file descriptor.")},z.prototype.closeFd=function(t){delete this.fdMap[t]},z.Stats=A;var et=new z,lt={},Tt=z.prototype;Object.keys(Tt).forEach(function(i){typeof et[i]=="function"?lt[i]=function(){return et[i].apply(et,arguments)}:lt[i]=et[i]}),lt.changeFSModule=function(i){et=i},lt.getFSModule=function(){return et},lt.FS=z;function mt(i,t,n,e,r){return i<t||n<t?i>n?n+1:i+1:e===r?t:t+1}function Ct(i,t){if(i===t)return 0;if(i.length>t.length){var n=i;i=t,t=n}for(var e=i.length,r=t.length;e>0&&i.charCodeAt(e-1)===t.charCodeAt(r-1);)e--,r--;for(var o=0;o<e&&i.charCodeAt(o)===t.charCodeAt(o);)o++;if(e-=o,r-=o,e===0||r===1)return r;for(var s=new Array(e<<1),c=0;c<e;)s[e+c]=i.charCodeAt(o+c),s[c]=++c;var y,S,D,M,q;for(y=0;y+3<r;)for(var $=t.charCodeAt(o+(S=y)),nt=t.charCodeAt(o+(D=y+1)),ut=t.charCodeAt(o+(M=y+2)),yt=t.charCodeAt(o+(q=y+3)),It=y+=4,Gt=0;Gt<e;){var ae=s[e+Gt],Te=s[Gt];S=mt(Te,S,D,$,ae),D=mt(S,D,M,nt,ae),M=mt(D,M,q,ut,ae),It=mt(M,q,It,yt,ae),s[Gt++]=It,q=M,M=D,D=S,S=Te}for(var Fe=0;y<r;){var ln=t.charCodeAt(o+(S=y));Fe=++y;for(var Me=0;Me<e;Me++){var Pe=s[Me];s[Me]=Fe=Pe<S||Fe<S?Pe>Fe?Fe+1:Pe+1:ln===s[e+Me]?S:S+1,S=Pe}}return Fe}function xt(i,t,n){i&&console.warn("["+t+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the '"+t+".Create("+JSON.stringify(n)+", callback)' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}var Et=typeof navigator<"u"&&!!(/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1),Zt=typeof window>"u";function j(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function U(i,t,n){n.existsSync(i)||(U(m.dirname(i),t,n),n.mkdirSync(i,t))}function K(i){var t=ft(i),n=t.byteOffset,e=t.byteLength;return n===0&&e===t.buffer.byteLength?t.buffer:t.buffer.slice(n,n+e)}function ft(i){return i instanceof Uint8Array?i:new Uint8Array(i)}function Rt(i){return i instanceof g?i:i instanceof Uint8Array?gt(i):g.from(i)}function gt(i){return i instanceof g?i:i.byteOffset===0&&i.byteLength===i.buffer.byteLength?_t(i.buffer):g.from(i.buffer,i.byteOffset,i.byteLength)}function _t(i){return g.from(i)}function Ft(i,t,n){if(t===void 0&&(t=0),n===void 0&&(n=i.length),t<0||n<0||n>i.length||t>n)throw new TypeError("Invalid slice bounds on buffer of length "+i.length+": ["+t+", "+n+"]");if(i.length===0)return Mt();var e=ft(i),r=i[0],o=(r+1)%255;return i[0]=o,e[0]===o?(e[0]=r,gt(e.slice(t,n))):(i[0]=r,gt(e.subarray(t,n)))}var Wt=null;function Mt(){return Wt||(Wt=g.alloc(0))}function T(i,t){g.isBuffer(i)?t():t(new u(a.EINVAL,"option must be a Buffer."))}function F(i,t,n){var e=i.Options,r=i.Name,o=0,s=!1,c=!1;function y(q){s||(q&&(s=!0,n(q)),o--,o===0&&c&&n())}var S=function(q){if(e.hasOwnProperty(q)){var $=e[q],nt=t[q];if(nt==null){if(!$.optional){var ut=Object.keys(t).filter(function(It){return!(It in e)}).map(function(It){return{str:It,distance:Ct(q,It)}}).filter(function(It){return It.distance<5}).sort(function(It,Gt){return It.distance-Gt.distance});return s?{}:(s=!0,{v:n(new u(a.EINVAL,"["+r+"] Required option '"+q+"' not provided."+(ut.length>0?" You provided unrecognized option '"+ut[0].str+"'; perhaps you meant to type '"+q+"'.":"")+`
Option description: `+$.description))})}}else{var yt=!1;if(Array.isArray($.type)?yt=$.type.indexOf(typeof nt)!==-1:yt=typeof nt===$.type,yt)$.validator&&(o++,$.validator(nt,y));else return s?{}:(s=!0,{v:n(new u(a.EINVAL,"["+r+"] Value provided for option "+q+" is not the proper type. Expected "+(Array.isArray($.type)?"one of {"+$.type.join(", ")+"}":$.type)+", but received "+typeof nt+`
Option description: `+$.description))})}}};for(var D in e){var M=S(D);if(M)return M.v}c=!0,o===0&&!s&&n()}var Z=Object.freeze({deprecationMessage:xt,isIE:Et,isWebWorker:Zt,fail:j,mkdirpSync:U,buffer2ArrayBuffer:K,buffer2Uint8array:ft,arrayish2Buffer:Rt,uint8Array2Buffer:gt,arrayBuffer2Buffer:_t,copyingSlice:Ft,emptyBuffer:Mt,bufferValidator:T,checkOptions:F}),it=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};it.prototype.open=function(t){var n=this.fs.realPath(t.node),e=this.FS;try{e.isFile(t.node.mode)&&(t.nfd=this.nodefs.openSync(n,this.fs.flagsToPermissionString(t.flags)))}catch(r){throw r.code?new e.ErrnoError(this.ERRNO_CODES[r.code]):r}},it.prototype.close=function(t){var n=this.FS;try{n.isFile(t.node.mode)&&t.nfd&&this.nodefs.closeSync(t.nfd)}catch(e){throw e.code?new n.ErrnoError(this.ERRNO_CODES[e.code]):e}},it.prototype.read=function(t,n,e,r,o){try{return this.nodefs.readSync(t.nfd,gt(n),e,r,o)}catch(s){throw new this.FS.ErrnoError(this.ERRNO_CODES[s.code])}},it.prototype.write=function(t,n,e,r,o){try{return this.nodefs.writeSync(t.nfd,gt(n),e,r,o)}catch(s){throw new this.FS.ErrnoError(this.ERRNO_CODES[s.code])}},it.prototype.llseek=function(t,n,e){var r=n;if(e===1)r+=t.position;else if(e===2&&this.FS.isFile(t.node.mode))try{var o=this.nodefs.fstatSync(t.nfd);r+=o.size}catch(s){throw new this.FS.ErrnoError(this.ERRNO_CODES[s.code])}if(r<0)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return t.position=r,r};var pt=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};pt.prototype.getattr=function(t){var n=this.fs.realPath(t),e;try{e=this.nodefs.lstatSync(n)}catch(r){throw r.code?new this.FS.ErrnoError(this.ERRNO_CODES[r.code]):r}return{dev:e.dev,ino:e.ino,mode:e.mode,nlink:e.nlink,uid:e.uid,gid:e.gid,rdev:e.rdev,size:e.size,atime:e.atime,mtime:e.mtime,ctime:e.ctime,blksize:e.blksize,blocks:e.blocks}},pt.prototype.setattr=function(t,n){var e=this.fs.realPath(t);try{if(n.mode!==void 0&&(this.nodefs.chmodSync(e,n.mode),t.mode=n.mode),n.timestamp!==void 0){var r=new Date(n.timestamp);this.nodefs.utimesSync(e,r,r)}}catch(o){if(!o.code)throw o;if(o.code!=="ENOTSUP")throw new this.FS.ErrnoError(this.ERRNO_CODES[o.code])}if(n.size!==void 0)try{this.nodefs.truncateSync(e,n.size)}catch(o){throw o.code?new this.FS.ErrnoError(this.ERRNO_CODES[o.code]):o}},pt.prototype.lookup=function(t,n){var e=this.PATH.join2(this.fs.realPath(t),n),r=this.fs.getMode(e);return this.fs.createNode(t,n,r)},pt.prototype.mknod=function(t,n,e,r){var o=this.fs.createNode(t,n,e,r),s=this.fs.realPath(o);try{this.FS.isDir(o.mode)?this.nodefs.mkdirSync(s,o.mode):this.nodefs.writeFileSync(s,"",{mode:o.mode})}catch(c){throw c.code?new this.FS.ErrnoError(this.ERRNO_CODES[c.code]):c}return o},pt.prototype.rename=function(t,n,e){var r=this.fs.realPath(t),o=this.PATH.join2(this.fs.realPath(n),e);try{this.nodefs.renameSync(r,o),t.name=e,t.parent=n}catch(s){throw s.code?new this.FS.ErrnoError(this.ERRNO_CODES[s.code]):s}},pt.prototype.unlink=function(t,n){var e=this.PATH.join2(this.fs.realPath(t),n);try{this.nodefs.unlinkSync(e)}catch(r){throw r.code?new this.FS.ErrnoError(this.ERRNO_CODES[r.code]):r}},pt.prototype.rmdir=function(t,n){var e=this.PATH.join2(this.fs.realPath(t),n);try{this.nodefs.rmdirSync(e)}catch(r){throw r.code?new this.FS.ErrnoError(this.ERRNO_CODES[r.code]):r}},pt.prototype.readdir=function(t){var n=this.fs.realPath(t);try{var e=this.nodefs.readdirSync(n);return e.push(".",".."),e}catch(r){throw r.code?new this.FS.ErrnoError(this.ERRNO_CODES[r.code]):r}},pt.prototype.symlink=function(t,n,e){var r=this.PATH.join2(this.fs.realPath(t),n);try{this.nodefs.symlinkSync(e,r)}catch(o){throw o.code?new this.FS.ErrnoError(this.ERRNO_CODES[o.code]):o}},pt.prototype.readlink=function(t){var n=this.fs.realPath(t);try{return this.nodefs.readlinkSync(n)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}};var bt=function(t,n,e,r){t===void 0&&(t=self.FS),n===void 0&&(n=self.PATH),e===void 0&&(e=self.ERRNO_CODES),r===void 0&&(r=lt),this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},this.nodefs=r,this.FS=t,this.PATH=n,this.ERRNO_CODES=e,this.node_ops=new pt(this),this.stream_ops=new it(this)};bt.prototype.mount=function(t){return this.createNode(null,"/",this.getMode(t.opts.root),0)},bt.prototype.createNode=function(t,n,e,r){var o=this.FS;if(!o.isDir(e)&&!o.isFile(e)&&!o.isLink(e))throw new o.ErrnoError(this.ERRNO_CODES.EINVAL);var s=o.createNode(t,n,e);return s.node_ops=this.node_ops,s.stream_ops=this.stream_ops,s},bt.prototype.getMode=function(t){var n;try{n=this.nodefs.lstatSync(t)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}return n.mode},bt.prototype.realPath=function(t){for(var n=[];t.parent!==t;)n.push(t.name),t=t.parent;return n.push(t.mount.opts.root),n.reverse(),this.PATH.join.apply(null,n)},bt.prototype.flagsToPermissionString=function(t){var n=typeof t=="string"?parseInt(t,10):t;return n&=8191,n in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[n]:t},bt.prototype.getNodeFS=function(){return this.nodefs},bt.prototype.getFS=function(){return this.FS},bt.prototype.getPATH=function(){return this.PATH},bt.prototype.getERRNO_CODES=function(){return this.ERRNO_CODES};var Q=function(){};Q.prototype.supportsLinks=function(){return!1},Q.prototype.diskSpace=function(t,n){n(0,0)},Q.prototype.openFile=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.createFile=function(t,n,e,r){throw new u(a.ENOTSUP)},Q.prototype.open=function(t,n,e,r){var o=this,s=function(c,y){if(c)switch(n.pathNotExistsAction()){case L.CREATE_FILE:return o.stat(m.dirname(t),!1,function(S,D){S?r(S):D&&!D.isDirectory()?r(u.ENOTDIR(m.dirname(t))):o.createFile(t,n,e,r)});case L.THROW_EXCEPTION:return r(u.ENOENT(t));default:return r(new u(a.EINVAL,"Invalid FileFlag object."))}else{if(y&&y.isDirectory())return r(u.EISDIR(t));switch(n.pathExistsAction()){case L.THROW_EXCEPTION:return r(u.EEXIST(t));case L.TRUNCATE_FILE:return o.openFile(t,n,function(S,D){S?r(S):D?D.truncate(0,function(){D.sync(function(){r(null,D)})}):j()});case L.NOP:return o.openFile(t,n,r);default:return r(new u(a.EINVAL,"Invalid FileFlag object."))}}};this.stat(t,!1,s)},Q.prototype.rename=function(t,n,e){e(new u(a.ENOTSUP))},Q.prototype.renameSync=function(t,n){throw new u(a.ENOTSUP)},Q.prototype.stat=function(t,n,e){e(new u(a.ENOTSUP))},Q.prototype.statSync=function(t,n){throw new u(a.ENOTSUP)},Q.prototype.openFileSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.createFileSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.openSync=function(t,n,e){var r;try{r=this.statSync(t,!1)}catch{switch(n.pathNotExistsAction()){case L.CREATE_FILE:var o=this.statSync(m.dirname(t),!1);if(!o.isDirectory())throw u.ENOTDIR(m.dirname(t));return this.createFileSync(t,n,e);case L.THROW_EXCEPTION:throw u.ENOENT(t);default:throw new u(a.EINVAL,"Invalid FileFlag object.")}}if(r.isDirectory())throw u.EISDIR(t);switch(n.pathExistsAction()){case L.THROW_EXCEPTION:throw u.EEXIST(t);case L.TRUNCATE_FILE:return this.unlinkSync(t),this.createFileSync(t,n,r.mode);case L.NOP:return this.openFileSync(t,n,e);default:throw new u(a.EINVAL,"Invalid FileFlag object.")}},Q.prototype.unlink=function(t,n){n(new u(a.ENOTSUP))},Q.prototype.unlinkSync=function(t){throw new u(a.ENOTSUP)},Q.prototype.rmdir=function(t,n){n(new u(a.ENOTSUP))},Q.prototype.rmdirSync=function(t){throw new u(a.ENOTSUP)},Q.prototype.mkdir=function(t,n,e){e(new u(a.ENOTSUP))},Q.prototype.mkdirSync=function(t,n){throw new u(a.ENOTSUP)},Q.prototype.readdir=function(t,n){n(new u(a.ENOTSUP))},Q.prototype.readdirSync=function(t){throw new u(a.ENOTSUP)},Q.prototype.exists=function(t,n){this.stat(t,null,function(e){n(!e)})},Q.prototype.existsSync=function(t){try{return this.statSync(t,!0),!0}catch{return!1}},Q.prototype.realpath=function(t,n,e){if(this.supportsLinks())for(var r=t.split(m.sep),o=0;o<r.length;o++){var s=r.slice(0,o+1);r[o]=m.join.apply(null,s)}else this.exists(t,function(c){c?e(null,t):e(u.ENOENT(t))})},Q.prototype.realpathSync=function(t,n){if(this.supportsLinks()){for(var e=t.split(m.sep),r=0;r<e.length;r++){var o=e.slice(0,r+1);e[r]=m.join.apply(m,o)}return e.join(m.sep)}else{if(this.existsSync(t))return t;throw u.ENOENT(t)}},Q.prototype.truncate=function(t,n,e){this.open(t,O.getFileFlag("r+"),420,(function(r,o){if(r)return e(r);o.truncate(n,(function(s){o.close((function(c){e(s||c)}))}))}))},Q.prototype.truncateSync=function(t,n){var e=this.openSync(t,O.getFileFlag("r+"),420);try{e.truncateSync(n)}catch(r){throw r}finally{e.closeSync()}},Q.prototype.readFile=function(t,n,e,r){var o=r;this.open(t,e,420,function(s,c){if(s)return r(s);r=function(y,S){c.close(function(D){return y||(y=D),o(y,S)})},c.stat(function(y,S){if(y)return r(y);var D=g.alloc(S.size);c.read(D,0,S.size,0,function(M){if(M)return r(M);if(n===null)return r(M,D);try{r(null,D.toString(n))}catch(q){r(q)}})})})},Q.prototype.readFileSync=function(t,n,e){var r=this.openSync(t,e,420);try{var o=r.statSync(),s=g.alloc(o.size);return r.readSync(s,0,o.size,0),r.closeSync(),n===null?s:s.toString(n)}finally{r.closeSync()}},Q.prototype.writeFile=function(t,n,e,r,o,s){var c=s;this.open(t,r,420,function(y,S){if(y)return s(y);s=function(D){S.close(function(M){c(D||M)})};try{typeof n=="string"&&(n=g.from(n,e))}catch(D){return s(D)}S.write(n,0,n.length,0,s)})},Q.prototype.writeFileSync=function(t,n,e,r,o){var s=this.openSync(t,r,o);try{typeof n=="string"&&(n=g.from(n,e)),s.writeSync(n,0,n.length,0)}finally{s.closeSync()}},Q.prototype.appendFile=function(t,n,e,r,o,s){var c=s;this.open(t,r,o,function(y,S){if(y)return s(y);s=function(D){S.close(function(M){c(D||M)})},typeof n=="string"&&(n=g.from(n,e)),S.write(n,0,n.length,null,s)})},Q.prototype.appendFileSync=function(t,n,e,r,o){var s=this.openSync(t,r,o);try{typeof n=="string"&&(n=g.from(n,e)),s.writeSync(n,0,n.length,null)}finally{s.closeSync()}},Q.prototype.chmod=function(t,n,e,r){r(new u(a.ENOTSUP))},Q.prototype.chmodSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.chown=function(t,n,e,r,o){o(new u(a.ENOTSUP))},Q.prototype.chownSync=function(t,n,e,r){throw new u(a.ENOTSUP)},Q.prototype.utimes=function(t,n,e,r){r(new u(a.ENOTSUP))},Q.prototype.utimesSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.link=function(t,n,e){e(new u(a.ENOTSUP))},Q.prototype.linkSync=function(t,n){throw new u(a.ENOTSUP)},Q.prototype.symlink=function(t,n,e,r){r(new u(a.ENOTSUP))},Q.prototype.symlinkSync=function(t,n,e){throw new u(a.ENOTSUP)},Q.prototype.readlink=function(t,n){n(new u(a.ENOTSUP))},Q.prototype.readlinkSync=function(t){throw new u(a.ENOTSUP)};var ne=(function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.supportsSynch=function(){return!0},t.prototype.rename=function(e,r,o){try{this.renameSync(e,r),o()}catch(s){o(s)}},t.prototype.stat=function(e,r,o){try{o(null,this.statSync(e,r))}catch(s){o(s)}},t.prototype.open=function(e,r,o,s){try{s(null,this.openSync(e,r,o))}catch(c){s(c)}},t.prototype.unlink=function(e,r){try{this.unlinkSync(e),r()}catch(o){r(o)}},t.prototype.rmdir=function(e,r){try{this.rmdirSync(e),r()}catch(o){r(o)}},t.prototype.mkdir=function(e,r,o){try{this.mkdirSync(e,r),o()}catch(s){o(s)}},t.prototype.readdir=function(e,r){try{r(null,this.readdirSync(e))}catch(o){r(o)}},t.prototype.chmod=function(e,r,o,s){try{this.chmodSync(e,r,o),s()}catch(c){s(c)}},t.prototype.chown=function(e,r,o,s,c){try{this.chownSync(e,r,o,s),c()}catch(y){c(y)}},t.prototype.utimes=function(e,r,o,s){try{this.utimesSync(e,r,o),s()}catch(c){s(c)}},t.prototype.link=function(e,r,o){try{this.linkSync(e,r),o()}catch(s){o(s)}},t.prototype.symlink=function(e,r,o,s){try{this.symlinkSync(e,r,o),s()}catch(c){s(c)}},t.prototype.readlink=function(e,r){try{r(null,this.readlinkSync(e))}catch(o){r(o)}},t})(Q),vt=function(){};vt.prototype.sync=function(t){t(new u(a.ENOTSUP))},vt.prototype.syncSync=function(){throw new u(a.ENOTSUP)},vt.prototype.datasync=function(t){this.sync(t)},vt.prototype.datasyncSync=function(){return this.syncSync()},vt.prototype.chown=function(t,n,e){e(new u(a.ENOTSUP))},vt.prototype.chownSync=function(t,n){throw new u(a.ENOTSUP)},vt.prototype.chmod=function(t,n){n(new u(a.ENOTSUP))},vt.prototype.chmodSync=function(t){throw new u(a.ENOTSUP)},vt.prototype.utimes=function(t,n,e){e(new u(a.ENOTSUP))},vt.prototype.utimesSync=function(t,n){throw new u(a.ENOTSUP)};var oe=(function(i){function t(n,e,r,o,s){if(i.call(this),this._pos=0,this._dirty=!1,this._fs=n,this._path=e,this._flag=r,this._stat=o,s?this._buffer=s:this._buffer=Mt(),this._stat.size!==this._buffer.length&&this._flag.isReadable())throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getBuffer=function(){return this._buffer},t.prototype.getStats=function(){return this._stat},t.prototype.getFlag=function(){return this._flag},t.prototype.getPath=function(){return this._path},t.prototype.getPos=function(){return this._flag.isAppendable()?this._stat.size:this._pos},t.prototype.advancePos=function(e){return this._pos+=e},t.prototype.setPos=function(e){return this._pos=e},t.prototype.sync=function(e){try{this.syncSync(),e()}catch(r){e(r)}},t.prototype.syncSync=function(){throw new u(a.ENOTSUP)},t.prototype.close=function(e){try{this.closeSync(),e()}catch(r){e(r)}},t.prototype.closeSync=function(){throw new u(a.ENOTSUP)},t.prototype.stat=function(e){try{e(null,this._stat.clone())}catch(r){e(r)}},t.prototype.statSync=function(){return this._stat.clone()},t.prototype.truncate=function(e,r){try{this.truncateSync(e),this._flag.isSynchronous()&&!lt.getRootFS().supportsSynch()&&this.sync(r),r()}catch(o){return r(o)}},t.prototype.truncateSync=function(e){if(this._dirty=!0,!this._flag.isWriteable())throw new u(a.EPERM,"File not opened with a writeable mode.");if(this._stat.mtime=new Date,e>this._buffer.length){var r=g.alloc(e-this._buffer.length,0);this.writeSync(r,0,r.length,this._buffer.length),this._flag.isSynchronous()&&lt.getRootFS().supportsSynch()&&this.syncSync();return}this._stat.size=e;var o=g.alloc(e);this._buffer.copy(o,0,0,e),this._buffer=o,this._flag.isSynchronous()&&lt.getRootFS().supportsSynch()&&this.syncSync()},t.prototype.write=function(e,r,o,s,c){try{c(null,this.writeSync(e,r,o,s),e)}catch(y){c(y)}},t.prototype.writeSync=function(e,r,o,s){if(this._dirty=!0,s==null&&(s=this.getPos()),!this._flag.isWriteable())throw new u(a.EPERM,"File not opened with a writeable mode.");var c=s+o;if(c>this._stat.size&&(this._stat.size=c,c>this._buffer.length)){var y=g.alloc(c);this._buffer.copy(y),this._buffer=y}var S=e.copy(this._buffer,s,r,r+o);return this._stat.mtime=new Date,this._flag.isSynchronous()?(this.syncSync(),S):(this.setPos(s+S),S)},t.prototype.read=function(e,r,o,s,c){try{c(null,this.readSync(e,r,o,s),e)}catch(y){c(y)}},t.prototype.readSync=function(e,r,o,s){if(!this._flag.isReadable())throw new u(a.EPERM,"File not opened with a readable mode.");s==null&&(s=this.getPos());var c=s+o;c>this._stat.size&&(o=this._stat.size-s);var y=this._buffer.copy(e,r,s,s+o);return this._stat.atime=new Date,this._pos=s+o,y},t.prototype.chmod=function(e,r){try{this.chmodSync(e),r()}catch(o){r(o)}},t.prototype.chmodSync=function(e){if(!this._fs.supportsProps())throw new u(a.ENOTSUP);this._dirty=!0,this._stat.chmod(e),this.syncSync()},t.prototype.isDirty=function(){return this._dirty},t.prototype.resetDirty=function(){this._dirty=!1},t})(vt),le=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.close=function(e){e()},t.prototype.closeSync=function(){},t})(oe),be=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t})(oe),I=(function(i){function t(n,e,r){if(r===void 0&&(r=!0),i.call(this),this._queue=[],this._queueRunning=!1,this._isInitialized=!1,this._initializeCallbacks=[],this._sync=n,this._async=e,!n.supportsSynch())throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.");xt(r,t.Name,{sync:"sync file system instance",async:"async file system instance"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){try{var o=new t(e.sync,e.async,!1);o.initialize(function(s){s?r(s):r(null,o)},!1)}catch(s){r(s)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){return t.Name},t.prototype._syncSync=function(e){this._sync.writeFileSync(e.getPath(),e.getBuffer(),null,O.getFileFlag("w"),e.getStats().mode),this.enqueueOp({apiMethod:"writeFile",arguments:[e.getPath(),e.getBuffer(),null,e.getFlag(),e.getStats().mode]})},t.prototype.initialize=function(e,r){var o=this;r===void 0&&(r=!0),r&&console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use 'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)' to create and initialize AsyncMirror instances.");var s=this._initializeCallbacks,c=function(M){o._isInitialized=!M,o._initializeCallbacks=[],s.forEach(function(q){return q(M)})};if(this._isInitialized)e();else if(s.push(e)===1){var y=function(M,q,$){M!=="/"&&o._sync.mkdirSync(M,q),o._async.readdir(M,function(nt,ut){var yt=0;function It(Gt){Gt?$(Gt):yt<ut.length?(D(m.join(M,ut[yt]),It),yt++):$()}nt?$(nt):It()})},S=function(M,q,$){o._async.readFile(M,null,O.getFileFlag("r"),function(nt,ut){if(nt)$(nt);else try{o._sync.writeFileSync(M,ut,null,O.getFileFlag("w"),q)}catch(yt){nt=yt}finally{$(nt)}})},D=function(M,q){o._async.stat(M,!1,function($,nt){$?q($):nt.isDirectory()?y(M,nt.mode,q):S(M,nt.mode,q)})};y("/",0,c)}},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._sync.supportsProps()&&this._async.supportsProps()},t.prototype.renameSync=function(e,r){this.checkInitialized(),this._sync.renameSync(e,r),this.enqueueOp({apiMethod:"rename",arguments:[e,r]})},t.prototype.statSync=function(e,r){return this.checkInitialized(),this._sync.statSync(e,r)},t.prototype.openSync=function(e,r,o){this.checkInitialized();var s=this._sync.openSync(e,r,o);return s.closeSync(),new be(this,e,r,this._sync.statSync(e,!1),this._sync.readFileSync(e,null,O.getFileFlag("r")))},t.prototype.unlinkSync=function(e){this.checkInitialized(),this._sync.unlinkSync(e),this.enqueueOp({apiMethod:"unlink",arguments:[e]})},t.prototype.rmdirSync=function(e){this.checkInitialized(),this._sync.rmdirSync(e),this.enqueueOp({apiMethod:"rmdir",arguments:[e]})},t.prototype.mkdirSync=function(e,r){this.checkInitialized(),this._sync.mkdirSync(e,r),this.enqueueOp({apiMethod:"mkdir",arguments:[e,r]})},t.prototype.readdirSync=function(e){return this.checkInitialized(),this._sync.readdirSync(e)},t.prototype.existsSync=function(e){return this.checkInitialized(),this._sync.existsSync(e)},t.prototype.chmodSync=function(e,r,o){this.checkInitialized(),this._sync.chmodSync(e,r,o),this.enqueueOp({apiMethod:"chmod",arguments:[e,r,o]})},t.prototype.chownSync=function(e,r,o,s){this.checkInitialized(),this._sync.chownSync(e,r,o,s),this.enqueueOp({apiMethod:"chown",arguments:[e,r,o,s]})},t.prototype.utimesSync=function(e,r,o){this.checkInitialized(),this._sync.utimesSync(e,r,o),this.enqueueOp({apiMethod:"utimes",arguments:[e,r,o]})},t.prototype.checkInitialized=function(){if(!this._isInitialized)throw new u(a.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")},t.prototype.enqueueOp=function(e){var r=this;if(this._queue.push(e),!this._queueRunning){this._queueRunning=!0;var o=function(s){if(s&&console.error("WARNING: File system has desynchronized. Received following error: "+s+`
$`),r._queue.length>0){var c=r._queue.shift(),y=c.arguments;y.push(o),r._async[c.apiMethod].apply(r._async,y)}else r._queueRunning=!1};o()}},t})(ne);I.Name="AsyncMirror",I.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};function h(i,t,n){switch(n.length){case 0:return i.call(t);case 1:return i.call(t,n[0]);case 2:return i.call(t,n[0],n[1]);case 3:return i.call(t,n[0],n[1],n[2])}return i.apply(t,n)}var p=Math.max;function x(i,t,n){return t=p(t===void 0?i.length-1:t,0),function(){for(var e=arguments,r=-1,o=p(e.length-t,0),s=Array(o);++r<o;)s[r]=e[t+r];r=-1;for(var c=Array(t+1);++r<t;)c[r]=e[r];return c[t]=n(s),h(i,this,c)}}function P(i){return i}function G(i,t){return x(i,t,P)}var V=function(i){return G(function(t){var n=t.pop();i.call(this,t,n)})};function Lt(i){return G(function(t,n){var e=V(function(r,o){var s=this;return i(t,function(c,y){c.apply(s,r.concat(y))},o)});return n.length?e.apply(this,n):e})}var Dt=typeof R=="object"&&R&&R.Object===Object&&R,Pt=typeof self=="object"&&self&&self.Object===Object&&self,Vt=Dt||Pt||Function("return this")(),At=Vt.Symbol,ke=Object.prototype,Qe=ke.hasOwnProperty,je=ke.toString,We=At?At.toStringTag:void 0;function Yn(i){var t=Qe.call(i,We),n=i[We];try{i[We]=void 0;var e=!0}catch{}var r=je.call(i);return e&&(t?i[We]=n:delete i[We]),r}var Zn=Object.prototype,Vn=Zn.toString;function W(i){return Vn.call(i)}var st="[object Null]",_="[object Undefined]",ct=At?At.toStringTag:void 0;function Bt(i){return i==null?i===void 0?_:st:ct&&ct in Object(i)?Yn(i):W(i)}function ot(i){var t=typeof i;return i!=null&&(t=="object"||t=="function")}var fe="[object AsyncFunction]",at="[object Function]",Kt="[object GeneratorFunction]",Y="[object Proxy]";function X(i){if(!ot(i))return!1;var t=Bt(i);return t==at||t==Kt||t==fe||t==Y}var $e=9007199254740991;function Ut(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=$e}function ht(i){return i!=null&&Ut(i.length)&&!X(i)}var He={};function Ne(){}function Ht(i){return function(){if(i!==null){var t=i;i=null,t.apply(this,arguments)}}}var Ot=typeof Symbol=="function"&&Symbol.iterator,ie=function(i){return Ot&&i[Ot]&&i[Ot]()};function ue(i,t){for(var n=-1,e=Array(i);++n<i;)e[n]=t(n);return e}function re(i){return i!=null&&typeof i=="object"}var tn="[object Arguments]";function qe(i){return re(i)&&Bt(i)==tn}var Xt=Object.prototype,he=Xt.hasOwnProperty,te=Xt.propertyIsEnumerable,Ie=qe((function(){return arguments})())?qe:function(i){return re(i)&&he.call(i,"callee")&&!te.call(i,"callee")},Se=Array.isArray;function In(){return!1}var pi=typeof d=="object"&&d&&!d.nodeType&&d,di=pi&&typeof E=="object"&&E&&!E.nodeType&&E,Br=di&&di.exports===pi,yi=Br?Vt.Buffer:void 0,Ur=yi?yi.isBuffer:void 0,zr=Ur||In,jr=9007199254740991,Wr=/^(?:0|[1-9]\d*)$/;function Hr(i,t){return t=t??jr,!!t&&(typeof i=="number"||Wr.test(i))&&i>-1&&i%1==0&&i<t}var qr="[object Arguments]",Gr="[object Array]",Xr="[object Boolean]",Yr="[object Date]",Zr="[object Error]",Vr="[object Function]",Kr="[object Map]",Jr="[object Number]",Qr="[object Object]",$r="[object RegExp]",to="[object Set]",eo="[object String]",no="[object WeakMap]",io="[object ArrayBuffer]",ro="[object DataView]",oo="[object Float32Array]",so="[object Float64Array]",ao="[object Int8Array]",co="[object Int16Array]",lo="[object Int32Array]",uo="[object Uint8Array]",fo="[object Uint8ClampedArray]",ho="[object Uint16Array]",po="[object Uint32Array]",zt={};zt[oo]=zt[so]=zt[ao]=zt[co]=zt[lo]=zt[uo]=zt[fo]=zt[ho]=zt[po]=!0,zt[qr]=zt[Gr]=zt[io]=zt[Xr]=zt[ro]=zt[Yr]=zt[Zr]=zt[Vr]=zt[Kr]=zt[Jr]=zt[Qr]=zt[$r]=zt[to]=zt[eo]=zt[no]=!1;function yo(i){return re(i)&&Ut(i.length)&&!!zt[Bt(i)]}function mo(i){return function(t){return i(t)}}var mi=typeof d=="object"&&d&&!d.nodeType&&d,vi=mi&&typeof E=="object"&&E&&!E.nodeType&&E,vo=vi&&vi.exports===mi,Kn=vo&&Dt.process,gi=(function(){try{return Kn&&Kn.binding&&Kn.binding("util")}catch{}})(),wi=gi&&gi.isTypedArray,go=wi?mo(wi):yo,wo=Object.prototype,So=wo.hasOwnProperty;function Eo(i,t){var n=Se(i),e=!n&&Ie(i),r=!n&&!e&&zr(i),o=!n&&!e&&!r&&go(i),s=n||e||r||o,c=s?ue(i.length,String):[],y=c.length;for(var S in i)So.call(i,S)&&!(s&&(S=="length"||r&&(S=="offset"||S=="parent")||o&&(S=="buffer"||S=="byteLength"||S=="byteOffset")||Hr(S,y)))&&c.push(S);return c}var _o=Object.prototype;function bo(i){var t=i&&i.constructor,n=typeof t=="function"&&t.prototype||_o;return i===n}function ko(i,t){return function(n){return i(t(n))}}var Io=ko(Object.keys,Object),Ro=Object.prototype,xo=Ro.hasOwnProperty;function Lo(i){if(!bo(i))return Io(i);var t=[];for(var n in Object(i))xo.call(i,n)&&n!="constructor"&&t.push(n);return t}function To(i){return ht(i)?Eo(i):Lo(i)}function Fo(i){var t=-1,n=i.length;return function(){return++t<n?{value:i[t],key:t}:null}}function Oo(i){var t=-1;return function(){var e=i.next();return e.done?null:(t++,{value:e.value,key:t})}}function No(i){var t=To(i),n=-1,e=t.length;return function(){var o=t[++n];return n<e?{value:i[o],key:o}:null}}function Do(i){if(ht(i))return Fo(i);var t=ie(i);return t?Oo(t):No(i)}function Si(i){return function(){if(i===null)throw new Error("Callback was already called.");var t=i;i=null,t.apply(this,arguments)}}function Ei(i){return function(t,n,e){if(e=Ht(e||Ne),i<=0||!t)return e(null);var r=Do(t),o=!1,s=0;function c(S,D){if(s-=1,S)o=!0,e(S);else{if(D===He||o&&s<=0)return o=!0,e(null);y()}}function y(){for(;s<i&&!o;){var S=r();if(S===null){o=!0,s<=0&&e(null);return}s+=1,n(S.value,S.key,Si(c))}}y()}}function _i(i,t,n,e){Ei(t)(i,n,e)}function Jn(i,t){return function(n,e,r){return i(n,t,e,r)}}function Co(i,t,n){n=Ht(n||Ne);var e=0,r=0,o=i.length;o===0&&n(null);function s(c,y){c?n(c):(++r===o||y===He)&&n(null)}for(;e<o;e++)t(i[e],e,Si(s))}var Ao=Jn(_i,1/0),bi=function(i,t,n){var e=ht(i)?Co:Ao;e(i,t,n)};function Mo(i){return function(t,n,e){return i(bi,t,n,e)}}function ki(i,t,n,e){e=e||Ne,t=t||[];var r=[],o=0;i(t,function(s,c,y){var S=o++;n(s,function(D,M){r[S]=M,y(D)})},function(s){e(s,r)})}var Po=Mo(ki);Lt(Po);function Bo(i){return function(t,n,e,r){return i(Ei(n),t,e,r)}}var Uo=Bo(ki),zo=Jn(Uo,1);Lt(zo),G(function(i,t){return G(function(n){return i.apply(null,t.concat(n))})});function jo(i,t){for(var n=-1,e=i==null?0:i.length;++n<e&&t(i[n],n,i)!==!1;);return i}var Ii=typeof setImmediate=="function"&&setImmediate,Ri=typeof k=="object"&&typeof k.nextTick=="function";function xi(i){setTimeout(i,0)}function Li(i){return G(function(t,n){i(function(){t.apply(null,n)})})}var Rn;Ii?Rn=setImmediate:Ri?Rn=k.nextTick:Rn=xi,Li(Rn);var Wo=Jn(_i,1);function Ho(i,t,n,e){e=Ht(e||Ne),Wo(i,function(r,o,s){n(t,r,function(c,y){t=y,s(c)})},function(r){e(r,t)})}var qo=G(function(t){return G(function(n){var e=this,r=n[n.length-1];typeof r=="function"?n.pop():r=Ne,Ho(t,n,function(o,s,c){s.apply(e,o.concat(G(function(y,S){c(y,S)})))},function(o,s){r.apply(e,[o].concat(s))})})});G(function(i){return qo.apply(null,i.reverse())}),G(function(i){var t=[null].concat(i);return V(function(n,e){return e.apply(this,t)})});function Ti(i){return G(function(t,n){t.apply(null,n.concat(G(function(e,r){typeof console=="object"&&(e?console.error&&console.error(e):console[i]&&jo(r,function(o){console[i](o)}))})))})}Ti("dir");function Go(i){return function(t,n,e){return i(t,e)}}function Fi(i,t,n){bi(i,Go(t),n)}Ti("log");var xn;Ri?xn=k.nextTick:Ii?xn=setImmediate:xn=xi,Li(xn);var pe;function Xo(){pe||(pe={},pe[Dropbox.ApiError.NETWORK_ERROR]=a.EIO,pe[Dropbox.ApiError.INVALID_PARAM]=a.EINVAL,pe[Dropbox.ApiError.INVALID_TOKEN]=a.EPERM,pe[Dropbox.ApiError.OAUTH_ERROR]=a.EPERM,pe[Dropbox.ApiError.NOT_FOUND]=a.ENOENT,pe[Dropbox.ApiError.INVALID_METHOD]=a.EINVAL,pe[Dropbox.ApiError.NOT_ACCEPTABLE]=a.EINVAL,pe[Dropbox.ApiError.CONFLICT]=a.EINVAL,pe[Dropbox.ApiError.RATE_LIMITED]=a.EBUSY,pe[Dropbox.ApiError.SERVER_ERROR]=a.EBUSY,pe[Dropbox.ApiError.OVER_QUOTA]=a.ENOSPC)}function Yo(i){return i&&i.stat.isFile}function Zo(i){return i&&i.stat.isFolder}function Vo(i){return i==null||typeof i=="object"&&typeof i.byteLength=="number"}var se=function(t){this._cache={},this._client=t};se.prototype.readdir=function(t,n){var e=this,r=this.getCachedDirInfo(t);this._wrap(function(o){r!==null&&r.contents?e._client.readdir(t,{contentHash:r.stat.contentHash},o):e._client.readdir(t,o)},function(o,s,c,y){o?o.status===Dropbox.ApiError.NO_CONTENT&&r!==null?n(null,r.contents.slice(0)):n(o):(e.updateCachedDirInfo(t,c,s.slice(0)),y.forEach(function(S){e.updateCachedInfo(m.join(t,S.name),S)}),n(null,s))})},se.prototype.remove=function(t,n){var e=this;this._wrap(function(r){e._client.remove(t,r)},function(r,o){r||e.updateCachedInfo(t,o),n(r)})},se.prototype.move=function(t,n,e){var r=this;this._wrap(function(o){r._client.move(t,n,o)},function(o,s){o||(r.deleteCachedInfo(t),r.updateCachedInfo(n,s)),e(o)})},se.prototype.stat=function(t,n){var e=this;this._wrap(function(r){e._client.stat(t,r)},function(r,o){r||e.updateCachedInfo(t,o),n(r,o)})},se.prototype.readFile=function(t,n){var e=this,r=this.getCachedFileInfo(t);r!==null&&r.contents!==null?this.stat(t,function(o,s){o?n(o):s.contentHash===r.stat.contentHash?n(o,r.contents.slice(0),r.stat):e.readFile(t,n)}):this._wrap(function(o){e._client.readFile(t,{arrayBuffer:!0},o)},function(o,s,c){o||e.updateCachedInfo(t,c,s.slice(0)),n(o,s,c)})},se.prototype.writeFile=function(t,n,e){var r=this;this._wrap(function(o){r._client.writeFile(t,n,o)},function(o,s){o||r.updateCachedInfo(t,s,n.slice(0)),e(o,s)})},se.prototype.mkdir=function(t,n){var e=this;this._wrap(function(r){e._client.mkdir(t,r)},function(r,o){r||e.updateCachedInfo(t,o,[]),n(r)})},se.prototype._wrap=function(t,n){var e=0,r=function(o){var s=2;if(o&&3>++e)switch(o.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout(function(){t(r)},s*1e3);break;default:n.apply(null,arguments);break}else n.apply(null,arguments)};t(r)},se.prototype.getCachedInfo=function(t){return this._cache[t.toLowerCase()]},se.prototype.putCachedInfo=function(t,n){this._cache[t.toLowerCase()]=n},se.prototype.deleteCachedInfo=function(t){delete this._cache[t.toLowerCase()]},se.prototype.getCachedDirInfo=function(t){var n=this.getCachedInfo(t);return Zo(n)?n:null},se.prototype.getCachedFileInfo=function(t){var n=this.getCachedInfo(t);return Yo(n)?n:null},se.prototype.updateCachedDirInfo=function(t,n,e){e===void 0&&(e=null);var r=this.getCachedInfo(t);n.contentHash!==null&&(r===void 0||r.stat.contentHash!==n.contentHash)&&this.putCachedInfo(t,{stat:n,contents:e})},se.prototype.updateCachedFileInfo=function(t,n,e){e===void 0&&(e=null);var r=this.getCachedInfo(t);n.versionTag!==null&&(r===void 0||r.stat.versionTag!==n.versionTag)&&this.putCachedInfo(t,{stat:n,contents:e})},se.prototype.updateCachedInfo=function(t,n,e){e===void 0&&(e=null),n.isFile&&Vo(e)?this.updateCachedFileInfo(t,n,e):n.isFolder&&Array.isArray(e)&&this.updateCachedDirInfo(t,n,e)};var Ko=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var r=this;if(this.isDirty()){var o=this.getBuffer(),s=K(o);this._fs._writeFileStrict(this.getPath(),s,function(c){c||r.resetDirty(),e(c)})}else e()},t.prototype.close=function(e){this.sync(e)},t})(oe),Ln=(function(i){function t(n,e){e===void 0&&(e=!0),i.call(this),this._client=new se(n),xt(e,t.Name,{client:"authenticated dropbox client instance"}),Xo()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t(e.client,!1))},t.isAvailable=function(){return typeof Dropbox<"u"},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var r=this;this._client.readdir("/",function(o,s){if(o)e(r.convert(o,"/"));else{var c=function(S,D){var M=m.join("/",S);r._client.remove(M,function(q){D(q?r.convert(q,M):null)})},y=function(S){S?e(S):e()};Fi(s,c,y)}})},t.prototype.rename=function(e,r,o){var s=this;this._client.move(e,r,function(c){c?s._client.stat(r,function(y,S){if(y||S.isFolder){var D=c.response.error.indexOf(e)>-1?e:r;o(s.convert(c,D))}else s._client.remove(r,function(M){M?o(s.convert(M,r)):s.rename(e,r,o)})}):o()})},t.prototype.stat=function(e,r,o){var s=this;this._client.stat(e,function(c,y){if(c)o(s.convert(c,e));else if(y&&y.isRemoved)o(u.FileError(a.ENOENT,e));else{var S=new A(s._statType(y),y.size);return o(null,S)}})},t.prototype.open=function(e,r,o,s){var c=this;this._client.readFile(e,function(y,S,D){if(y)if(r.isReadable())s(c.convert(y,e));else if(y.status===Dropbox.ApiError.NOT_FOUND){var M=new ArrayBuffer(0);return c._writeFileStrict(e,M,function(nt,ut){if(nt)s(nt);else{var yt=c._makeFile(e,r,ut,_t(M));s(null,yt)}})}else return s(c.convert(y,e));else{var q;S===null?q=Mt():q=_t(S);var $=c._makeFile(e,r,D,q);return s(null,$)}})},t.prototype._writeFileStrict=function(e,r,o){var s=this,c=m.dirname(e);this.stat(c,!1,function(y,S){y?o(u.FileError(a.ENOENT,c)):s._client.writeFile(e,r,function(D,M){D?o(s.convert(D,e)):o(null,M)})})},t.prototype._statType=function(e){return e.isFile?C.FILE:C.DIRECTORY},t.prototype._makeFile=function(e,r,o,s){var c=this._statType(o),y=new A(c,o.size);return new Ko(this,e,r,y,s)},t.prototype._remove=function(e,r,o){var s=this;this._client.stat(e,function(c,y){c?r(s.convert(c,e)):y.isFile&&!o?r(u.FileError(a.ENOTDIR,e)):!y.isFile&&o?r(u.FileError(a.EISDIR,e)):s._client.remove(e,function(S){r(S?s.convert(S,e):null)})})},t.prototype.unlink=function(e,r){this._remove(e,r,!0)},t.prototype.rmdir=function(e,r){this._remove(e,r,!1)},t.prototype.mkdir=function(e,r,o){var s=this,c=m.dirname(e);this._client.stat(c,function(y,S){y?o(s.convert(y,c)):s._client.mkdir(e,function(D){o(D?u.FileError(a.EEXIST,e):null)})})},t.prototype.readdir=function(e,r){var o=this;this._client.readdir(e,function(s,c){return s?r(o.convert(s)):r(null,c)})},t.prototype.convert=function(e,r){r===void 0&&(r=null);var o=pe[e.status];return o===void 0&&(o=a.EIO),r?u.FileError(o,r):new u(o)},t})(Q);Ln.Name="Dropbox",Ln.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(i,t){i.isAuthenticated&&i.isAuthenticated()?t():t(new u(a.EINVAL,"'client' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}};function Yt(i,t){t===void 0&&(t="");for(var n=i.errno,e=i.node,r=[];e&&(r.unshift(e.name),e!==e.parent);)e=e.parent;return new u(n,b[n],r.length>0?"/"+r.join("/"):t)}var Jo=(function(i){function t(n,e,r,o){i.call(this),this._fs=n,this._FS=e,this._path=r,this._stream=o}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getPos=function(){},t.prototype.close=function(e){var r=null;try{this.closeSync()}catch(o){r=o}finally{e(r)}},t.prototype.closeSync=function(){try{this._FS.close(this._stream)}catch(e){throw Yt(e,this._path)}},t.prototype.stat=function(e){try{e(null,this.statSync())}catch(r){e(r)}},t.prototype.statSync=function(){try{return this._fs.statSync(this._path,!1)}catch(e){throw Yt(e,this._path)}},t.prototype.truncate=function(e,r){var o=null;try{this.truncateSync(e)}catch(s){o=s}finally{r(o)}},t.prototype.truncateSync=function(e){try{this._FS.ftruncate(this._stream.fd,e)}catch(r){throw Yt(r,this._path)}},t.prototype.write=function(e,r,o,s,c){try{c(null,this.writeSync(e,r,o,s),e)}catch(y){c(y)}},t.prototype.writeSync=function(e,r,o,s){try{var c=ft(e),y=s===null?void 0:s;return this._FS.write(this._stream,c,r,o,y)}catch(S){throw Yt(S,this._path)}},t.prototype.read=function(e,r,o,s,c){try{c(null,this.readSync(e,r,o,s),e)}catch(y){c(y)}},t.prototype.readSync=function(e,r,o,s){try{var c=ft(e),y=s===null?void 0:s;return this._FS.read(this._stream,c,r,o,y)}catch(S){throw Yt(S,this._path)}},t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.chown=function(e,r,o){var s=null;try{this.chownSync(e,r)}catch(c){s=c}finally{o(s)}},t.prototype.chownSync=function(e,r){try{this._FS.fchown(this._stream.fd,e,r)}catch(o){throw Yt(o,this._path)}},t.prototype.chmod=function(e,r){var o=null;try{this.chmodSync(e)}catch(s){o=s}finally{r(o)}},t.prototype.chmodSync=function(e){try{this._FS.fchmod(this._stream.fd,e)}catch(r){throw Yt(r,this._path)}},t.prototype.utimes=function(e,r,o){var s=null;try{this.utimesSync(e,r)}catch(c){s=c}finally{o(s)}},t.prototype.utimesSync=function(e,r){this._fs.utimesSync(this._path,e,r)},t})(vt),Tn=(function(i){function t(n){i.call(this),this._FS=n}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t(e.FS))},t.isAvailable=function(){return!0},t.prototype.getName=function(){return this._FS.DB_NAME()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!0},t.prototype.supportsProps=function(){return!0},t.prototype.supportsSynch=function(){return!0},t.prototype.renameSync=function(e,r){try{this._FS.rename(e,r)}catch(o){throw o.errno===a.ENOENT?Yt(o,this.existsSync(e)?r:e):Yt(o)}},t.prototype.statSync=function(e,r){try{var o=r?this._FS.lstat(e):this._FS.stat(e),s=this.modeToFileType(o.mode);return new A(s,o.size,o.mode,o.atime,o.mtime,o.ctime)}catch(c){throw Yt(c,e)}},t.prototype.openSync=function(e,r,o){try{var s=this._FS.open(e,r.getFlagString(),o);if(this._FS.isDir(s.node.mode))throw this._FS.close(s),u.EISDIR(e);return new Jo(this,this._FS,e,s)}catch(c){throw Yt(c,e)}},t.prototype.unlinkSync=function(e){try{this._FS.unlink(e)}catch(r){throw Yt(r,e)}},t.prototype.rmdirSync=function(e){try{this._FS.rmdir(e)}catch(r){throw Yt(r,e)}},t.prototype.mkdirSync=function(e,r){try{this._FS.mkdir(e,r)}catch(o){throw Yt(o,e)}},t.prototype.readdirSync=function(e){try{return this._FS.readdir(e).filter(function(r){return r!=="."&&r!==".."})}catch(r){throw Yt(r,e)}},t.prototype.truncateSync=function(e,r){try{this._FS.truncate(e,r)}catch(o){throw Yt(o,e)}},t.prototype.readFileSync=function(e,r,o){try{var s=this._FS.readFile(e,{flags:o.getFlagString()}),c=gt(s);return r?c.toString(r):c}catch(y){throw Yt(y,e)}},t.prototype.writeFileSync=function(e,r,o,s,c){try{o&&(r=g.from(r,o));var y=ft(r);this._FS.writeFile(e,y,{flags:s.getFlagString(),encoding:"binary"}),this._FS.chmod(e,c)}catch(S){throw Yt(S,e)}},t.prototype.chmodSync=function(e,r,o){try{r?this._FS.lchmod(e,o):this._FS.chmod(e,o)}catch(s){throw Yt(s,e)}},t.prototype.chownSync=function(e,r,o,s){try{r?this._FS.lchown(e,o,s):this._FS.chown(e,o,s)}catch(c){throw Yt(c,e)}},t.prototype.symlinkSync=function(e,r,o){try{this._FS.symlink(e,r)}catch(s){throw Yt(s)}},t.prototype.readlinkSync=function(e){try{return this._FS.readlink(e)}catch(r){throw Yt(r,e)}},t.prototype.utimesSync=function(e,r,o){try{this._FS.utime(e,r.getTime(),o.getTime())}catch(s){throw Yt(s,e)}},t.prototype.modeToFileType=function(e){if(this._FS.isDir(e))return C.DIRECTORY;if(this._FS.isFile(e))return C.FILE;if(this._FS.isLink(e))return C.SYMLINK;throw u.EPERM("Invalid mode: "+e)},t})(ne);Tn.Name="EmscriptenFileSystem",Tn.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var en=(function(i){function t(n,e){i.call(this),this._folder=n,this._wrapped=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t(e.folder,e.wrapped))},t.isAvailable=function(){return!0},t.prototype.initialize=function(e){var r=this;this._wrapped.exists(this._folder,function(o){o?e():r._wrapped.isReadOnly()?e(u.ENOENT(r._folder)):r._wrapped.mkdir(r._folder,511,e)})},t.prototype.getName=function(){return this._wrapped.getName()},t.prototype.isReadOnly=function(){return this._wrapped.isReadOnly()},t.prototype.supportsProps=function(){return this._wrapped.supportsProps()},t.prototype.supportsSynch=function(){return this._wrapped.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t})(Q);en.Name="FolderAdapter",en.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function Oi(i,t){if(t!==null&&typeof t=="object"){var n=t,e=n.path;e&&(e="/"+m.relative(i,e),n.message=n.message.replace(n.path,e),n.path=e)}return t}function Qo(i,t){return typeof t=="function"?function(n){arguments.length>0&&(arguments[0]=Oi(i,n)),t.apply(null,arguments)}:t}function Ni(i,t,n){return i.slice(i.length-4)!=="Sync"?function(){return arguments.length>0&&(arguments[0]=m.join(this._folder,arguments[0]),n&&(arguments[1]=m.join(this._folder,arguments[1])),arguments[arguments.length-1]=Qo(this._folder,arguments[arguments.length-1])),this._wrapped[i].apply(this._wrapped,arguments)}:function(){try{return t&&(arguments[0]=m.join(this._folder,arguments[0])),n&&(arguments[1]=m.join(this._folder,arguments[1])),this._wrapped[i].apply(this._wrapped,arguments)}catch(e){throw Oi(this._folder,e)}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(function(i){en.prototype[i]=Ni(i,!0,!1)}),["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(function(i){en.prototype[i]=Ni(i,!0,!0)});var Fn;typeof window<"u"?Fn=window:typeof self<"u"?Fn=self:Fn=R;var Jt=Fn;function $o(i){return i.isDirectory}var Qn=Jt.webkitRequestFileSystem||Jt.requestFileSystem||null;function ts(i,t,n,e){if(typeof navigator.webkitPersistentStorage<"u")switch(i){case Jt.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(t,n,e);break;case Jt.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(t,n,e);break;default:e(new TypeError("Invalid storage type: "+i));break}else Jt.webkitStorageInfo.requestQuota(i,t,n,e)}function es(i){return Array.prototype.slice.call(i||[],0)}function Re(i,t,n){switch(i.name){case"PathExistsError":return u.EEXIST(t);case"QuotaExceededError":return u.FileError(a.ENOSPC,t);case"NotFoundError":return u.ENOENT(t);case"SecurityError":return u.FileError(a.EACCES,t);case"InvalidModificationError":return u.FileError(a.EPERM,t);case"TypeMismatchError":return u.FileError(n?a.ENOTDIR:a.EISDIR,t);default:return u.FileError(a.EINVAL,t)}}var ns=(function(i){function t(n,e,r,o,s,c){i.call(this,n,r,o,s,c),this._entry=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var r=this;if(!this.isDirty())return e();this._entry.createWriter(function(o){var s=r.getBuffer(),c=new Blob([K(s)]),y=c.size;o.onwriteend=function(S){o.onwriteend=null,o.onerror=null,o.truncate(y),r.resetDirty(),e()},o.onerror=function(S){e(Re(S,r.getPath(),!1))},o.write(c)})},t.prototype.close=function(e){this.sync(e)},t})(oe),On=(function(i){function t(n,e,r){n===void 0&&(n=5),e===void 0&&(e=Jt.PERSISTENT),r===void 0&&(r=!0),i.call(this),this.size=1024*1024*n,this.type=e,xt(r,t.Name,{size:n,type:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){var o=new t(e.size,e.type,!1);o.allocate(function(s){return s?r(s):r(null,o)},!1)},t.isAvailable=function(){return!!Qn},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.allocate=function(e,r){var o=this;e===void 0&&(e=function(){}),r===void 0&&(r=!0),r&&console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use 'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)' to create and allocate HTML5FS instances.");var s=function(y){o.fs=y,e()},c=function(y){e(Re(y,"/",!0))};this.type===Jt.PERSISTENT?ts(this.type,this.size,function(y){Qn(o.type,y,s,c)},c):Qn(this.type,this.size,s,c)},t.prototype.empty=function(e){this._readdir("/",function(r,o){if(r)console.error("Failed to empty FS"),e(r);else{var s=function(y){r?(console.error("Failed to empty FS"),e(r)):e()},c=function(y,S){var D=function(){S()},M=function(q){S(Re(q,y.fullPath,!y.isDirectory))};$o(y)?y.removeRecursively(D,M):y.remove(D,M)};Fi(o,c,s)}})},t.prototype.rename=function(e,r,o){var s=this,c=2,y=0,S=this.fs.root,D=e,M=function($){--c<=0&&o(Re($,D,!1))},q=function($){if(++y===2)return o(new u(a.EINVAL,"Something was identified as both a file and a directory. This should never happen."));if(e===r)return o();D=m.dirname(r),S.getDirectory(D,{},function(nt){D=m.basename(r),$.moveTo(nt,D,function(ut){o()},function(ut){$.isDirectory?(D=r,s.unlink(r,function(yt){yt?M(ut):s.rename(e,r,o)})):M(ut)})},M)};S.getFile(e,{},q,M),S.getDirectory(e,{},q,M)},t.prototype.stat=function(e,r,o){var s=this,c={create:!1},y=function(q){var $=function(nt){var ut=new A(C.FILE,nt.size);o(null,ut)};q.file($,D)},S=function(q){var $=4096,nt=new A(C.DIRECTORY,$);o(null,nt)},D=function(q){o(Re(q,e,!1))},M=function(){s.fs.root.getDirectory(e,c,S,D)};this.fs.root.getFile(e,c,y,M)},t.prototype.open=function(e,r,o,s){var c=this,y=function(S){S.name==="InvalidModificationError"&&r.isExclusive()?s(u.EEXIST(e)):s(Re(S,e,!1))};this.fs.root.getFile(e,{create:r.pathNotExistsAction()===L.CREATE_FILE,exclusive:r.isExclusive()},function(S){S.file(function(D){var M=new FileReader;M.onloadend=function(q){var $=c._makeFile(e,S,r,D,M.result);s(null,$)},M.onerror=function(q){y(M.error)},M.readAsArrayBuffer(D)},y)},y)},t.prototype.unlink=function(e,r){this._remove(e,r,!0)},t.prototype.rmdir=function(e,r){var o=this;this.readdir(e,function(s,c){s?r(s):c.length>0?r(u.ENOTEMPTY(e)):o._remove(e,r,!1)})},t.prototype.mkdir=function(e,r,o){var s={create:!0,exclusive:!0},c=function(S){o()},y=function(S){o(Re(S,e,!0))};this.fs.root.getDirectory(e,s,c,y)},t.prototype.readdir=function(e,r){this._readdir(e,function(o,s){if(s){for(var c=[],y=0,S=s;y<S.length;y+=1){var D=S[y];c.push(D.name)}r(null,c)}else return r(o)})},t.prototype._makeFile=function(e,r,o,s,c){c===void 0&&(c=new ArrayBuffer(0));var y=new A(C.FILE,s.size),S=_t(c);return new ns(this,r,e,o,y,S)},t.prototype._readdir=function(e,r){var o=function(s){r(Re(s,e,!0))};this.fs.root.getDirectory(e,{create:!1},function(s){var c=s.createReader(),y=[],S=function(){c.readEntries((function(D){D.length?(y=y.concat(es(D)),S()):r(null,y)}),o)};S()},o)},t.prototype._remove=function(e,r,o){var s=function(S){var D=function(){r()},M=function(q){r(Re(q,e,!o))};S.remove(D,M)},c=function(S){r(Re(S,e,!o))},y={create:!1};o?this.fs.root.getFile(e,y,s,c):this.fs.root.getDirectory(e,y,s,c)},t})(Q);On.Name="HTML5FS",On.Options={size:{type:"number",optional:!0,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:!0,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var de=function(t,n,e,r,o,s){this.id=t,this.size=n,this.mode=e,this.atime=r,this.mtime=o,this.ctime=s};de.fromBuffer=function(t){if(t===void 0)throw new Error("NO");return new de(t.toString("ascii",30),t.readUInt32LE(0),t.readUInt16LE(4),t.readDoubleLE(6),t.readDoubleLE(14),t.readDoubleLE(22))},de.prototype.toStats=function(){return new A((this.mode&61440)===C.DIRECTORY?C.DIRECTORY:C.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))},de.prototype.getSize=function(){return 30+this.id.length},de.prototype.toBuffer=function(t){return t===void 0&&(t=g.alloc(this.getSize())),t.writeUInt32LE(this.size,0),t.writeUInt16LE(this.mode,4),t.writeDoubleLE(this.atime,6),t.writeDoubleLE(this.mtime,14),t.writeDoubleLE(this.ctime,22),t.write(this.id,30,this.id.length,"ascii"),t},de.prototype.update=function(t){var n=!1;this.size!==t.size&&(this.size=t.size,n=!0),this.mode!==t.mode&&(this.mode=t.mode,n=!0);var e=t.atime.getTime();this.atime!==e&&(this.atime=e,n=!0);var r=t.mtime.getTime();this.mtime!==r&&(this.mtime=r,n=!0);var o=t.ctime.getTime();return this.ctime!==o&&(this.ctime=o,n=!0),n},de.prototype.isFile=function(){return(this.mode&61440)===C.FILE},de.prototype.isDirectory=function(){return(this.mode&61440)===C.DIRECTORY};var Be="/",$n=null;function Di(){return $n||($n=g.from("{}"))}function Nn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var t=Math.random()*16|0,n=i==="x"?t:t&3|8;return n.toString(16)})}function ve(i,t){return i?(t(i),!1):!0}function $t(i,t,n){return i?(t.abort(function(){n(i)}),!1):!0}var De=function(t){this.store=t,this.originalData={},this.modifiedKeys=[]};De.prototype.get=function(t){var n=this.store.get(t);return this.stashOldValue(t,n),n},De.prototype.put=function(t,n,e){return this.markModified(t),this.store.put(t,n,e)},De.prototype.del=function(t){this.markModified(t),this.store.del(t)},De.prototype.commit=function(){},De.prototype.abort=function(){for(var t=this,n=0,e=t.modifiedKeys;n<e.length;n+=1){var r=e[n],o=t.originalData[r];o?t.store.put(r,o,!0):t.store.del(r)}},De.prototype.stashOldValue=function(t,n){this.originalData.hasOwnProperty(t)||(this.originalData[t]=n)},De.prototype.markModified=function(t){this.modifiedKeys.indexOf(t)===-1&&(this.modifiedKeys.push(t),this.originalData.hasOwnProperty(t)||(this.originalData[t]=this.store.get(t)))};var Ci=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats()),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t})(oe),Ai=(function(i){function t(n){i.call(this),this.store=n.store,this.makeRootDirectory()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.empty=function(){this.store.clear(),this.makeRootDirectory()},t.prototype.renameSync=function(e,r){var o=this.store.beginTransaction("readwrite"),s=m.dirname(e),c=m.basename(e),y=m.dirname(r),S=m.basename(r),D=this.findINode(o,s),M=this.getDirListing(o,s,D);if(!M[c])throw u.ENOENT(e);var q=M[c];if(delete M[c],(y+"/").indexOf(e+"/")===0)throw new u(a.EBUSY,s);var $,nt;if(y===s?($=D,nt=M):($=this.findINode(o,y),nt=this.getDirListing(o,y,$)),nt[S]){var ut=this.getINode(o,r,nt[S]);if(ut.isFile())try{o.del(ut.id),o.del(nt[S])}catch(yt){throw o.abort(),yt}else throw u.EPERM(r)}nt[S]=q;try{o.put(D.id,g.from(JSON.stringify(M)),!0),o.put($.id,g.from(JSON.stringify(nt)),!0)}catch(yt){throw o.abort(),yt}o.commit()},t.prototype.statSync=function(e,r){return this.findINode(this.store.beginTransaction("readonly"),e).toStats()},t.prototype.createFileSync=function(e,r,o){var s=this.store.beginTransaction("readwrite"),c=Mt(),y=this.commitNewFile(s,e,C.FILE,o,c);return new Ci(this,e,r,y.toStats(),c)},t.prototype.openFileSync=function(e,r){var o=this.store.beginTransaction("readonly"),s=this.findINode(o,e),c=o.get(s.id);if(c===void 0)throw u.ENOENT(e);return new Ci(this,e,r,s.toStats(),c)},t.prototype.unlinkSync=function(e){this.removeEntry(e,!1)},t.prototype.rmdirSync=function(e){if(this.readdirSync(e).length>0)throw u.ENOTEMPTY(e);this.removeEntry(e,!0)},t.prototype.mkdirSync=function(e,r){var o=this.store.beginTransaction("readwrite"),s=g.from("{}");this.commitNewFile(o,e,C.DIRECTORY,r,s)},t.prototype.readdirSync=function(e){var r=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(r,e,this.findINode(r,e)))},t.prototype._syncSync=function(e,r,o){var s=this.store.beginTransaction("readwrite"),c=this._findINode(s,m.dirname(e),m.basename(e)),y=this.getINode(s,e,c),S=y.update(o);try{s.put(y.id,r,!0),S&&s.put(c,y.toBuffer(),!0)}catch(D){throw s.abort(),D}s.commit()},t.prototype.makeRootDirectory=function(){var e=this.store.beginTransaction("readwrite");if(e.get(Be)===void 0){var r=new Date().getTime(),o=new de(Nn(),4096,511|C.DIRECTORY,r,r,r);e.put(o.id,Di(),!1),e.put(Be,o.toBuffer(),!1),e.commit()}},t.prototype._findINode=function(e,r,o){var s=this,c=function(y){var S=s.getDirListing(e,r,y);if(S[o])return S[o];throw u.ENOENT(m.resolve(r,o))};return r==="/"?o===""?Be:c(this.getINode(e,r,Be)):c(this.getINode(e,r+m.sep+o,this._findINode(e,m.dirname(r),m.basename(r))))},t.prototype.findINode=function(e,r){return this.getINode(e,r,this._findINode(e,m.dirname(r),m.basename(r)))},t.prototype.getINode=function(e,r,o){var s=e.get(o);if(s===void 0)throw u.ENOENT(r);return de.fromBuffer(s)},t.prototype.getDirListing=function(e,r,o){if(!o.isDirectory())throw u.ENOTDIR(r);var s=e.get(o.id);if(s===void 0)throw u.ENOENT(r);return JSON.parse(s.toString())},t.prototype.addNewNode=function(e,r){for(var o=0,s;o<5;)try{return s=Nn(),e.put(s,r,!1),s}catch{}throw new u(a.EIO,"Unable to commit data to key-value store.")},t.prototype.commitNewFile=function(e,r,o,s,c){var y=m.dirname(r),S=m.basename(r),D=this.findINode(e,y),M=this.getDirListing(e,y,D),q=new Date().getTime();if(r==="/"||M[S])throw u.EEXIST(r);var $;try{var nt=this.addNewNode(e,c);$=new de(nt,c.length,s|o,q,q,q);var ut=this.addNewNode(e,$.toBuffer());M[S]=ut,e.put(D.id,g.from(JSON.stringify(M)),!0)}catch(yt){throw e.abort(),yt}return e.commit(),$},t.prototype.removeEntry=function(e,r){var o=this.store.beginTransaction("readwrite"),s=m.dirname(e),c=this.findINode(o,s),y=this.getDirListing(o,s,c),S=m.basename(e);if(!y[S])throw u.ENOENT(e);var D=y[S];delete y[S];var M=this.getINode(o,e,D);if(!r&&M.isDirectory())throw u.EISDIR(e);if(r&&!M.isDirectory())throw u.ENOTDIR(e);try{o.del(M.id),o.del(D),o.put(c.id,g.from(JSON.stringify(y)),!0)}catch(q){throw o.abort(),q}o.commit()},t})(ne),Mi=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var r=this;this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),function(o){o||r.resetDirty(),e(o)}):e()},t.prototype.close=function(e){this.sync(e)},t})(oe),is=(function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.init=function(e,r){this.store=e,this.makeRootDirectory(r)},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var r=this;this.store.clear(function(o){ve(o,e)&&r.makeRootDirectory(e)})},t.prototype.rename=function(e,r,o){var s=this,c=this.store.beginTransaction("readwrite"),y=m.dirname(e),S=m.basename(e),D=m.dirname(r),M=m.basename(r),q={},$={},nt=!1;if((D+"/").indexOf(e+"/")===0)return o(new u(a.EBUSY,y));var ut=function(){if(!(nt||!$.hasOwnProperty(y)||!$.hasOwnProperty(D))){var It=$[y],Gt=q[y],ae=$[D],Te=q[D];if(!It[S])o(u.ENOENT(e));else{var Fe=It[S];delete It[S];var ln=function(){ae[M]=Fe,c.put(Gt.id,g.from(JSON.stringify(It)),!0,function(Me){$t(Me,c,o)&&(y===D?c.commit(o):c.put(Te.id,g.from(JSON.stringify(ae)),!0,function(Pe){$t(Pe,c,o)&&c.commit(o)}))})};ae[M]?s.getINode(c,r,ae[M],function(Me,Pe){$t(Me,c,o)&&(Pe.isFile()?c.del(Pe.id,function(br){$t(br,c,o)&&c.del(ae[M],function(Os){$t(Os,c,o)&&ln()})}):c.abort(function(br){o(u.EPERM(r))}))}):ln()}}},yt=function(It){s.findINodeAndDirListing(c,It,function(Gt,ae,Te){Gt?nt||(nt=!0,c.abort(function(){o(Gt)})):(q[It]=ae,$[It]=Te,ut())})};yt(y),y!==D&&yt(D)},t.prototype.stat=function(e,r,o){var s=this.store.beginTransaction("readonly");this.findINode(s,e,function(c,y){ve(c,o)&&o(null,y.toStats())})},t.prototype.createFile=function(e,r,o,s){var c=this,y=this.store.beginTransaction("readwrite"),S=Mt();this.commitNewFile(y,e,C.FILE,o,S,function(D,M){ve(D,s)&&s(null,new Mi(c,e,r,M.toStats(),S))})},t.prototype.openFile=function(e,r,o){var s=this,c=this.store.beginTransaction("readonly");this.findINode(c,e,function(y,S){ve(y,o)&&c.get(S.id,function(D,M){ve(D,o)&&(M===void 0?o(u.ENOENT(e)):o(null,new Mi(s,e,r,S.toStats(),M)))})})},t.prototype.unlink=function(e,r){this.removeEntry(e,!1,r)},t.prototype.rmdir=function(e,r){var o=this;this.readdir(e,function(s,c){s?r(s):c.length>0?r(u.ENOTEMPTY(e)):o.removeEntry(e,!0,r)})},t.prototype.mkdir=function(e,r,o){var s=this.store.beginTransaction("readwrite"),c=g.from("{}");this.commitNewFile(s,e,C.DIRECTORY,r,c,o)},t.prototype.readdir=function(e,r){var o=this,s=this.store.beginTransaction("readonly");this.findINode(s,e,function(c,y){ve(c,r)&&o.getDirListing(s,e,y,function(S,D){ve(S,r)&&r(null,Object.keys(D))})})},t.prototype._sync=function(e,r,o,s){var c=this,y=this.store.beginTransaction("readwrite");this._findINode(y,m.dirname(e),m.basename(e),function(S,D){$t(S,y,s)&&c.getINode(y,e,D,function(M,q){if($t(M,y,s)){var $=q.update(o);y.put(q.id,r,!0,function(nt){$t(nt,y,s)&&($?y.put(D,q.toBuffer(),!0,function(ut){$t(ut,y,s)&&y.commit(s)}):y.commit(s))})}})})},t.prototype.makeRootDirectory=function(e){var r=this.store.beginTransaction("readwrite");r.get(Be,function(o,s){if(o||s===void 0){var c=new Date().getTime(),y=new de(Nn(),4096,511|C.DIRECTORY,c,c,c);r.put(y.id,Di(),!1,function(S){$t(S,r,e)&&r.put(Be,y.toBuffer(),!1,function(D){D?r.abort(function(){e(D)}):r.commit(e)})})}else r.commit(e)})},t.prototype._findINode=function(e,r,o,s){var c=this,y=function(S,D,M){S?s(S):M[o]?s(null,M[o]):s(u.ENOENT(m.resolve(r,o)))};r==="/"?o===""?s(null,Be):this.getINode(e,r,Be,function(S,D){ve(S,s)&&c.getDirListing(e,r,D,function(M,q){y(M,D,q)})}):this.findINodeAndDirListing(e,r,y)},t.prototype.findINode=function(e,r,o){var s=this;this._findINode(e,m.dirname(r),m.basename(r),function(c,y){ve(c,o)&&s.getINode(e,r,y,o)})},t.prototype.getINode=function(e,r,o,s){e.get(o,function(c,y){ve(c,s)&&(y===void 0?s(u.ENOENT(r)):s(null,de.fromBuffer(y)))})},t.prototype.getDirListing=function(e,r,o,s){o.isDirectory()?e.get(o.id,function(c,y){if(ve(c,s))try{s(null,JSON.parse(y.toString()))}catch{s(u.ENOENT(r))}}):s(u.ENOTDIR(r))},t.prototype.findINodeAndDirListing=function(e,r,o){var s=this;this.findINode(e,r,function(c,y){ve(c,o)&&s.getDirListing(e,r,y,function(S,D){ve(S,o)&&o(null,y,D)})})},t.prototype.addNewNode=function(e,r,o){var s=0,c,y=function(){++s===5?o(new u(a.EIO,"Unable to commit data to key-value store.")):(c=Nn(),e.put(c,r,!1,function(S,D){S||!D?y():o(null,c)}))};y()},t.prototype.commitNewFile=function(e,r,o,s,c,y){var S=this,D=m.dirname(r),M=m.basename(r),q=new Date().getTime();if(r==="/")return y(u.EEXIST(r));this.findINodeAndDirListing(e,D,function($,nt,ut){$t($,e,y)&&(ut[M]?e.abort(function(){y(u.EEXIST(r))}):S.addNewNode(e,c,function(yt,It){if($t(yt,e,y)){var Gt=new de(It,c.length,s|o,q,q,q);S.addNewNode(e,Gt.toBuffer(),function(ae,Te){$t(ae,e,y)&&(ut[M]=Te,e.put(nt.id,g.from(JSON.stringify(ut)),!0,function(Fe){$t(Fe,e,y)&&e.commit(function(ln){$t(ln,e,y)&&y(null,Gt)})}))})}}))})},t.prototype.removeEntry=function(e,r,o){var s=this,c=this.store.beginTransaction("readwrite"),y=m.dirname(e),S=m.basename(e);this.findINodeAndDirListing(c,y,function(D,M,q){if($t(D,c,o))if(!q[S])c.abort(function(){o(u.ENOENT(e))});else{var $=q[S];delete q[S],s.getINode(c,e,$,function(nt,ut){$t(nt,c,o)&&(!r&&ut.isDirectory()?c.abort(function(){o(u.EISDIR(e))}):r&&!ut.isDirectory()?c.abort(function(){o(u.ENOTDIR(e))}):c.del(ut.id,function(yt){$t(yt,c,o)&&c.del($,function(It){$t(It,c,o)&&c.put(M.id,g.from(JSON.stringify(q)),!0,function(Gt){$t(Gt,c,o)&&c.commit(o)})})}))})}})},t})(Q),Ge=function(){this.store={}};Ge.prototype.name=function(){return nn.Name},Ge.prototype.clear=function(){this.store={}},Ge.prototype.beginTransaction=function(t){return new De(this)},Ge.prototype.get=function(t){return this.store[t]},Ge.prototype.put=function(t,n,e){return!e&&this.store.hasOwnProperty(t)?!1:(this.store[t]=n,!0)},Ge.prototype.del=function(t){delete this.store[t]};var nn=(function(i){function t(){i.call(this,{store:new Ge})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t)},t})(Ai);nn.Name="InMemory",nn.Options={};var ti=Jt.indexedDB||Jt.mozIndexedDB||Jt.webkitIndexedDB||Jt.msIndexedDB;function hn(i,t){switch(t===void 0&&(t=i.toString()),i.name){case"NotFoundError":return new u(a.ENOENT,t);case"QuotaExceededError":return new u(a.ENOSPC,t);default:return new u(a.EIO,t)}}function pn(i,t,n){return t===void 0&&(t=a.EIO),n===void 0&&(n=null),function(e){e.preventDefault(),i(new u(t,n!==null?n:void 0))}}var ei=function(t,n){this.tx=t,this.store=n};ei.prototype.get=function(t,n){try{var e=this.store.get(t);e.onerror=pn(n),e.onsuccess=function(r){var o=r.target.result;o===void 0?n(null,o):n(null,_t(o))}}catch(r){n(hn(r))}};var rs=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.put=function(e,r,o,s){try{var c=K(r),y;o?y=this.store.put(c,e):y=this.store.add(c,e),y.onerror=pn(s),y.onsuccess=function(S){s(null,!0)}}catch(S){s(hn(S))}},t.prototype.del=function(e,r){try{var o=this.store.delete(e);o.onerror=pn(r),o.onsuccess=function(s){r()}}catch(s){r(hn(s))}},t.prototype.commit=function(e){setTimeout(e,0)},t.prototype.abort=function(e){var r=null;try{this.tx.abort()}catch(o){r=hn(o)}finally{e(r)}},t})(ei),Dn=function(t,n){var e=this;n===void 0&&(n="browserfs"),this.storeName=n;var r=ti.open(this.storeName,1);r.onupgradeneeded=function(o){var s=o.target.result;s.objectStoreNames.contains(e.storeName)&&s.deleteObjectStore(e.storeName),s.createObjectStore(e.storeName)},r.onsuccess=function(o){e.db=o.target.result,t(null,e)},r.onerror=pn(t,a.EACCES)};Dn.prototype.name=function(){return dn.Name+" - "+this.storeName},Dn.prototype.clear=function(t){try{var n=this.db.transaction(this.storeName,"readwrite"),e=n.objectStore(this.storeName),r=e.clear();r.onsuccess=function(o){setTimeout(t,0)},r.onerror=pn(t)}catch(o){t(hn(o))}},Dn.prototype.beginTransaction=function(t){t===void 0&&(t="readonly");var n=this.db.transaction(this.storeName,t),e=n.objectStore(this.storeName);if(t==="readwrite")return new rs(n,e);if(t==="readonly")return new ei(n,e);throw new u(a.EINVAL,"Invalid transaction type.")};var dn=(function(i){function t(n,e,r){var o=this;r===void 0&&(r=!0),i.call(this),this.store=new Dn(function(s){s?n(s):o.init(o.store,function(c){n(c,o)})},e),xt(r,t.Name,{storeName:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){new t(r,e.storeName,!1)},t.isAvailable=function(){try{return typeof ti<"u"&&ti.open("__browserfs_test__")!==null}catch{return!1}},t})(is);dn.Name="IndexedDB",dn.Options={storeName:{type:"string",optional:!0,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var ni=!1,yn;try{Jt.localStorage.setItem("__test__","\uD800"),ni=Jt.localStorage.getItem("__test__")==="\uD800"}catch{ni=!1}yn=ni?"binary_string":"binary_string_ie",g.isEncoding(yn)||(yn="base64");var Xe=function(){};Xe.prototype.name=function(){return mn.Name},Xe.prototype.clear=function(){Jt.localStorage.clear()},Xe.prototype.beginTransaction=function(t){return new De(this)},Xe.prototype.get=function(t){try{var n=Jt.localStorage.getItem(t);if(n!==null)return g.from(n,yn)}catch{}},Xe.prototype.put=function(t,n,e){try{return!e&&Jt.localStorage.getItem(t)!==null?!1:(Jt.localStorage.setItem(t,n.toString(yn)),!0)}catch{throw new u(a.ENOSPC,"LocalStorage is full.")}},Xe.prototype.del=function(t){try{Jt.localStorage.removeItem(t)}catch(n){throw new u(a.EIO,"Unable to delete key "+t+": "+n)}};var mn=(function(i){function t(){i.call(this,{store:new Xe})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){r(null,new t)},t.isAvailable=function(){return typeof Jt.localStorage<"u"},t})(Ai);mn.Name="LocalStorage",mn.Options={};var rn=(function(i){function t(){i.call(this),this.mountList=[],this.mntMap={},this.rootFs=new nn}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){var o=new t;Object.keys(e).forEach(function(s){o.mount(s,e[s])}),r(null,o)},t.isAvailable=function(){return!0},t.prototype.mount=function(e,r){if(e[0]!=="/"&&(e="/"+e),e=m.resolve(e),this.mntMap[e])throw new u(a.EINVAL,"Mount point "+e+" is already taken.");U(e,511,this.rootFs),this.mntMap[e]=r,this.mountList.push(e),this.mountList=this.mountList.sort(function(o,s){return s.length-o.length})},t.prototype.umount=function(e){var r=this;if(e[0]!=="/"&&(e="/"+e),e=m.resolve(e),!this.mntMap[e])throw new u(a.EINVAL,"Mount point "+e+" is already unmounted.");for(delete this.mntMap[e],this.mountList.splice(this.mountList.indexOf(e),1);e!=="/"&&r.rootFs.readdirSync(e).length===0;)r.rootFs.rmdirSync(e),e=m.dirname(e)},t.prototype._getFs=function(e){for(var r=this,o=this.mountList,s=o.length,c=0;c<s;c++){var y=o[c];if(y.length<=e.length&&e.indexOf(y)===0)return e=e.substr(y.length>1?y.length:0),e===""&&(e="/"),{fs:r.mntMap[y],path:e}}return{fs:this.rootFs,path:e}},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,r){r(0,0)},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.standardizeError=function(e,r,o){var s=e.message.indexOf(r);return s!==-1&&(e.message=e.message.substr(0,s)+o+e.message.substr(s+r.length),e.path=o),e},t.prototype.rename=function(e,r,o){var s=this,c=this._getFs(e),y=this._getFs(r);return c.fs===y.fs?c.fs.rename(c.path,y.path,function(S){S&&s.standardizeError(s.standardizeError(S,c.path,e),y.path,r),o(S)}):lt.readFile(e,function(S,D){if(S)return o(S);lt.writeFile(r,D,function(M){if(M)return o(M);lt.unlink(e,o)})})},t.prototype.renameSync=function(e,r){var o=this._getFs(e),s=this._getFs(r);if(o.fs===s.fs)try{return o.fs.renameSync(o.path,s.path)}catch(y){throw this.standardizeError(this.standardizeError(y,o.path,e),s.path,r),y}var c=lt.readFileSync(e);return lt.writeFileSync(r,c),lt.unlinkSync(e)},t.prototype.readdirSync=function(e){var r=this._getFs(e),o=null;if(r.fs!==this.rootFs)try{o=this.rootFs.readdirSync(e)}catch{}try{var s=r.fs.readdirSync(r.path);return o===null?s:s.concat(o.filter(function(c){return s.indexOf(c)===-1}))}catch(c){if(o===null)throw this.standardizeError(c,r.path,e);return o}},t.prototype.readdir=function(e,r){var o=this,s=this._getFs(e);s.fs.readdir(s.path,function(c,y){if(s.fs!==o.rootFs)try{var S=o.rootFs.readdirSync(e);y?y=y.concat(S.filter(function(D){return y.indexOf(D)===-1})):y=S}catch{if(c)return r(o.standardizeError(c,s.path,e))}else if(c)return r(o.standardizeError(c,s.path,e));r(null,y)})},t.prototype.rmdirSync=function(e){var r=this._getFs(e);if(this._containsMountPt(e))throw u.ENOTEMPTY(e);try{r.fs.rmdirSync(r.path)}catch(o){throw this.standardizeError(o,r.path,e)}},t.prototype.rmdir=function(e,r){var o=this,s=this._getFs(e);this._containsMountPt(e)?r(u.ENOTEMPTY(e)):s.fs.rmdir(s.path,function(c){r(c?o.standardizeError(c,s.path,e):null)})},t.prototype._containsMountPt=function(e){for(var r=this.mountList,o=r.length,s=0;s<o;s++){var c=r[s];if(c.length>=e.length&&c.slice(0,e.length)===e)return!0}return!1},t})(Q);rn.Name="MountableFileSystem",rn.Options={};function Pi(i,t,n){return t?function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];var o=e[0],s=this._getFs(o);e[0]=s.path;try{return s.fs[i].apply(s.fs,e)}catch(c){throw this.standardizeError(c,s.path,o),c}}:function(){for(var e=this,r=[],o=arguments.length;o--;)r[o]=arguments[o];var s=r[0],c=this._getFs(s);if(r[0]=c.path,typeof r[r.length-1]=="function"){var y=r[r.length-1];r[r.length-1]=function(){for(var S=[],D=arguments.length;D--;)S[D]=arguments[D];S.length>0&&S[0]instanceof u&&e.standardizeError(S[0],c.path,s),y.apply(null,S)}}return c.fs[i].apply(c.fs,r)}}for(var Bi=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]],ii=0;ii<Bi.length;ii++)for(var os=Bi[ii],ri=0,Ui=os;ri<Ui.length;ri+=1){var Cn=Ui[ri];rn.prototype[Cn]=Pi(Cn,!1),rn.prototype[Cn+"Sync"]=Pi(Cn+"Sync",!0)}var vn;if(typeof setImmediate<"u")vn=setImmediate;else{var Ee=Jt,on=[],zi="zero-timeout-message",ss=function(){if(typeof Ee.importScripts<"u"||!Ee.postMessage)return!1;var i=!0,t=Ee.onmessage;return Ee.onmessage=function(){i=!1},Ee.postMessage("","*"),Ee.onmessage=t,i};if(ss()){vn=function(i){on.push(i),Ee.postMessage(zi,"*")};var ji=function(i){if(i.source===self&&i.data===zi&&(i.stopPropagation?i.stopPropagation():i.cancelBubble=!0,on.length>0)){var t=on.shift();return t()}};Ee.addEventListener?Ee.addEventListener("message",ji,!0):Ee.attachEvent("onmessage",ji)}else if(Ee.MessageChannel){var Wi=new Ee.MessageChannel;Wi.port1.onmessage=function(i){if(on.length>0)return on.shift()()},vn=function(i){on.push(i),Wi.port2.postMessage("")}}else vn=function(i){return setTimeout(i,0)}}var oi=vn,gn=function(){this._locked=!1,this._waiters=[]};gn.prototype.lock=function(t){if(this._locked){this._waiters.push(t);return}this._locked=!0,t()},gn.prototype.unlock=function(){if(!this._locked)throw new Error("unlock of a non-locked mutex");var t=this._waiters.shift();if(t){oi(t);return}this._locked=!1},gn.prototype.tryLock=function(){return this._locked?!1:(this._locked=!0,!0)},gn.prototype.isLocked=function(){return this._locked};var wt=function(t){this._fs=t,this._mu=new gn};wt.prototype.getName=function(){return"LockedFS<"+this._fs.getName()+">"},wt.prototype.getFSUnlocked=function(){return this._fs},wt.prototype.initialize=function(t){this._fs.initialize(t)},wt.prototype.diskSpace=function(t,n){this._fs.diskSpace(t,n)},wt.prototype.isReadOnly=function(){return this._fs.isReadOnly()},wt.prototype.supportsLinks=function(){return this._fs.supportsLinks()},wt.prototype.supportsProps=function(){return this._fs.supportsProps()},wt.prototype.supportsSynch=function(){return this._fs.supportsSynch()},wt.prototype.rename=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.rename(t,n,function(o){r._mu.unlock(),e(o)})})},wt.prototype.renameSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.renameSync(t,n)},wt.prototype.stat=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.stat(t,n,function(o,s){r._mu.unlock(),e(o,s)})})},wt.prototype.statSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.statSync(t,n)},wt.prototype.open=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.open(t,n,e,function(s,c){o._mu.unlock(),r(s,c)})})},wt.prototype.openSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.openSync(t,n,e)},wt.prototype.unlink=function(t,n){var e=this;this._mu.lock(function(){e._fs.unlink(t,function(r){e._mu.unlock(),n(r)})})},wt.prototype.unlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.unlinkSync(t)},wt.prototype.rmdir=function(t,n){var e=this;this._mu.lock(function(){e._fs.rmdir(t,function(r){e._mu.unlock(),n(r)})})},wt.prototype.rmdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.rmdirSync(t)},wt.prototype.mkdir=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.mkdir(t,n,function(o){r._mu.unlock(),e(o)})})},wt.prototype.mkdirSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.mkdirSync(t,n)},wt.prototype.readdir=function(t,n){var e=this;this._mu.lock(function(){e._fs.readdir(t,function(r,o){e._mu.unlock(),n(r,o)})})},wt.prototype.readdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readdirSync(t)},wt.prototype.exists=function(t,n){var e=this;this._mu.lock(function(){e._fs.exists(t,function(r){e._mu.unlock(),n(r)})})},wt.prototype.existsSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.existsSync(t)},wt.prototype.realpath=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.realpath(t,n,function(o,s){r._mu.unlock(),e(o,s)})})},wt.prototype.realpathSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.realpathSync(t,n)},wt.prototype.truncate=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.truncate(t,n,function(o){r._mu.unlock(),e(o)})})},wt.prototype.truncateSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.truncateSync(t,n)},wt.prototype.readFile=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.readFile(t,n,e,function(s,c){o._mu.unlock(),r(s,c)})})},wt.prototype.readFileSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readFileSync(t,n,e)},wt.prototype.writeFile=function(t,n,e,r,o,s){var c=this;this._mu.lock(function(){c._fs.writeFile(t,n,e,r,o,function(y){c._mu.unlock(),s(y)})})},wt.prototype.writeFileSync=function(t,n,e,r,o){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.writeFileSync(t,n,e,r,o)},wt.prototype.appendFile=function(t,n,e,r,o,s){var c=this;this._mu.lock(function(){c._fs.appendFile(t,n,e,r,o,function(y){c._mu.unlock(),s(y)})})},wt.prototype.appendFileSync=function(t,n,e,r,o){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.appendFileSync(t,n,e,r,o)},wt.prototype.chmod=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.chmod(t,n,e,function(s){o._mu.unlock(),r(s)})})},wt.prototype.chmodSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chmodSync(t,n,e)},wt.prototype.chown=function(t,n,e,r,o){var s=this;this._mu.lock(function(){s._fs.chown(t,n,e,r,function(c){s._mu.unlock(),o(c)})})},wt.prototype.chownSync=function(t,n,e,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chownSync(t,n,e,r)},wt.prototype.utimes=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.utimes(t,n,e,function(s){o._mu.unlock(),r(s)})})},wt.prototype.utimesSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.utimesSync(t,n,e)},wt.prototype.link=function(t,n,e){var r=this;this._mu.lock(function(){r._fs.link(t,n,function(o){r._mu.unlock(),e(o)})})},wt.prototype.linkSync=function(t,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.linkSync(t,n)},wt.prototype.symlink=function(t,n,e,r){var o=this;this._mu.lock(function(){o._fs.symlink(t,n,e,function(s){o._mu.unlock(),r(s)})})},wt.prototype.symlinkSync=function(t,n,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.symlinkSync(t,n,e)},wt.prototype.readlink=function(t,n){var e=this;this._mu.lock(function(){e._fs.readlink(t,function(r,o){e._mu.unlock(),n(r,o)})})},wt.prototype.readlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readlinkSync(t)};var Ce="/.deletedFiles.log";function Hi(i){return 146|i}function ge(i){return O.getFileFlag(i)}var qi=(function(i){function t(n,e,r,o,s){i.call(this,n,e,r,o,s)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var r=this;if(!this.isDirty()){e(null);return}this._fs._syncAsync(this,function(o){r.resetDirty(),e(o)})},t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.close=function(e){this.sync(e)},t.prototype.closeSync=function(){this.syncSync()},t})(oe),Gi=(function(i){function t(n,e){if(i.call(this),this._isInitialized=!1,this._initializeCallbacks=[],this._deletedFiles={},this._deleteLog="",this._deleteLogUpdatePending=!1,this._deleteLogUpdateNeeded=!1,this._deleteLogError=null,this._writable=n,this._readable=e,this._writable.isReadOnly())throw new u(a.EINVAL,"Writable file system must be writable.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getOverlayedFileSystems=function(){return{readable:this._readable,writable:this._writable}},t.prototype._syncAsync=function(e,r){var o=this;this.createParentDirectoriesAsync(e.getPath(),function(s){if(s)return r(s);o._writable.writeFile(e.getPath(),e.getBuffer(),null,ge("w"),e.getStats().mode,r)})},t.prototype._syncSync=function(e){this.createParentDirectories(e.getPath()),this._writable.writeFileSync(e.getPath(),e.getBuffer(),null,ge("w"),e.getStats().mode)},t.prototype.getName=function(){return wn.Name},t.prototype.initialize=function(e){var r=this,o=this._initializeCallbacks,s=function(c){r._isInitialized=!c,r._initializeCallbacks=[],o.forEach((function(y){return y(c)}))};if(this._isInitialized)return e();o.push(e),o.length===1&&this._writable.readFile(Ce,"utf8",ge("r"),function(c,y){if(c){if(c.errno!==a.ENOENT)return s(c)}else r._deleteLog=y;r._reparseDeletionLog(),s()})},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return this._readable.supportsSynch()&&this._writable.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._readable.supportsProps()&&this._writable.supportsProps()},t.prototype.getDeletionLog=function(){return this._deleteLog},t.prototype.restoreDeletionLog=function(e){this._deleteLog=e,this._reparseDeletionLog(),this.updateLog("")},t.prototype.rename=function(e,r,o){var s=this;if(!(!this.checkInitAsync(o)||this.checkPathAsync(e,o)||this.checkPathAsync(r,o))){if(e===Ce||r===Ce)return o(u.EPERM("Cannot rename deletion log."));if(e===r)return o();this.stat(e,!1,function(c,y){return c?o(c):s.stat(r,!1,function(S,D){var M=s;function q(nt){var ut=nt.shift();if(!ut)return o();var yt=m.resolve(e,ut),It=m.resolve(r,ut);M.rename(yt,It,function(Gt){if(Gt)return o(Gt);q(nt)})}var $=511;if(y.isDirectory()){if(S)return S.errno!==a.ENOENT?o(S):s._writable.exists(e,function(nt){if(nt)return s._writable.rename(e,r,o);s._writable.mkdir(r,$,function(ut){if(ut)return o(ut);s._readable.readdir(e,function(yt,It){if(yt)return o();q(It)})})});if($=D.mode,!D.isDirectory())return o(u.ENOTDIR(r));s.readdir(r,function(nt,ut){if(ut&&ut.length)return o(u.ENOTEMPTY(r));s._readable.readdir(e,function(yt,It){if(yt)return o();q(It)})})}if(D&&D.isDirectory())return o(u.EISDIR(r));s.readFile(e,null,ge("r"),function(nt,ut){return nt?o(nt):s.writeFile(r,ut,null,ge("w"),y.mode,function(yt){return yt?o(yt):s.unlink(e,o)})})})})}},t.prototype.renameSync=function(e,r){var o=this;if(this.checkInitialized(),this.checkPath(e),this.checkPath(r),e===Ce||r===Ce)throw u.EPERM("Cannot rename deletion log.");var s=this.statSync(e,!1);if(s.isDirectory()){if(e===r)return;var c=511;if(this.existsSync(r)){var y=this.statSync(r,!1);if(c=y.mode,y.isDirectory()){if(this.readdirSync(r).length>0)throw u.ENOTEMPTY(r)}else throw u.ENOTDIR(r)}this._writable.existsSync(e)?this._writable.renameSync(e,r):this._writable.existsSync(r)||this._writable.mkdirSync(r,c),this._readable.existsSync(e)&&this._readable.readdirSync(e).forEach(function(S){o.renameSync(m.resolve(e,S),m.resolve(r,S))})}else{if(this.existsSync(r)&&this.statSync(r,!1).isDirectory())throw u.EISDIR(r);this.writeFileSync(r,this.readFileSync(e,null,ge("r")),null,ge("w"),s.mode)}e!==r&&this.existsSync(e)&&this.unlinkSync(e)},t.prototype.stat=function(e,r,o){var s=this;this.checkInitAsync(o)&&this._writable.stat(e,r,function(c,y){c&&c.errno===a.ENOENT?(s._deletedFiles[e]&&o(u.ENOENT(e)),s._readable.stat(e,r,function(S,D){D&&(D=D.clone(),D.mode=Hi(D.mode)),o(S,D)})):o(c,y)})},t.prototype.statSync=function(e,r){this.checkInitialized();try{return this._writable.statSync(e,r)}catch{if(this._deletedFiles[e])throw u.ENOENT(e);var o=this._readable.statSync(e,r).clone();return o.mode=Hi(o.mode),o}},t.prototype.open=function(e,r,o,s){var c=this;!this.checkInitAsync(s)||this.checkPathAsync(e,s)||this.stat(e,!1,function(y,S){if(S)switch(r.pathExistsAction()){case L.TRUNCATE_FILE:return c.createParentDirectoriesAsync(e,function(D){if(D)return s(D);c._writable.open(e,r,o,s)});case L.NOP:return c._writable.exists(e,function(D){D?c._writable.open(e,r,o,s):(S=S.clone(),S.mode=o,c._readable.readFile(e,null,ge("r"),function(M,q){if(M)return s(M);S.size===-1&&(S.size=q.length);var $=new qi(c,e,r,S,q);s(null,$)}))});default:return s(u.EEXIST(e))}else return r.pathNotExistsAction()===L.CREATE_FILE?c.createParentDirectoriesAsync(e,function(D){return D?s(D):c._writable.open(e,r,o,s)}):s(u.ENOENT(e))})},t.prototype.openSync=function(e,r,o){if(this.checkInitialized(),this.checkPath(e),e===Ce)throw u.EPERM("Cannot open deletion log.");if(this.existsSync(e))switch(r.pathExistsAction()){case L.TRUNCATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,r,o);case L.NOP:if(this._writable.existsSync(e))return this._writable.openSync(e,r,o);var s=this._readable.readFileSync(e,null,ge("r")),c=this._readable.statSync(e,!1).clone();return c.mode=o,new qi(this,e,r,c,s);default:throw u.EEXIST(e)}else{if(r.pathNotExistsAction()===L.CREATE_FILE)return this.createParentDirectories(e),this._writable.openSync(e,r,o);throw u.ENOENT(e)}},t.prototype.unlink=function(e,r){var o=this;!this.checkInitAsync(r)||this.checkPathAsync(e,r)||this.exists(e,function(s){if(!s)return r(u.ENOENT(e));o._writable.exists(e,function(c){if(c)return o._writable.unlink(e,function(y){if(y)return r(y);o.exists(e,function(S){S&&o.deletePath(e),r(null)})});o.deletePath(e),r(null)})})},t.prototype.unlinkSync=function(e){if(this.checkInitialized(),this.checkPath(e),this.existsSync(e))this._writable.existsSync(e)&&this._writable.unlinkSync(e),this.existsSync(e)&&this.deletePath(e);else throw u.ENOENT(e)},t.prototype.rmdir=function(e,r){var o=this;if(this.checkInitAsync(r)){var s=function(){o.readdir(e,function(c,y){if(c)return r(c);if(y.length)return r(u.ENOTEMPTY(e));o.deletePath(e),r(null)})};this.exists(e,function(c){if(!c)return r(u.ENOENT(e));o._writable.exists(e,function(y){y?o._writable.rmdir(e,function(S){if(S)return r(S);o._readable.exists(e,function(D){D?s():r()})}):s()})})}},t.prototype.rmdirSync=function(e){if(this.checkInitialized(),this.existsSync(e)){if(this._writable.existsSync(e)&&this._writable.rmdirSync(e),this.existsSync(e)){if(this.readdirSync(e).length>0)throw u.ENOTEMPTY(e);this.deletePath(e)}}else throw u.ENOENT(e)},t.prototype.mkdir=function(e,r,o){var s=this;this.checkInitAsync(o)&&this.exists(e,function(c){if(c)return o(u.EEXIST(e));s.createParentDirectoriesAsync(e,function(y){if(y)return o(y);s._writable.mkdir(e,r,o)})})},t.prototype.mkdirSync=function(e,r){if(this.checkInitialized(),this.existsSync(e))throw u.EEXIST(e);this.createParentDirectories(e),this._writable.mkdirSync(e,r)},t.prototype.readdir=function(e,r){var o=this;this.checkInitAsync(r)&&this.stat(e,!1,function(s,c){if(s)return r(s);if(!c.isDirectory())return r(u.ENOTDIR(e));o._writable.readdir(e,function(y,S){if(y&&y.code!=="ENOENT")return r(y);(y||!S)&&(S=[]),o._readable.readdir(e,function(D,M){(D||!M)&&(M=[]);var q={},$=S.concat(M.filter(function(nt){return!o._deletedFiles[e+"/"+nt]})).filter(function(nt){var ut=!q[nt];return q[nt]=!0,ut});r(null,$)})})})},t.prototype.readdirSync=function(e){var r=this;this.checkInitialized();var o=this.statSync(e,!1);if(!o.isDirectory())throw u.ENOTDIR(e);var s=[];try{s=s.concat(this._writable.readdirSync(e))}catch{}try{s=s.concat(this._readable.readdirSync(e).filter(function(y){return!r._deletedFiles[e+"/"+y]}))}catch{}var c={};return s.filter(function(y){var S=!c[y];return c[y]=!0,S})},t.prototype.exists=function(e,r){var o=this;this.checkInitialized(),this._writable.exists(e,function(s){if(s)return r(!0);o._readable.exists(e,function(c){r(c&&o._deletedFiles[e]!==!0)})})},t.prototype.existsSync=function(e){return this.checkInitialized(),this._writable.existsSync(e)||this._readable.existsSync(e)&&this._deletedFiles[e]!==!0},t.prototype.chmod=function(e,r,o,s){var c=this;this.checkInitAsync(s)&&this.operateOnWritableAsync(e,function(y){if(y)return s(y);c._writable.chmod(e,r,o,s)})},t.prototype.chmodSync=function(e,r,o){var s=this;this.checkInitialized(),this.operateOnWritable(e,function(){s._writable.chmodSync(e,r,o)})},t.prototype.chown=function(e,r,o,s,c){var y=this;this.checkInitAsync(c)&&this.operateOnWritableAsync(e,function(S){if(S)return c(S);y._writable.chown(e,r,o,s,c)})},t.prototype.chownSync=function(e,r,o,s){var c=this;this.checkInitialized(),this.operateOnWritable(e,function(){c._writable.chownSync(e,r,o,s)})},t.prototype.utimes=function(e,r,o,s){var c=this;this.checkInitAsync(s)&&this.operateOnWritableAsync(e,function(y){if(y)return s(y);c._writable.utimes(e,r,o,s)})},t.prototype.utimesSync=function(e,r,o){var s=this;this.checkInitialized(),this.operateOnWritable(e,function(){s._writable.utimesSync(e,r,o)})},t.prototype.deletePath=function(e){this._deletedFiles[e]=!0,this.updateLog("d"+e+`
`)},t.prototype.updateLog=function(e){var r=this;this._deleteLog+=e,this._deleteLogUpdatePending?this._deleteLogUpdateNeeded=!0:(this._deleteLogUpdatePending=!0,this._writable.writeFile(Ce,this._deleteLog,"utf8",O.getFileFlag("w"),420,function(o){r._deleteLogUpdatePending=!1,o?r._deleteLogError=o:r._deleteLogUpdateNeeded&&(r._deleteLogUpdateNeeded=!1,r.updateLog(""))}))},t.prototype._reparseDeletionLog=function(){var e=this;this._deletedFiles={},this._deleteLog.split(`
`).forEach(function(r){e._deletedFiles[r.slice(1)]=r.slice(0,1)==="d"})},t.prototype.checkInitialized=function(){if(this._isInitialized){if(this._deleteLogError!==null){var e=this._deleteLogError;throw this._deleteLogError=null,e}}else throw new u(a.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")},t.prototype.checkInitAsync=function(e){if(this._isInitialized){if(this._deleteLogError!==null){var r=this._deleteLogError;return this._deleteLogError=null,e(r),!1}}else return e(new u(a.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")),!1;return!0},t.prototype.checkPath=function(e){if(e===Ce)throw u.EPERM(e)},t.prototype.checkPathAsync=function(e,r){return e===Ce?(r(u.EPERM(e)),!0):!1},t.prototype.createParentDirectoriesAsync=function(e,r){var o=m.dirname(e),s=[],c=this;this._writable.stat(o,!1,y);function y(D,M){D?(s.push(o),o=m.dirname(o),c._writable.stat(o,!1,y)):S()}function S(){if(!s.length)return r();var D=s.pop();c._readable.stat(D,!1,function(M,q){if(!q)return r();c._writable.mkdir(D,q.mode,function($){if($)return r($);S()})})}},t.prototype.createParentDirectories=function(e){for(var r=this,o=m.dirname(e),s=[];!this._writable.existsSync(o);)s.push(o),o=m.dirname(o);s=s.reverse(),s.forEach(function(c){r._writable.mkdirSync(c,r.statSync(c,!1).mode)})},t.prototype.operateOnWritable=function(e,r){if(this.existsSync(e))this._writable.existsSync(e)||this.copyToWritable(e),r();else throw u.ENOENT(e)},t.prototype.operateOnWritableAsync=function(e,r){var o=this;this.exists(e,function(s){if(!s)return r(u.ENOENT(e));o._writable.exists(e,function(c){if(c)r();else return o.copyToWritableAsync(e,r)})})},t.prototype.copyToWritable=function(e){var r=this.statSync(e,!1);r.isDirectory()?this._writable.mkdirSync(e,r.mode):this.writeFileSync(e,this._readable.readFileSync(e,null,ge("r")),null,ge("w"),this.statSync(e,!1).mode)},t.prototype.copyToWritableAsync=function(e,r){var o=this;this.stat(e,!1,function(s,c){if(s)return r(s);if(c.isDirectory())return o._writable.mkdir(e,c.mode,r);o._readable.readFile(e,null,ge("r"),function(y,S){if(y)return r(y);o.writeFile(e,S,null,ge("w"),c.mode,r)})})},t})(Q),wn=(function(i){function t(n,e,r){r===void 0&&(r=!0),i.call(this,new Gi(n,e)),xt(r,t.Name,{readable:"readable file system",writable:"writable file system"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){try{var o=new t(e.writable,e.readable,!1);o.initialize(function(s){r(s,o)},!1)}catch(s){r(s)}},t.isAvailable=function(){return Gi.isAvailable()},t.prototype.initialize=function(e,r){r===void 0&&(r=!0),r&&console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use 'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)' to create and initialize OverlayFS instances."),i.prototype.initialize.call(this,e)},t.prototype.getOverlayedFileSystems=function(){return i.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()},t.prototype.unwrap=function(){return i.prototype.getFSUnlocked.call(this)},t})(wt);wn.Name="OverlayFS",wn.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var qt;(function(i){i[i.CB=0]="CB",i[i.FD=1]="FD",i[i.API_ERROR=2]="API_ERROR",i[i.STATS=3]="STATS",i[i.PROBE=4]="PROBE",i[i.FILEFLAG=5]="FILEFLAG",i[i.BUFFER=6]="BUFFER",i[i.ERROR=7]="ERROR"})(qt||(qt={}));var si=function(){this._callbacks={},this._nextId=0};si.prototype.toRemoteArg=function(t){var n=this._nextId++;return this._callbacks[n]=t,{type:qt.CB,id:n}},si.prototype.toLocalArg=function(t){var n=this._callbacks[t];return delete this._callbacks[t],n};var An=function(){this._fileDescriptors={},this._nextId=0};An.prototype.toRemoteArg=function(t,n,e,r){var o=this._nextId++,s,c;this._fileDescriptors[o]=t,t.stat(function(y,S){y?r(y):(c=Ye(S.toBuffer()),e.isReadable()?t.read(g.alloc(S.size),0,S.size,0,function(D,M,q){D?r(D):(s=Ye(q),r(null,{type:qt.FD,id:o,data:s,stat:c,path:n,flag:e.getFlagString()}))}):r(null,{type:qt.FD,id:o,data:new ArrayBuffer(0),stat:c,path:n,flag:e.getFlagString()}))})},An.prototype.applyFdAPIRequest=function(t,n){var e=this,r=t.args[0];this._applyFdChanges(r,function(o,s){o?n(o):s[t.method](function(c){t.method==="close"&&delete e._fileDescriptors[r.id],n(c)})})},An.prototype._applyFdChanges=function(t,n){var e=this._fileDescriptors[t.id],r=Ze(t.data),o=A.fromBuffer(Ze(t.stat)),s=O.getFileFlag(t.flag);s.isWriteable()?e.write(r,0,r.length,s.isAppendable()?e.getPos():0,function(c){function y(){e.stat(function(S,D){S?n(S):D.mode!==o.mode?e.chmod(o.mode,function(M){n(M,e)}):n(S,e)})}c?n(c):s.isAppendable()?y():e.truncate(r.length,function(){y()})}):n(null,e)};function Mn(i){return{type:qt.API_ERROR,errorData:Ye(i.writeToBuffer())}}function Xi(i){return u.fromBuffer(Ze(i.errorData))}function Yi(i){return{type:qt.ERROR,name:i.name,message:i.message,stack:i.stack}}function Zi(i){var t=Jt[i.name];typeof t!="function"&&(t=Error);var n=new t(i.message);return n.stack=i.stack,n}function Vi(i){return{type:qt.STATS,statsData:Ye(i.toBuffer())}}function Ki(i){return A.fromBuffer(Ze(i.statsData))}function Ji(i){return{type:qt.FILEFLAG,flagStr:i.getFlagString()}}function Qi(i){return O.getFileFlag(i.flagStr)}function Ye(i){return K(i)}function Ze(i){return _t(i)}function $i(i){return{type:qt.BUFFER,data:Ye(i)}}function tr(i){return Ze(i.data)}function as(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}function cs(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}var er=(function(i){function t(n,e,r,o,s,c){i.call(this,n,e,r,o,c),this._remoteFdId=s}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getRemoteFdId=function(){return this._remoteFdId},t.prototype.toRemoteArg=function(){return{type:qt.FD,id:this._remoteFdId,data:Ye(this.getBuffer()),stat:Ye(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}},t.prototype.sync=function(e){this._syncClose("sync",e)},t.prototype.close=function(e){this._syncClose("close",e)},t.prototype._syncClose=function(e,r){var o=this;this.isDirty()?this._fs.syncClose(e,this,function(s){s||o.resetDirty(),r(s)}):r()},t})(oe),Pn=(function(i){function t(n,e){var r=this;e===void 0&&(e=!0),i.call(this),this._callbackConverter=new si,this._isInitialized=!1,this._isReadOnly=!1,this._supportLinks=!1,this._supportProps=!1,this._worker=n,xt(e,t.Name,{worker:"Web Worker instance"}),this._worker.addEventListener("message",function(o){var s=o.data;if(cs(s)){var c,y=s.args,S=new Array(y.length);for(c=0;c<S.length;c++)S[c]=r._argRemote2Local(y[c]);r._callbackConverter.toLocalArg(s.cbId).apply(null,S)}})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){var o=new t(e.worker,!1);o.initialize(function(){r(null,o)})},t.isAvailable=function(){return typeof importScripts<"u"||typeof Worker<"u"},t.attachRemoteListener=function(e){var r=new An;function o(c,y,S){typeof c==="object"?c instanceof A?S(null,Vi(c)):c instanceof u?S(null,Mn(c)):c instanceof vt?S(null,r.toRemoteArg(c,y[0],y[1],S)):c instanceof O?S(null,Ji(c)):c instanceof g?S(null,$i(c)):c instanceof Error?S(null,Yi(c)):S(null,c):S(null,c)}function s(c,y){if(!c)return c;switch(typeof c){case"object":if(typeof c.type=="number"){var S=c;switch(S.type){case qt.CB:var D=c.id;return function(){var M=arguments,q,$=new Array(arguments.length),nt,ut=arguments.length;function yt(It){ut>0&&(ut=-1,nt={browserfsMessage:!0,cbId:D,args:[Mn(It)]},e.postMessage(nt))}for(q=0;q<arguments.length;q++)(function(It,Gt){o(Gt,y,function(ae,Te){$[It]=Te,ae?yt(ae):--ut===0&&(nt={browserfsMessage:!0,cbId:D,args:$},e.postMessage(nt))})})(q,M[q]);arguments.length===0&&(nt={browserfsMessage:!0,cbId:D,args:$},e.postMessage(nt))};case qt.API_ERROR:return Xi(S);case qt.STATS:return Ki(S);case qt.FILEFLAG:return Qi(S);case qt.BUFFER:return tr(S);case qt.ERROR:return Zi(S);default:return c}}else return c;default:return c}}e.addEventListener("message",function(c){var y=c.data;if(as(y)){var S=y.args,D=new Array(S.length);switch(y.method){case"close":case"sync":(function(){var $=S[1];r.applyFdAPIRequest(y,function(nt){var ut={browserfsMessage:!0,cbId:$.id,args:nt?[Mn(nt)]:[]};e.postMessage(ut)})})();break;case"probe":(function(){var $=lt.getRootFS(),nt=S[1],ut={type:qt.PROBE,isReadOnly:$.isReadOnly(),supportsLinks:$.supportsLinks(),supportsProps:$.supportsProps()},yt={browserfsMessage:!0,cbId:nt.id,args:[ut]};e.postMessage(yt)})();break;default:for(var M=0;M<S.length;M++)D[M]=s(S[M],D);var q=lt.getRootFS();q[y.method].apply(q,D);break}}})},t.prototype.getName=function(){return t.Name},t.prototype.initialize=function(e){var r=this;if(this._isInitialized)e();else{var o={browserfsMessage:!0,method:"probe",args:[this._argLocal2Remote(Mt()),this._callbackConverter.toRemoteArg(function(s){r._isInitialized=!0,r._isReadOnly=s.isReadOnly,r._supportLinks=s.supportsLinks,r._supportProps=s.supportsProps,e()})]};this._worker.postMessage(o)}},t.prototype.isReadOnly=function(){return this._isReadOnly},t.prototype.supportsSynch=function(){return!1},t.prototype.supportsLinks=function(){return this._supportLinks},t.prototype.supportsProps=function(){return this._supportProps},t.prototype.rename=function(e,r,o){this._rpc("rename",arguments)},t.prototype.stat=function(e,r,o){this._rpc("stat",arguments)},t.prototype.open=function(e,r,o,s){this._rpc("open",arguments)},t.prototype.unlink=function(e,r){this._rpc("unlink",arguments)},t.prototype.rmdir=function(e,r){this._rpc("rmdir",arguments)},t.prototype.mkdir=function(e,r,o){this._rpc("mkdir",arguments)},t.prototype.readdir=function(e,r){this._rpc("readdir",arguments)},t.prototype.exists=function(e,r){this._rpc("exists",arguments)},t.prototype.realpath=function(e,r,o){this._rpc("realpath",arguments)},t.prototype.truncate=function(e,r,o){this._rpc("truncate",arguments)},t.prototype.readFile=function(e,r,o,s){this._rpc("readFile",arguments)},t.prototype.writeFile=function(e,r,o,s,c,y){this._rpc("writeFile",arguments)},t.prototype.appendFile=function(e,r,o,s,c,y){this._rpc("appendFile",arguments)},t.prototype.chmod=function(e,r,o,s){this._rpc("chmod",arguments)},t.prototype.chown=function(e,r,o,s,c){this._rpc("chown",arguments)},t.prototype.utimes=function(e,r,o,s){this._rpc("utimes",arguments)},t.prototype.link=function(e,r,o){this._rpc("link",arguments)},t.prototype.symlink=function(e,r,o,s){this._rpc("symlink",arguments)},t.prototype.readlink=function(e,r){this._rpc("readlink",arguments)},t.prototype.syncClose=function(e,r,o){this._worker.postMessage({browserfsMessage:!0,method:e,args:[r.toRemoteArg(),this._callbackConverter.toRemoteArg(o)]})},t.prototype._argRemote2Local=function(e){if(!e)return e;switch(typeof e){case"object":if(typeof e.type=="number"){var r=e;switch(r.type){case qt.API_ERROR:return Xi(r);case qt.FD:var o=r;return new er(this,o.path,O.getFileFlag(o.flag),A.fromBuffer(Ze(o.stat)),o.id,Ze(o.data));case qt.STATS:return Ki(r);case qt.FILEFLAG:return Qi(r);case qt.BUFFER:return tr(r);case qt.ERROR:return Zi(r);default:return e}}else return e;default:return e}},t.prototype._rpc=function(e,r){for(var o=this,s=new Array(r.length),c=0;c<r.length;c++)s[c]=o._argLocal2Remote(r[c]);var y={browserfsMessage:!0,method:e,args:s};this._worker.postMessage(y)},t.prototype._argLocal2Remote=function(e){if(!e)return e;switch(typeof e){case"object":return e instanceof A?Vi(e):e instanceof u?Mn(e):e instanceof er?e.toRemoteArg():e instanceof O?Ji(e):e instanceof g?$i(e):e instanceof Error?Yi(e):"Unknown argument";case"function":return this._callbackConverter.toRemoteArg(e);default:return e}},t})(Q);Pn.Name="WorkerFS",Pn.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(i,t){i.postMessage?t():t(new u(a.EINVAL,"option must be a Web Worker instance."))}}};function ls(i,t,n){var e=new XMLHttpRequest;e.open("GET",i,!0);var r=!0;switch(t){case"buffer":e.responseType="arraybuffer";break;case"json":try{e.responseType="json",r=e.responseType==="json"}catch{r=!1}break;default:return n(new u(a.EINVAL,"Invalid download type: "+t))}e.onreadystatechange=function(o){if(e.readyState===4)if(e.status===200)switch(t){case"buffer":return n(null,e.response?g.from(e.response):Mt());case"json":return r?n(null,e.response):n(null,JSON.parse(e.responseText))}else return n(new u(e.status,"XHR error."))},e.send()}function us(i,t){var n=new XMLHttpRequest;n.open("GET",i,!1);var e=null,r=null;if(n.overrideMimeType("text/plain; charset=x-user-defined"),n.onreadystatechange=function(o){if(n.readyState===4)if(n.status===200)switch(t){case"buffer":var s=n.responseText;e=g.alloc(s.length);for(var c=0;c<s.length;c++)e[c]=s.charCodeAt(c);return;case"json":e=JSON.parse(n.responseText);return}else{r=new u(n.status,"XHR error.");return}},n.send(),r)throw r;return e}function fs(i,t){var n=new XMLHttpRequest;switch(n.open("GET",i,!1),t){case"buffer":n.responseType="arraybuffer";break;case"json":break;default:throw new u(a.EINVAL,"Invalid download type: "+t)}var e,r;if(n.onreadystatechange=function(o){if(n.readyState===4)if(n.status===200)switch(t){case"buffer":e=g.from(n.response);break;case"json":e=JSON.parse(n.response);break}else r=new u(n.status,"XHR error.")},n.send(),r)throw r;return e}function nr(i,t,n){var e=new XMLHttpRequest;e.open("HEAD",t,i),e.onreadystatechange=function(r){if(e.readyState===4)if(e.status===200)try{return n(null,parseInt(e.getResponseHeader("Content-Length")||"-1",10))}catch{return n(new u(a.EIO,"XHR HEAD error: Could not read content-length."))}else return n(new u(e.status,"XHR HEAD error."))},e.send()}var ir=ls,hs=Et&&typeof Blob<"u"?fs:us;function ps(i){var t=-1;return nr(!1,i,function(n,e){if(n)throw n;t=e}),t}function ds(i,t){nr(!0,i,t)}var _e=function(){this._index={},this.addPath("/",new ye)};_e.fromListing=function(t){var n=new _e,e=new ye;n._index["/"]=e;for(var r=[["",t,e]];r.length>0;){var o=void 0,s=r.pop(),c=s[0],y=s[1],S=s[2];for(var D in y)if(y.hasOwnProperty(D)){var M=y[D],q=c+"/"+D;M?(n._index[q]=o=new ye,r.push([q,M,o])):o=new sn(new A(C.FILE,-1,365)),S&&(S._ls[D]=o)}}return n},_e.prototype.fileIterator=function(t){var n=this;for(var e in n._index)if(n._index.hasOwnProperty(e))for(var r=n._index[e],o=r.getListing(),s=0,c=o;s<c.length;s+=1){var y=c[s],S=r.getItem(y);Ae(S)&&t(S.getData())}},_e.prototype.addPath=function(t,n){if(!n)throw new Error("Inode must be specified");if(t[0]!=="/")throw new Error("Path must be absolute, got: "+t);if(this._index.hasOwnProperty(t))return this._index[t]===n;var e=this._split_path(t),r=e[0],o=e[1],s=this._index[r];return s===void 0&&t!=="/"&&(s=new ye,!this.addPath(r,s))||t!=="/"&&!s.addItem(o,n)?!1:(Ue(n)&&(this._index[t]=n),!0)},_e.prototype.addPathFast=function(t,n){var e=t.lastIndexOf("/"),r=e===0?"/":t.substring(0,e),o=t.substring(e+1),s=this._index[r];return s===void 0&&(s=new ye,this.addPathFast(r,s)),s.addItem(o,n)?(n.isDir()&&(this._index[t]=n),!0):!1},_e.prototype.removePath=function(t){var n=this,e=this._split_path(t),r=e[0],o=e[1],s=this._index[r];if(s===void 0)return null;var c=s.remItem(o);if(c===null)return null;if(Ue(c)){for(var y=c.getListing(),S=0,D=y;S<D.length;S+=1){var M=D[S];n.removePath(t+"/"+M)}t!=="/"&&delete this._index[t]}return c},_e.prototype.ls=function(t){var n=this._index[t];return n===void 0?null:n.getListing()},_e.prototype.getInode=function(t){var n=this._split_path(t),e=n[0],r=n[1],o=this._index[e];return o===void 0?null:e===t?o:o.getItem(r)},_e.prototype._split_path=function(t){var n=m.dirname(t),e=t.substr(n.length+(n==="/"?0:1));return[n,e]};var sn=function(t){this.data=t};sn.prototype.isFile=function(){return!0},sn.prototype.isDir=function(){return!1},sn.prototype.getData=function(){return this.data},sn.prototype.setData=function(t){this.data=t};var ye=function(t){t===void 0&&(t=null),this.data=t,this._ls={}};ye.prototype.isFile=function(){return!1},ye.prototype.isDir=function(){return!0},ye.prototype.getData=function(){return this.data},ye.prototype.getStats=function(){return new A(C.DIRECTORY,4096,365)},ye.prototype.getListing=function(){return Object.keys(this._ls)},ye.prototype.getItem=function(t){var n=this._ls[t];return n||null},ye.prototype.addItem=function(t,n){return t in this._ls?!1:(this._ls[t]=n,!0)},ye.prototype.remItem=function(t){var n=this._ls[t];return n===void 0?null:(delete this._ls[t],n)};function Ae(i){return!!i&&i.isFile()}function Ue(i){return!!i&&i.isDir()}function ys(i,t,n){try{n(null,i.toString(t))}catch(e){n(e)}}var Bn=(function(i){function t(n,e,r){e===void 0&&(e=""),r===void 0&&(r=!0),i.call(this),n||(n="index.json"),e.length>0&&e.charAt(e.length-1)!=="/"&&(e=e+"/"),this.prefixUrl=e;var o=null;if(typeof n=="string"){if(o=this._requestFileSync(n,"json"),!o)throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}else o=n;xt(r,t.Name,{index:typeof n=="string"?n:"file index as an object",baseUrl:e}),this._index=_e.fromListing(o)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){e.index===void 0&&(e.index="index.json"),typeof e.index=="string"?t.FromURL(e.index,r,e.baseUrl,!1):r(null,new t(e.index,e.baseUrl,!1))},t.isAvailable=function(){return typeof XMLHttpRequest<"u"&&XMLHttpRequest!==null},t.FromURL=function(e,r,o,s){o===void 0&&(o=e.slice(0,e.lastIndexOf("/")+1)),s===void 0&&(s=!0),s&&console.warn(`[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use 'XmlHttpRequest.Create({ index: "`+e+'", baseUrl: "'+o+`" }, cb)' instead.`),ir(e,"json",function(c,y){c?r(c):r(null,new t(y,o,!1))})},t.prototype.empty=function(){this._index.fileIterator(function(e){e.fileData=null})},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,r){r(0,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.preloadFile=function(e,r){var o=this._index.getInode(e);if(Ae(o)){if(o===null)throw u.ENOENT(e);var s=o.getData();s.size=r.length,s.fileData=r}else throw u.EISDIR(e)},t.prototype.stat=function(e,r,o){var s=this._index.getInode(e);if(s===null)return o(u.ENOENT(e));var c;Ae(s)?(c=s.getData(),c.size<0?this._requestFileSizeAsync(e,function(y,S){if(y)return o(y);c.size=S,o(null,c.clone())}):o(null,c.clone())):Ue(s)?(c=s.getStats(),o(null,c)):o(u.FileError(a.EINVAL,e))},t.prototype.statSync=function(e,r){var o=this._index.getInode(e);if(o===null)throw u.ENOENT(e);var s;if(Ae(o))s=o.getData(),s.size<0&&(s.size=this._requestFileSizeSync(e));else if(Ue(o))s=o.getStats();else throw u.FileError(a.EINVAL,e);return s},t.prototype.open=function(e,r,o,s){if(r.isWriteable())return s(new u(a.EPERM,e));var c=this,y=this._index.getInode(e);if(y===null)return s(u.ENOENT(e));if(Ae(y)){var S=y.getData();switch(r.pathExistsAction()){case L.THROW_EXCEPTION:case L.TRUNCATE_FILE:return s(u.EEXIST(e));case L.NOP:if(S.fileData)return s(null,new le(c,e,r,S.clone(),S.fileData));this._requestFileAsync(e,"buffer",function(D,M){return D?s(D):(S.size=M.length,S.fileData=M,s(null,new le(c,e,r,S.clone(),M)))});break;default:return s(new u(a.EINVAL,"Invalid FileMode object."))}}else return s(u.EISDIR(e))},t.prototype.openSync=function(e,r,o){if(r.isWriteable())throw new u(a.EPERM,e);var s=this._index.getInode(e);if(s===null)throw u.ENOENT(e);if(Ae(s)){var c=s.getData();switch(r.pathExistsAction()){case L.THROW_EXCEPTION:case L.TRUNCATE_FILE:throw u.EEXIST(e);case L.NOP:if(c.fileData)return new le(this,e,r,c.clone(),c.fileData);var y=this._requestFileSync(e,"buffer");return c.size=y.length,c.fileData=y,new le(this,e,r,c.clone(),y);default:throw new u(a.EINVAL,"Invalid FileMode object.")}}else throw u.EISDIR(e)},t.prototype.readdir=function(e,r){try{r(null,this.readdirSync(e))}catch(o){r(o)}},t.prototype.readdirSync=function(e){var r=this._index.getInode(e);if(r===null)throw u.ENOENT(e);if(Ue(r))return r.getListing();throw u.ENOTDIR(e)},t.prototype.readFile=function(e,r,o,s){var c=s;this.open(e,o,420,function(y,S){if(y)return s(y);s=function(q,$){S.close(function(nt){return q||(q=nt),c(q,$)})};var D=S,M=D.getBuffer();r===null?s(y,Ft(M)):ys(M,r,s)})},t.prototype.readFileSync=function(e,r,o){var s=this.openSync(e,o,420);try{var c=s,y=c.getBuffer();return r===null?Ft(y):y.toString(r)}finally{s.closeSync()}},t.prototype.getXhrPath=function(e){return e.charAt(0)==="/"&&(e=e.slice(1)),this.prefixUrl+e},t.prototype._requestFileAsync=function(e,r,o){ir(this.getXhrPath(e),r,o)},t.prototype._requestFileSync=function(e,r){return hs(this.getXhrPath(e),r)},t.prototype._requestFileSizeAsync=function(e,r){ds(this.getXhrPath(e),r)},t.prototype._requestFileSizeSync=function(e){return ps(this.getXhrPath(e))},t})(Q);Bn.Name="XmlHttpRequest",Bn.Options={index:{type:["string","object"],optional:!0,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:!0,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var Ve=function(){};Ve.str2byte=function(t,n){for(var e=t.length>n.length?n.length:t.length,r=0;r<e;r++){var o=t.charCodeAt(r);if(o>127){var s=Ve.extendedChars.indexOf(t.charAt(r));s>-1&&(o=s+128)}n[o]=r}return e},Ve.byte2str=function(t){for(var n=new Array(t.length),e=0;e<t.length;e++){var r=t[e];r>127?n[e]=Ve.extendedChars[r-128]:n[e]=String.fromCharCode(r)}return n.join("")},Ve.byteLength=function(t){return t.length},Ve.extendedChars=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];var ms=v(31).inflateRaw,rr={},or;(function(i){i[i.MSDOS=0]="MSDOS",i[i.AMIGA=1]="AMIGA",i[i.OPENVMS=2]="OPENVMS",i[i.UNIX=3]="UNIX",i[i.VM_CMS=4]="VM_CMS",i[i.ATARI_ST=5]="ATARI_ST",i[i.OS2_HPFS=6]="OS2_HPFS",i[i.MAC=7]="MAC",i[i.Z_SYSTEM=8]="Z_SYSTEM",i[i.CP_M=9]="CP_M",i[i.NTFS=10]="NTFS",i[i.MVS=11]="MVS",i[i.VSE=12]="VSE",i[i.ACORN_RISC=13]="ACORN_RISC",i[i.VFAT=14]="VFAT",i[i.ALT_MVS=15]="ALT_MVS",i[i.BEOS=16]="BEOS",i[i.TANDEM=17]="TANDEM",i[i.OS_400=18]="OS_400",i[i.OSX=19]="OSX"})(or||(or={}));var an;(function(i){i[i.STORED=0]="STORED",i[i.SHRUNK=1]="SHRUNK",i[i.REDUCED_1=2]="REDUCED_1",i[i.REDUCED_2=3]="REDUCED_2",i[i.REDUCED_3=4]="REDUCED_3",i[i.REDUCED_4=5]="REDUCED_4",i[i.IMPLODE=6]="IMPLODE",i[i.DEFLATE=8]="DEFLATE",i[i.DEFLATE64=9]="DEFLATE64",i[i.TERSE_OLD=10]="TERSE_OLD",i[i.BZIP2=12]="BZIP2",i[i.LZMA=14]="LZMA",i[i.TERSE_NEW=18]="TERSE_NEW",i[i.LZ77=19]="LZ77",i[i.WAVPACK=97]="WAVPACK",i[i.PPMD=98]="PPMD"})(an||(an={}));function sr(i,t){var n=t&31,e=(t>>5&15)-1,r=(t>>9)+1980,o=i&31,s=i>>5&63,c=i>>11;return new Date(r,e,n,c,s,o)}function Un(i,t,n,e){return e===0?"":t?i.toString("utf8",n,n+e):Ve.byte2str(i.slice(n,n+e))}var we=function(t){if(this.data=t,t.readUInt32LE(0)!==67324752)throw new u(a.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))};we.prototype.versionNeeded=function(){return this.data.readUInt16LE(4)},we.prototype.flags=function(){return this.data.readUInt16LE(6)},we.prototype.compressionMethod=function(){return this.data.readUInt16LE(8)},we.prototype.lastModFileTime=function(){return sr(this.data.readUInt16LE(10),this.data.readUInt16LE(12))},we.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(10)},we.prototype.crc32=function(){return this.data.readUInt32LE(14)},we.prototype.fileNameLength=function(){return this.data.readUInt16LE(26)},we.prototype.extraFieldLength=function(){return this.data.readUInt16LE(28)},we.prototype.fileName=function(){return Un(this.data,this.useUTF8(),30,this.fileNameLength())},we.prototype.extraField=function(){var t=30+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},we.prototype.totalSize=function(){return 30+this.fileNameLength()+this.extraFieldLength()},we.prototype.useUTF8=function(){return(this.flags()&2048)===2048};var Sn=function(t,n,e){this.header=t,this.record=n,this.data=e};Sn.prototype.decompress=function(){var t=this.header.compressionMethod(),n=rr[t];if(n)return n(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag());var e=an[t];throw e||(e="Unknown: "+t),new u(a.EINVAL,"Invalid compression method on file '"+this.header.fileName()+"': "+e)},Sn.prototype.getHeader=function(){return this.header},Sn.prototype.getRecord=function(){return this.record},Sn.prototype.getRawData=function(){return this.data};var Nt=function(t,n){if(this.zipData=t,this.data=n,this.data.readUInt32LE(0)!==33639248)throw new u(a.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0));this._filename=this.produceFilename()};Nt.prototype.versionMadeBy=function(){return this.data.readUInt16LE(4)},Nt.prototype.versionNeeded=function(){return this.data.readUInt16LE(6)},Nt.prototype.flag=function(){return this.data.readUInt16LE(8)},Nt.prototype.compressionMethod=function(){return this.data.readUInt16LE(10)},Nt.prototype.lastModFileTime=function(){return sr(this.data.readUInt16LE(12),this.data.readUInt16LE(14))},Nt.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(12)},Nt.prototype.crc32=function(){return this.data.readUInt32LE(16)},Nt.prototype.compressedSize=function(){return this.data.readUInt32LE(20)},Nt.prototype.uncompressedSize=function(){return this.data.readUInt32LE(24)},Nt.prototype.fileNameLength=function(){return this.data.readUInt16LE(28)},Nt.prototype.extraFieldLength=function(){return this.data.readUInt16LE(30)},Nt.prototype.fileCommentLength=function(){return this.data.readUInt16LE(32)},Nt.prototype.diskNumberStart=function(){return this.data.readUInt16LE(34)},Nt.prototype.internalAttributes=function(){return this.data.readUInt16LE(36)},Nt.prototype.externalAttributes=function(){return this.data.readUInt32LE(38)},Nt.prototype.headerRelativeOffset=function(){return this.data.readUInt32LE(42)},Nt.prototype.produceFilename=function(){var t=Un(this.data,this.useUTF8(),46,this.fileNameLength());return t.replace(/\\/g,"/")},Nt.prototype.fileName=function(){return this._filename},Nt.prototype.rawFileName=function(){return this.data.slice(46,46+this.fileNameLength())},Nt.prototype.extraField=function(){var t=44+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},Nt.prototype.fileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return Un(this.data,this.useUTF8(),t,this.fileCommentLength())},Nt.prototype.rawFileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(t,t+this.fileCommentLength())},Nt.prototype.totalSize=function(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()},Nt.prototype.isDirectory=function(){var t=this.fileName();return!!(this.externalAttributes()&16)||t.charAt(t.length-1)==="/"},Nt.prototype.isFile=function(){return!this.isDirectory()},Nt.prototype.useUTF8=function(){return(this.flag()&2048)===2048},Nt.prototype.isEncrypted=function(){return(this.flag()&1)===1},Nt.prototype.getFileData=function(){var t=this.headerRelativeOffset(),n=new we(this.zipData.slice(t));return new Sn(n,this,this.zipData.slice(t+n.totalSize()))},Nt.prototype.getData=function(){return this.getFileData().decompress()},Nt.prototype.getRawData=function(){return this.getFileData().getRawData()},Nt.prototype.getStats=function(){return new A(C.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var xe=function(t){if(this.data=t,this.data.readUInt32LE(0)!==101010256)throw new u(a.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))};xe.prototype.diskNumber=function(){return this.data.readUInt16LE(4)},xe.prototype.cdDiskNumber=function(){return this.data.readUInt16LE(6)},xe.prototype.cdDiskEntryCount=function(){return this.data.readUInt16LE(8)},xe.prototype.cdTotalEntryCount=function(){return this.data.readUInt16LE(10)},xe.prototype.cdSize=function(){return this.data.readUInt32LE(12)},xe.prototype.cdOffset=function(){return this.data.readUInt32LE(16)},xe.prototype.cdZipCommentLength=function(){return this.data.readUInt16LE(20)},xe.prototype.cdZipComment=function(){return Un(this.data,!0,22,this.cdZipCommentLength())},xe.prototype.rawCdZipComment=function(){return this.data.slice(22,22+this.cdZipCommentLength())};var ar=function(t,n,e,r){this.index=t,this.directoryEntries=n,this.eocd=e,this.data=r},Ke=(function(i){function t(n,e,r){e===void 0&&(e=""),r===void 0&&(r=!0),i.call(this),this.name=e,this._index=new _e,this._directoryEntries=[],this._eocd=null,xt(r,t.Name,{zipData:"zip data as a Buffer",name:e}),n instanceof ar?(this._index=n.index,this._directoryEntries=n.directoryEntries,this._eocd=n.eocd,this.data=n.data):(this.data=n,this.populateIndex())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){try{t.computeIndex(e.zipData,function(o){var s=new t(o,e.name,!1);r(null,s)},!1)}catch(o){r(o)}},t.isAvailable=function(){return!0},t.RegisterDecompressionMethod=function(e,r){rr[e]=r},t.computeIndex=function(e,r,o){o===void 0&&(o=!0),o&&console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use 'ZipFS.Create({ zipData: zip file as a Buffer}, cb)' instead.");var s=new _e,c=t.getEOCD(e);if(c.diskNumber()!==c.cdDiskNumber())throw new u(a.EINVAL,"ZipFS does not support spanned zip files.");var y=c.cdOffset();if(y===4294967295)throw new u(a.EINVAL,"ZipFS does not support Zip64.");var S=y+c.cdSize();t.computeIndexResponsive(e,s,y,S,r,[],c)},t.getEOCD=function(e){for(var r=22,o=Math.min(r+65535,e.length-1),s=r;s<o;s++)if(e.readUInt32LE(e.length-s)===101010256)return new xe(e.slice(e.length-s));throw new u(a.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")},t.addToIndex=function(e,r){var o=e.fileName();if(o.charAt(0)==="/")throw new Error("WHY IS THIS ABSOLUTE");o.charAt(o.length-1)==="/"&&(o=o.substr(0,o.length-1)),e.isDirectory()?r.addPathFast("/"+o,new ye(e)):r.addPathFast("/"+o,new sn(e))},t.computeIndexResponsive=function(e,r,o,s,c,y,S){if(o<s){for(var D=0;D++<200&&o<s;){var M=new Nt(e,e.slice(o));t.addToIndex(M,r),o+=M.totalSize(),y.push(M)}oi(function(){t.computeIndexResponsive(e,r,o,s,c,y,S)})}else c(new ar(r,y,S,e))},t.prototype.getName=function(){return t.Name+(this.name!==""?" "+this.name:"")},t.prototype.getCentralDirectoryEntry=function(e){var r=this._index.getInode(e);if(r===null)throw u.ENOENT(e);if(Ae(r))return r.getData();if(Ue(r))return r.getData();throw u.EPERM("Invalid inode: "+r)},t.prototype.getCentralDirectoryEntryAt=function(e){var r=this._directoryEntries[e];if(!r)throw new RangeError("Invalid directory index: "+e+".");return r},t.prototype.getNumberOfCentralDirectoryEntries=function(){return this._directoryEntries.length},t.prototype.getEndOfCentralDirectory=function(){return this._eocd},t.prototype.diskSpace=function(e,r){r(this.data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,r){var o=this._index.getInode(e);if(o===null)throw u.ENOENT(e);var s;if(Ae(o))s=o.getData().getStats();else if(Ue(o))s=o.getStats();else throw new u(a.EINVAL,"Invalid inode.");return s},t.prototype.openSync=function(e,r,o){if(r.isWriteable())throw new u(a.EPERM,e);var s=this._index.getInode(e);if(s)if(Ae(s)){var c=s.getData(),y=c.getStats();switch(r.pathExistsAction()){case L.THROW_EXCEPTION:case L.TRUNCATE_FILE:throw u.EEXIST(e);case L.NOP:return new le(this,e,r,y,c.getData());default:throw new u(a.EINVAL,"Invalid FileMode object.")}}else throw u.EISDIR(e);else throw u.ENOENT(e)},t.prototype.readdirSync=function(e){var r=this._index.getInode(e);if(r){if(Ue(r))return r.getListing();throw u.ENOTDIR(e)}else throw u.ENOENT(e)},t.prototype.readFileSync=function(e,r,o){var s=this.openSync(e,o,420);try{var c=s,y=c.getBuffer();return r===null?Ft(y):y.toString(r)}finally{s.closeSync()}},t.prototype.populateIndex=function(){var e=this,r=this._eocd=t.getEOCD(this.data);if(r.diskNumber()!==r.cdDiskNumber())throw new u(a.EINVAL,"ZipFS does not support spanned zip files.");var o=r.cdOffset();if(o===4294967295)throw new u(a.EINVAL,"ZipFS does not support Zip64.");for(var s=o+r.cdSize();o<s;){var c=new Nt(e.data,e.data.slice(o));o+=c.totalSize(),t.addToIndex(c,e._index),e._directoryEntries.push(c)}},t})(ne);Ke.Name="ZipFS",Ke.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:T},name:{type:"string",optional:!0,description:"The name of the zip file (optional)."}},Ke.CompressionMethod=an,Ke.RegisterDecompressionMethod(an.DEFLATE,function(i,t,n){return Rt(ms(i.slice(0,t),{chunkSize:n}))}),Ke.RegisterDecompressionMethod(an.STORED,function(i,t,n){return Ft(i,0,n)});var vs="IEEE_P1282";function me(i,t,n){return i.toString("ascii",t,t+n).trim()}function ai(i,t,n){if(n===1)return String.fromCharCode(i[t]);for(var e=Math.floor(n/2),r=new Array(e),o=0;o<e;o++){var s=t+(o<<1);r[o]=String.fromCharCode(i[s+1]|i[s]<<8)}return r.join("")}function Le(i,t){var n=parseInt(me(i,t,4),10),e=parseInt(me(i,t+4,2),10),r=parseInt(me(i,t+6,2),10),o=parseInt(me(i,t+8,2),10),s=parseInt(me(i,t+10,2),10),c=parseInt(me(i,t+12,2),10),y=parseInt(me(i,t+14,2),10);return new Date(n,e,r,o,s,c,y*100)}function Je(i,t){var n=i[t],e=i[t+1],r=i[t+2],o=i[t+3],s=i[t+4],c=i[t+5];return new Date(n,e-1,r,o,s,c)}function gs(i,t){var n=i.slice(t),e=new Qt(n);switch(e.signatureWord()){case 17221:return new hr(n);case 20548:return new Es(n);case 21328:return new pr(n);case 21332:return new dr(n);case 17746:return new yr(n);case 17747:return new _s(n);case 20568:return new vr(n);case 20558:return new bs(n);case 21324:return new ci(n);case 20045:return new gr(n);case 17228:return new li(n);case 20556:return new ks(n);case 21061:return new wr(n);case 21574:return new Sr(n);case 21318:return new Is(n);case 21074:return new mr(n);default:return e}}function cr(i,t,n,e){n=n-4;for(var r=new Array;t<n;){var o=gs(i,t),s=o.length();if(s===0)return r;if(t+=s,o instanceof dr)break;o instanceof hr?r=r.concat(o.getEntries(e)):r.push(o)}return r}var cn=function(t){this._data=t};cn.prototype.type=function(){return this._data[0]},cn.prototype.standardIdentifier=function(){return me(this._data,1,5)},cn.prototype.version=function(){return this._data[6]},cn.prototype.data=function(){return this._data.slice(7,2048)};var lr=(function(i){function t(n){i.call(this,n),this._root=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.systemIdentifier=function(){return this._getString32(8)},t.prototype.volumeIdentifier=function(){return this._getString32(40)},t.prototype.volumeSpaceSize=function(){return this._data.readUInt32LE(80)},t.prototype.volumeSetSize=function(){return this._data.readUInt16LE(120)},t.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(124)},t.prototype.logicalBlockSize=function(){return this._data.readUInt16LE(128)},t.prototype.pathTableSize=function(){return this._data.readUInt32LE(132)},t.prototype.locationOfTypeLPathTable=function(){return this._data.readUInt32LE(140)},t.prototype.locationOfOptionalTypeLPathTable=function(){return this._data.readUInt32LE(144)},t.prototype.locationOfTypeMPathTable=function(){return this._data.readUInt32BE(148)},t.prototype.locationOfOptionalTypeMPathTable=function(){return this._data.readUInt32BE(152)},t.prototype.rootDirectoryEntry=function(e){return this._root===null&&(this._root=this._constructRootDirectoryRecord(this._data.slice(156)),this._root.rootCheckForRockRidge(e)),this._root},t.prototype.volumeSetIdentifier=function(){return this._getString(190,128)},t.prototype.publisherIdentifier=function(){return this._getString(318,128)},t.prototype.dataPreparerIdentifier=function(){return this._getString(446,128)},t.prototype.applicationIdentifier=function(){return this._getString(574,128)},t.prototype.copyrightFileIdentifier=function(){return this._getString(702,38)},t.prototype.abstractFileIdentifier=function(){return this._getString(740,36)},t.prototype.bibliographicFileIdentifier=function(){return this._getString(776,37)},t.prototype.volumeCreationDate=function(){return Le(this._data,813)},t.prototype.volumeModificationDate=function(){return Le(this._data,830)},t.prototype.volumeExpirationDate=function(){return Le(this._data,847)},t.prototype.volumeEffectiveDate=function(){return Le(this._data,864)},t.prototype.fileStructureVersion=function(){return this._data[881]},t.prototype.applicationUsed=function(){return this._data.slice(883,1395)},t.prototype.reserved=function(){return this._data.slice(1395,2048)},t.prototype._getString32=function(e){return this._getString(e,32)},t})(cn),ws=(function(i){function t(n){if(i.call(this,n),this.type()!==1)throw new u(a.EIO,"Invalid primary volume descriptor.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"ISO9660"},t.prototype._constructRootDirectoryRecord=function(e){return new ur(e,-1)},t.prototype._getString=function(e,r){return this._getString(e,r)},t})(lr),Ss=(function(i){function t(n){if(i.call(this,n),this.type()!==2)throw new u(a.EIO,"Invalid supplementary volume descriptor.");var e=this.escapeSequence(),r=e[2];if(e[0]!==37||e[1]!==47||r!==64&&r!==67&&r!==69)throw new u(a.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+e.toString())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"Joliet"},t.prototype.escapeSequence=function(){return this._data.slice(88,120)},t.prototype._constructRootDirectoryRecord=function(e){return new fr(e,-1)},t.prototype._getString=function(e,r){return ai(this._data,e,r)},t})(lr),jt=function(t,n){this._suEntries=null,this._fileOrDir=null,this._data=t,this._rockRidgeOffset=n};jt.prototype.hasRockRidge=function(){return this._rockRidgeOffset>-1},jt.prototype.getRockRidgeOffset=function(){return this._rockRidgeOffset},jt.prototype.rootCheckForRockRidge=function(t){var n=this.getDirectory(t);this._rockRidgeOffset=n.getDotEntry(t)._getRockRidgeOffset(t),this._rockRidgeOffset>-1&&(this._fileOrDir=null)},jt.prototype.length=function(){return this._data[0]},jt.prototype.extendedAttributeRecordLength=function(){return this._data[1]},jt.prototype.lba=function(){return this._data.readUInt32LE(2)*2048},jt.prototype.dataLength=function(){return this._data.readUInt32LE(10)},jt.prototype.recordingDate=function(){return Je(this._data,18)},jt.prototype.fileFlags=function(){return this._data[25]},jt.prototype.fileUnitSize=function(){return this._data[26]},jt.prototype.interleaveGapSize=function(){return this._data[27]},jt.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(28)},jt.prototype.identifier=function(){return this._getString(33,this._data[32])},jt.prototype.fileName=function(t){if(this.hasRockRidge()){var n=this._rockRidgeFilename(t);if(n!==null)return n}var e=this.identifier();if(this.isDirectory(t))return e;var r=e.indexOf(";");return r===-1?e:e[r-1]==="."?e.slice(0,r-1):e.slice(0,r)},jt.prototype.isDirectory=function(t){var n=!!(this.fileFlags()&2);return!n&&this.hasRockRidge()&&(n=this.getSUEntries(t).filter(function(e){return e instanceof li}).length>0),n},jt.prototype.isSymlink=function(t){return this.hasRockRidge()&&this.getSUEntries(t).filter(function(n){return n instanceof ci}).length>0},jt.prototype.getSymlinkPath=function(t){for(var n="",e=this.getSUEntries(t),r=this._getGetString(),o=0,s=e;o<s.length;o+=1){var c=s[o];if(c instanceof ci){for(var y=c.componentRecords(),S=0,D=y;S<D.length;S+=1){var M=D[S],q=M.flags();q&2?n+="./":q&4?n+="../":q&8?n+="/":(n+=M.content(r),q&1||(n+="/"))}if(!c.continueFlag())break}}return n.length>1&&n[n.length-1]==="/"?n.slice(0,n.length-1):n},jt.prototype.getFile=function(t){if(this.isDirectory(t))throw new Error("Tried to get a File from a directory.");return this._fileOrDir===null&&(this._fileOrDir=t.slice(this.lba(),this.lba()+this.dataLength())),this._fileOrDir},jt.prototype.getDirectory=function(t){if(!this.isDirectory(t))throw new Error("Tried to get a Directory from a file.");return this._fileOrDir===null&&(this._fileOrDir=this._constructDirectory(t)),this._fileOrDir},jt.prototype.getSUEntries=function(t){return this._suEntries||this._constructSUEntries(t),this._suEntries},jt.prototype._rockRidgeFilename=function(t){var n=this.getSUEntries(t).filter(function(y){return y instanceof gr});if(n.length===0||n[0].flags()&6)return null;for(var e="",r=this._getGetString(),o=0,s=n;o<s.length;o+=1){var c=s[o];if(e+=c.name(r),!(c.flags()&1))break}return e},jt.prototype._constructSUEntries=function(t){var n=33+this._data[32];n%2===1&&n++,n+=this._rockRidgeOffset,this._suEntries=cr(this._data,n,this.length(),t)},jt.prototype._getRockRidgeOffset=function(t){this._rockRidgeOffset=0;var n=this.getSUEntries(t);if(n.length>0){var e=n[0];if(e instanceof pr&&e.checkBytesPass())for(var r=1;r<n.length;r++){var o=n[r];if(o instanceof mr||o instanceof yr&&o.extensionIdentifier()===vs)return e.bytesSkipped()}}return this._rockRidgeOffset=-1,-1};var ur=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,r){return me(this._data,e,r)},t.prototype._constructDirectory=function(e){return new Rs(this,e)},t.prototype._getGetString=function(){return me},t})(jt),fr=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,r){return ai(this._data,e,r)},t.prototype._constructDirectory=function(e){return new xs(this,e)},t.prototype._getGetString=function(){return ai},t})(jt),Qt=function(t){this._data=t};Qt.prototype.signatureWord=function(){return this._data.readUInt16BE(0)},Qt.prototype.signatureWordString=function(){return me(this._data,0,2)},Qt.prototype.length=function(){return this._data[2]},Qt.prototype.suVersion=function(){return this._data[3]};var hr=(function(i){function t(n){i.call(this,n),this._entries=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.continuationLba=function(){return this._data.readUInt32LE(4)},t.prototype.continuationLbaOffset=function(){return this._data.readUInt32LE(12)},t.prototype.continuationLength=function(){return this._data.readUInt32LE(20)},t.prototype.getEntries=function(e){if(!this._entries){var r=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=cr(e,r,this.continuationLength(),e)}return this._entries},t})(Qt),Es=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t})(Qt),pr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.checkBytesPass=function(){return this._data[4]===190&&this._data[5]===239},t.prototype.bytesSkipped=function(){return this._data[6]},t})(Qt),dr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t})(Qt),yr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.identifierLength=function(){return this._data[4]},t.prototype.descriptorLength=function(){return this._data[5]},t.prototype.sourceLength=function(){return this._data[6]},t.prototype.extensionVersion=function(){return this._data[7]},t.prototype.extensionIdentifier=function(){return me(this._data,8,this.identifierLength())},t.prototype.extensionDescriptor=function(){return me(this._data,8+this.identifierLength(),this.descriptorLength())},t.prototype.extensionSource=function(){return me(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())},t})(Qt),_s=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.extensionSequence=function(){return this._data[4]},t})(Qt),mr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t})(Qt),vr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.mode=function(){return this._data.readUInt32LE(4)},t.prototype.fileLinks=function(){return this._data.readUInt32LE(12)},t.prototype.uid=function(){return this._data.readUInt32LE(20)},t.prototype.gid=function(){return this._data.readUInt32LE(28)},t.prototype.inode=function(){return this._data.readUInt32LE(36)},t})(Qt),bs=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.devTHigh=function(){return this._data.readUInt32LE(4)},t.prototype.devTLow=function(){return this._data.readUInt32LE(12)},t})(Qt),ci=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.continueFlag=function(){return this.flags()&1},t.prototype.componentRecords=function(){for(var e=this,r=new Array,o=5;o<this.length();){var s=new En(e._data.slice(o));r.push(s),o+=s.length()}return r},t})(Qt),En=function(t){this._data=t};En.prototype.flags=function(){return this._data[0]},En.prototype.length=function(){return 2+this.componentLength()},En.prototype.componentLength=function(){return this._data[1]},En.prototype.content=function(t){return t(this._data,2,this.componentLength())};var gr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.name=function(e){return e(this._data,5,this.length()-5)},t})(Qt),li=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.childDirectoryLba=function(){return this._data.readUInt32LE(4)},t})(Qt),ks=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.parentDirectoryLba=function(){return this._data.readUInt32LE(4)},t})(Qt),wr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t})(Qt),Sr=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.creation=function(){return this.flags()&1?this._longFormDates()?Le(this._data,5):Je(this._data,5):null},t.prototype.modify=function(){if(this.flags()&2){var e=this.flags()&1?1:0;return this._longFormDates?Le(this._data,5+e*17):Je(this._data,5+e*7)}else return null},t.prototype.access=function(){if(this.flags()&4){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,this._longFormDates?Le(this._data,5+e*17):Je(this._data,5+e*7)}else return null},t.prototype.backup=function(){if(this.flags()&16){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,this._longFormDates?Le(this._data,5+e*17):Je(this._data,5+e*7)}else return null},t.prototype.expiration=function(){if(this.flags()&32){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,this._longFormDates?Le(this._data,5+e*17):Je(this._data,5+e*7)}else return null},t.prototype.effective=function(){if(this.flags()&64){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,e+=this.flags()&32?1:0,this._longFormDates?Le(this._data,5+e*17):Je(this._data,5+e*7)}else return null},t.prototype._longFormDates=function(){return!!this.flags()},t})(Qt),Is=(function(i){function t(n){i.call(this,n)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.virtualSizeHigh=function(){return this._data.readUInt32LE(4)},t.prototype.virtualSizeLow=function(){return this._data.readUInt32LE(12)},t.prototype.tableDepth=function(){return this._data[20]},t})(Qt),_n=function(t,n){var e=this;this._fileList=[],this._fileMap={},this._record=t;var r=t.lba(),o=r+t.dataLength();if(!(t.fileFlags()&2)){var s=t.getSUEntries(n).filter(function(D){return D instanceof li})[0];r=s.childDirectoryLba()*2048,o=1/0}for(;r<o;){var c=n[r];if(c===0){r++;continue}var y=e._constructDirectoryRecord(n.slice(r)),S=y.fileName(n);S!=="\0"&&S!==""?(!y.hasRockRidge()||y.getSUEntries(n).filter(function(D){return D instanceof wr}).length===0)&&(e._fileMap[S]=y,e._fileList.push(S)):o===1/0&&(o=r+y.dataLength()),r+=y.length()}};_n.prototype.getRecord=function(t){return this._fileMap[t]},_n.prototype.getFileList=function(){return this._fileList},_n.prototype.getDotEntry=function(t){return this._constructDirectoryRecord(t.slice(this._record.lba()))};var Rs=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new ur(e,this._record.getRockRidgeOffset())},t})(_n),xs=(function(i){function t(n,e){i.call(this,n,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new fr(e,this._record.getRockRidgeOffset())},t})(_n),zn=(function(i){function t(n,e,r){var o=this;e===void 0&&(e=""),r===void 0&&(r=!0),i.call(this),this._data=n,xt(r,t.Name,{data:"ISO data as a Buffer",name:e});for(var s=!1,c=16*2048,y=new Array;!s;){var S=n.slice(c),D=new cn(S);switch(D.type()){case 1:y.push(new ws(S));break;case 2:y.push(new Ss(S));break;case 255:s=!0;break}c+=2048}if(y.length===0)throw new u(a.EIO,"Unable to find a suitable volume descriptor.");y.forEach(function(M){(!o._pvd||o._pvd.type()!==2)&&(o._pvd=M)}),this._root=this._pvd.rootDirectoryEntry(n),this._name=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,r){var o,s;try{o=new t(e.data,e.name,!1)}catch(c){c=c}finally{r(s,o)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){var e="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");return this._root&&this._root.hasRockRidge()&&(e+="-RockRidge"),e},t.prototype.diskSpace=function(e,r){r(this._data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,r){var o=this._getDirectoryRecord(e);if(o===null)throw u.ENOENT(e);return this._getStats(e,o)},t.prototype.openSync=function(e,r,o){if(r.isWriteable())throw new u(a.EPERM,e);var s=this._getDirectoryRecord(e);if(s){if(s.isSymlink(this._data))return this.openSync(m.resolve(e,s.getSymlinkPath(this._data)),r,o);if(s.isDirectory(this._data))throw u.EISDIR(e);var c=s.getFile(this._data),y=this._getStats(e,s);switch(r.pathExistsAction()){case L.THROW_EXCEPTION:case L.TRUNCATE_FILE:throw u.EEXIST(e);case L.NOP:return new le(this,e,r,y,c);default:throw new u(a.EINVAL,"Invalid FileMode object.")}}else throw u.ENOENT(e)},t.prototype.readdirSync=function(e){var r=this._getDirectoryRecord(e);if(r){if(r.isDirectory(this._data))return r.getDirectory(this._data).getFileList().slice(0);throw u.ENOTDIR(e)}else throw u.ENOENT(e)},t.prototype.readFileSync=function(e,r,o){var s=this.openSync(e,o,420);try{var c=s,y=c.getBuffer();return r===null?Ft(y):y.toString(r)}finally{s.closeSync()}},t.prototype._getDirectoryRecord=function(e){var r=this;if(e==="/")return this._root;for(var o=e.split("/").slice(1),s=this._root,c=0,y=o;c<y.length;c+=1){var S=y[c];if(s.isDirectory(r._data)){if(s=s.getDirectory(r._data).getRecord(S),!s)return null}else return null}return s},t.prototype._getStats=function(e,r){if(r.isSymlink(this._data)){var o=m.resolve(e,r.getSymlinkPath(this._data)),s=this._getDirectoryRecord(o);return s?this._getStats(o,s):null}else{var c=r.dataLength(),y=365,S=r.recordingDate(),D=S,M=S,q=S;if(r.hasRockRidge())for(var $=r.getSUEntries(this._data),nt=0,ut=$;nt<ut.length;nt+=1){var yt=ut[nt];if(yt instanceof vr)y=yt.mode();else if(yt instanceof Sr){var It=yt.flags();It&4&&(D=yt.access()),It&2&&(M=yt.modify()),It&1&&(q=yt.creation())}}return y=y&365,new A(r.isDirectory(this._data)?C.DIRECTORY:C.FILE,c,y,D,M,q)}},t})(ne);zn.Name="IsoFS",zn.Options={data:{type:"object",description:"The ISO file in a buffer",validator:T}},[I,Ln,Tn,en,On,nn,dn,zn,mn,rn,wn,Pn,Bn,Ke].forEach(function(i){var t=i.Create;i.Create=function(n,e){var r=typeof n=="function",o=r?n:e,s=r?{}:n;function c(y){y?o(y):t.call(i,s,o)}F(i,s,c)}});var jn={AsyncMirror:I,Dropbox:Ln,Emscripten:Tn,FolderAdapter:en,HTML5FS:On,InMemory:nn,IndexedDB:dn,IsoFS:zn,LocalStorage:mn,MountableFileSystem:rn,OverlayFS:wn,WorkerFS:Pn,XmlHttpRequest:Bn,ZipFS:Ke};k.initializeTTYs&&k.initializeTTYs();function Ls(i){i.Buffer=g,i.process=k;var t=i.require?i.require:null;i.require=function(n){var e=Er(n);return e||t.apply(null,Array.prototype.slice.call(arguments,0))}}function Ts(i,t){jn[i]=t}function Er(i){switch(i){case"fs":return lt;case"path":return m;case"buffer":return w;case"process":return k;case"bfs_utils":return Z;default:return jn[i]}}function _r(i){return lt.initialize(i)}function Fs(i,t){ui(i,function(n,e){e?(_r(e),t()):t(n)})}function ui(i,t){var n=i.fs;if(!n)return t(new u(a.EPERM,'Missing "fs" property on configuration object.'));var e=i.options,r=0,o=!1;function s(){if(!o){o=!0;var S=jn[n];S?S.Create(e,t):t(new u(a.EPERM,"File system "+n+" is not available in BrowserFS."))}}if(e!==null&&typeof e=="object"){var c=!1,y=Object.keys(e).filter(function(S){return S!=="fs"});y.forEach(function(S){var D=e[S];D!==null&&typeof D=="object"&&D.fs&&(r++,ui(D,function(M,q){if(r--,M){if(o)return;o=!0,t(M)}else e[S]=q,r===0&&c&&s()}))}),c=!0}r===0&&s()}"ab".substr(-1)!=="b"&&(String.prototype.substr=(function(i){return function(t,n){return t<0&&(t=this.length+t),i.call(this,t,n)}})(String.prototype.substr)),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&(Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(i,t){i===void 0&&(i=0),t===void 0&&(t=this.length);var n=this;return i<0&&(i=this.length+i,i<0&&(i=0)),t<0&&(t=this.length+t,t<0&&(t=0)),t<i&&(t=i),new Uint8Array(n.buffer,n.byteOffset+i,t-i)})),d.install=Ls,d.registerFileSystem=Ts,d.BFSRequire=Er,d.initialize=_r,d.configure=Fs,d.getFileSystem=ui,d.EmscriptenFS=bt,d.FileSystem=jn,d.Errors=N,d.setImmediate=oi}).call(d,v(1),(function(){return this})(),v(5)(f),v(6))},function(f,d,v){f.exports=v(2).Buffer},function(f,d,v){(function(a){var R=v(3),E=v(4);d.Buffer=a,d.SlowBuffer=H,d.INSPECT_MAX_BYTES=50;var k=2147483647;d.kMaxLength=k,a.TYPED_ARRAY_SUPPORT=w(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function w(){try{var I=new Uint8Array(1);return I.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},I.foo()===42}catch{return!1}}function m(I){if(I>k)throw new RangeError("Invalid typed array length");var h=new Uint8Array(I);return h.__proto__=a.prototype,h}function a(I,h,p){if(typeof I=="number"){if(typeof h=="string")throw new Error("If encoding is specified then the first argument must be a string");return L(I)}return b(I,h,p)}typeof Symbol<"u"&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),a.poolSize=8192;function b(I,h,p){if(typeof I=="number")throw new TypeError('"value" argument must not be a number');return oe(I)?A(I,h,p):typeof I=="string"?O(I,h):J(I)}a.from=function(I,h,p){return b(I,h,p)},a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array;function u(I){if(typeof I!="number")throw new TypeError('"size" argument must be a number');if(I<0)throw new RangeError('"size" argument must not be negative')}function N(I,h,p){return u(I),I<=0?m(I):h!==void 0?typeof p=="string"?m(I).fill(h,p):m(I).fill(h):m(I)}a.alloc=function(I,h,p){return N(I,h,p)};function L(I){return u(I),m(I<0?0:B(I)|0)}a.allocUnsafe=function(I){return L(I)},a.allocUnsafeSlow=function(I){return L(I)};function O(I,h){if((typeof h!="string"||h==="")&&(h="utf8"),!a.isEncoding(h))throw new TypeError('"encoding" must be a valid string encoding');var p=St(I,h)|0,x=m(p),P=x.write(I,h);return P!==p&&(x=x.slice(0,P)),x}function C(I){for(var h=I.length<0?0:B(I.length)|0,p=m(h),x=0;x<h;x+=1)p[x]=I[x]&255;return p}function A(I,h,p){if(h<0||I.byteLength<h)throw new RangeError("'offset' is out of bounds");if(I.byteLength<h+(p||0))throw new RangeError("'length' is out of bounds");var x;return h===void 0&&p===void 0?x=new Uint8Array(I):p===void 0?x=new Uint8Array(I,h):x=new Uint8Array(I,h,p),x.__proto__=a.prototype,x}function J(I){if(a.isBuffer(I)){var h=B(I.length)|0,p=m(h);return p.length===0||I.copy(p,0,0,h),p}if(I){if(le(I)||"length"in I)return typeof I.length!="number"||be(I.length)?m(0):C(I);if(I.type==="Buffer"&&Array.isArray(I.data))return C(I.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function B(I){if(I>=k)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+k.toString(16)+" bytes");return I|0}function H(I){return+I!=I&&(I=0),a.alloc(+I)}a.isBuffer=function(h){return h!=null&&h._isBuffer===!0},a.compare=function(h,p){if(!a.isBuffer(h)||!a.isBuffer(p))throw new TypeError("Arguments must be Buffers");if(h===p)return 0;for(var x=h.length,P=p.length,G=0,V=Math.min(x,P);G<V;++G)if(h[G]!==p[G]){x=h[G],P=p[G];break}return x<P?-1:P<x?1:0},a.isEncoding=function(h){switch(String(h).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(h,p){if(!Array.isArray(h))throw new TypeError('"list" argument must be an Array of Buffers');if(h.length===0)return a.alloc(0);var x;if(p===void 0)for(p=0,x=0;x<h.length;++x)p+=h[x].length;var P=a.allocUnsafe(p),G=0;for(x=0;x<h.length;++x){var V=h[x];if(!a.isBuffer(V))throw new TypeError('"list" argument must be an Array of Buffers');V.copy(P,G),G+=V.length}return P};function St(I,h){if(a.isBuffer(I))return I.length;if(le(I)||oe(I))return I.byteLength;typeof I!="string"&&(I=""+I);var p=I.length;if(p===0)return 0;for(var x=!1;;)switch(h){case"ascii":case"latin1":case"binary":return p;case"utf8":case"utf-8":case void 0:return pt(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p*2;case"hex":return p>>>1;case"base64":return ne(I).length;default:if(x)return pt(I).length;h=(""+h).toLowerCase(),x=!0}}a.byteLength=St;function tt(I,h,p){var x=!1;if((h===void 0||h<0)&&(h=0),h>this.length||((p===void 0||p>this.length)&&(p=this.length),p<=0)||(p>>>=0,h>>>=0,p<=h))return"";for(I||(I="utf8");;)switch(I){case"hex":return Rt(this,h,p);case"utf8":case"utf-8":return Zt(this,h,p);case"ascii":return K(this,h,p);case"latin1":case"binary":return ft(this,h,p);case"base64":return Et(this,h,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return gt(this,h,p);default:if(x)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),x=!0}}a.prototype._isBuffer=!0;function kt(I,h,p){var x=I[h];I[h]=I[p],I[p]=x}a.prototype.swap16=function(){var h=this.length;if(h%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var p=0;p<h;p+=2)kt(this,p,p+1);return this},a.prototype.swap32=function(){var h=this.length;if(h%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var p=0;p<h;p+=4)kt(this,p,p+3),kt(this,p+1,p+2);return this},a.prototype.swap64=function(){var h=this.length;if(h%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var p=0;p<h;p+=8)kt(this,p,p+7),kt(this,p+1,p+6),kt(this,p+2,p+5),kt(this,p+3,p+4);return this},a.prototype.toString=function(){var h=this.length;return h===0?"":arguments.length===0?Zt(this,0,h):tt.apply(this,arguments)},a.prototype.equals=function(h){if(!a.isBuffer(h))throw new TypeError("Argument must be a Buffer");return this===h?!0:a.compare(this,h)===0},a.prototype.inspect=function(){var h="",p=d.INSPECT_MAX_BYTES;return this.length>0&&(h=this.toString("hex",0,p).match(/.{2}/g).join(" "),this.length>p&&(h+=" ... ")),"<Buffer "+h+">"},a.prototype.compare=function(h,p,x,P,G){if(!a.isBuffer(h))throw new TypeError("Argument must be a Buffer");if(p===void 0&&(p=0),x===void 0&&(x=h?h.length:0),P===void 0&&(P=0),G===void 0&&(G=this.length),p<0||x>h.length||P<0||G>this.length)throw new RangeError("out of range index");if(P>=G&&p>=x)return 0;if(P>=G)return-1;if(p>=x)return 1;if(p>>>=0,x>>>=0,P>>>=0,G>>>=0,this===h)return 0;for(var V=G-P,Lt=x-p,Dt=Math.min(V,Lt),Pt=this.slice(P,G),Vt=h.slice(p,x),At=0;At<Dt;++At)if(Pt[At]!==Vt[At]){V=Pt[At],Lt=Vt[At];break}return V<Lt?-1:Lt<V?1:0};function dt(I,h,p,x,P){if(I.length===0)return-1;if(typeof p=="string"?(x=p,p=0):p>2147483647?p=2147483647:p<-2147483648&&(p=-2147483648),p=+p,be(p)&&(p=P?0:I.length-1),p<0&&(p=I.length+p),p>=I.length){if(P)return-1;p=I.length-1}else if(p<0)if(P)p=0;else return-1;if(typeof h=="string"&&(h=a.from(h,x)),a.isBuffer(h))return h.length===0?-1:z(I,h,p,x,P);if(typeof h=="number")return h=h&255,typeof Uint8Array.prototype.indexOf=="function"?P?Uint8Array.prototype.indexOf.call(I,h,p):Uint8Array.prototype.lastIndexOf.call(I,h,p):z(I,[h],p,x,P);throw new TypeError("val must be string, number or Buffer")}function z(I,h,p,x,P){var G=1,V=I.length,Lt=h.length;if(x!==void 0&&(x=String(x).toLowerCase(),x==="ucs2"||x==="ucs-2"||x==="utf16le"||x==="utf-16le")){if(I.length<2||h.length<2)return-1;G=2,V/=2,Lt/=2,p/=2}function Dt(Qe,je){return G===1?Qe[je]:Qe.readUInt16BE(je*G)}var Pt;if(P){var Vt=-1;for(Pt=p;Pt<V;Pt++)if(Dt(I,Pt)===Dt(h,Vt===-1?0:Pt-Vt)){if(Vt===-1&&(Vt=Pt),Pt-Vt+1===Lt)return Vt*G}else Vt!==-1&&(Pt-=Pt-Vt),Vt=-1}else for(p+Lt>V&&(p=V-Lt),Pt=p;Pt>=0;Pt--){for(var At=!0,ke=0;ke<Lt;ke++)if(Dt(I,Pt+ke)!==Dt(h,ke)){At=!1;break}if(At)return Pt}return-1}a.prototype.includes=function(h,p,x){return this.indexOf(h,p,x)!==-1},a.prototype.indexOf=function(h,p,x){return dt(this,h,p,x,!0)},a.prototype.lastIndexOf=function(h,p,x){return dt(this,h,p,x,!1)};function et(I,h,p,x){p=Number(p)||0;var P=I.length-p;x?(x=Number(x),x>P&&(x=P)):x=P;var G=h.length;if(G%2!==0)throw new TypeError("Invalid hex string");x>G/2&&(x=G/2);for(var V=0;V<x;++V){var Lt=parseInt(h.substr(V*2,2),16);if(be(Lt))return V;I[p+V]=Lt}return V}function lt(I,h,p,x){return vt(pt(h,I.length-p),I,p,x)}function Tt(I,h,p,x){return vt(bt(h),I,p,x)}function mt(I,h,p,x){return Tt(I,h,p,x)}function Ct(I,h,p,x){return vt(ne(h),I,p,x)}function xt(I,h,p,x){return vt(Q(h,I.length-p),I,p,x)}a.prototype.write=function(h,p,x,P){if(p===void 0)P="utf8",x=this.length,p=0;else if(x===void 0&&typeof p=="string")P=p,x=this.length,p=0;else if(isFinite(p))p=p>>>0,isFinite(x)?(x=x>>>0,P===void 0&&(P="utf8")):(P=x,x=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var G=this.length-p;if((x===void 0||x>G)&&(x=G),h.length>0&&(x<0||p<0)||p>this.length)throw new RangeError("Attempt to write outside buffer bounds");P||(P="utf8");for(var V=!1;;)switch(P){case"hex":return et(this,h,p,x);case"utf8":case"utf-8":return lt(this,h,p,x);case"ascii":return Tt(this,h,p,x);case"latin1":case"binary":return mt(this,h,p,x);case"base64":return Ct(this,h,p,x);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xt(this,h,p,x);default:if(V)throw new TypeError("Unknown encoding: "+P);P=(""+P).toLowerCase(),V=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Et(I,h,p){return h===0&&p===I.length?R.fromByteArray(I):R.fromByteArray(I.slice(h,p))}function Zt(I,h,p){p=Math.min(I.length,p);for(var x=[],P=h;P<p;){var G=I[P],V=null,Lt=G>239?4:G>223?3:G>191?2:1;if(P+Lt<=p){var Dt,Pt,Vt,At;switch(Lt){case 1:G<128&&(V=G);break;case 2:Dt=I[P+1],(Dt&192)===128&&(At=(G&31)<<6|Dt&63,At>127&&(V=At));break;case 3:Dt=I[P+1],Pt=I[P+2],(Dt&192)===128&&(Pt&192)===128&&(At=(G&15)<<12|(Dt&63)<<6|Pt&63,At>2047&&(At<55296||At>57343)&&(V=At));break;case 4:Dt=I[P+1],Pt=I[P+2],Vt=I[P+3],(Dt&192)===128&&(Pt&192)===128&&(Vt&192)===128&&(At=(G&15)<<18|(Dt&63)<<12|(Pt&63)<<6|Vt&63,At>65535&&At<1114112&&(V=At))}}V===null?(V=65533,Lt=1):V>65535&&(V-=65536,x.push(V>>>10&1023|55296),V=56320|V&1023),x.push(V),P+=Lt}return U(x)}var j=4096;function U(I){var h=I.length;if(h<=j)return String.fromCharCode.apply(String,I);for(var p="",x=0;x<h;)p+=String.fromCharCode.apply(String,I.slice(x,x+=j));return p}function K(I,h,p){var x="";p=Math.min(I.length,p);for(var P=h;P<p;++P)x+=String.fromCharCode(I[P]&127);return x}function ft(I,h,p){var x="";p=Math.min(I.length,p);for(var P=h;P<p;++P)x+=String.fromCharCode(I[P]);return x}function Rt(I,h,p){var x=I.length;(!h||h<0)&&(h=0),(!p||p<0||p>x)&&(p=x);for(var P="",G=h;G<p;++G)P+=it(I[G]);return P}function gt(I,h,p){for(var x=I.slice(h,p),P="",G=0;G<x.length;G+=2)P+=String.fromCharCode(x[G]+x[G+1]*256);return P}a.prototype.slice=function(h,p){var x=this.length;h=~~h,p=p===void 0?x:~~p,h<0?(h+=x,h<0&&(h=0)):h>x&&(h=x),p<0?(p+=x,p<0&&(p=0)):p>x&&(p=x),p<h&&(p=h);var P=this.subarray(h,p);return P.__proto__=a.prototype,P};function _t(I,h,p){if(I%1!==0||I<0)throw new RangeError("offset is not uint");if(I+h>p)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUIntLE=function(h,p,x){h=h>>>0,p=p>>>0,x||_t(h,p,this.length);for(var P=this[h],G=1,V=0;++V<p&&(G*=256);)P+=this[h+V]*G;return P},a.prototype.readUIntBE=function(h,p,x){h=h>>>0,p=p>>>0,x||_t(h,p,this.length);for(var P=this[h+--p],G=1;p>0&&(G*=256);)P+=this[h+--p]*G;return P},a.prototype.readUInt8=function(h,p){return h=h>>>0,p||_t(h,1,this.length),this[h]},a.prototype.readUInt16LE=function(h,p){return h=h>>>0,p||_t(h,2,this.length),this[h]|this[h+1]<<8},a.prototype.readUInt16BE=function(h,p){return h=h>>>0,p||_t(h,2,this.length),this[h]<<8|this[h+1]},a.prototype.readUInt32LE=function(h,p){return h=h>>>0,p||_t(h,4,this.length),(this[h]|this[h+1]<<8|this[h+2]<<16)+this[h+3]*16777216},a.prototype.readUInt32BE=function(h,p){return h=h>>>0,p||_t(h,4,this.length),this[h]*16777216+(this[h+1]<<16|this[h+2]<<8|this[h+3])},a.prototype.readIntLE=function(h,p,x){h=h>>>0,p=p>>>0,x||_t(h,p,this.length);for(var P=this[h],G=1,V=0;++V<p&&(G*=256);)P+=this[h+V]*G;return G*=128,P>=G&&(P-=Math.pow(2,8*p)),P},a.prototype.readIntBE=function(h,p,x){h=h>>>0,p=p>>>0,x||_t(h,p,this.length);for(var P=p,G=1,V=this[h+--P];P>0&&(G*=256);)V+=this[h+--P]*G;return G*=128,V>=G&&(V-=Math.pow(2,8*p)),V},a.prototype.readInt8=function(h,p){return h=h>>>0,p||_t(h,1,this.length),this[h]&128?(255-this[h]+1)*-1:this[h]},a.prototype.readInt16LE=function(h,p){h=h>>>0,p||_t(h,2,this.length);var x=this[h]|this[h+1]<<8;return x&32768?x|4294901760:x},a.prototype.readInt16BE=function(h,p){h=h>>>0,p||_t(h,2,this.length);var x=this[h+1]|this[h]<<8;return x&32768?x|4294901760:x},a.prototype.readInt32LE=function(h,p){return h=h>>>0,p||_t(h,4,this.length),this[h]|this[h+1]<<8|this[h+2]<<16|this[h+3]<<24},a.prototype.readInt32BE=function(h,p){return h=h>>>0,p||_t(h,4,this.length),this[h]<<24|this[h+1]<<16|this[h+2]<<8|this[h+3]},a.prototype.readFloatLE=function(h,p){return h=h>>>0,p||_t(h,4,this.length),E.read(this,h,!0,23,4)},a.prototype.readFloatBE=function(h,p){return h=h>>>0,p||_t(h,4,this.length),E.read(this,h,!1,23,4)},a.prototype.readDoubleLE=function(h,p){return h=h>>>0,p||_t(h,8,this.length),E.read(this,h,!0,52,8)},a.prototype.readDoubleBE=function(h,p){return h=h>>>0,p||_t(h,8,this.length),E.read(this,h,!1,52,8)};function Ft(I,h,p,x,P,G){if(!a.isBuffer(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(h>P||h<G)throw new RangeError('"value" argument is out of bounds');if(p+x>I.length)throw new RangeError("Index out of range")}a.prototype.writeUIntLE=function(h,p,x,P){if(h=+h,p=p>>>0,x=x>>>0,!P){var G=Math.pow(2,8*x)-1;Ft(this,h,p,x,G,0)}var V=1,Lt=0;for(this[p]=h&255;++Lt<x&&(V*=256);)this[p+Lt]=h/V&255;return p+x},a.prototype.writeUIntBE=function(h,p,x,P){if(h=+h,p=p>>>0,x=x>>>0,!P){var G=Math.pow(2,8*x)-1;Ft(this,h,p,x,G,0)}var V=x-1,Lt=1;for(this[p+V]=h&255;--V>=0&&(Lt*=256);)this[p+V]=h/Lt&255;return p+x},a.prototype.writeUInt8=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,1,255,0),this[p]=h&255,p+1},a.prototype.writeUInt16LE=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,2,65535,0),this[p]=h&255,this[p+1]=h>>>8,p+2},a.prototype.writeUInt16BE=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,2,65535,0),this[p]=h>>>8,this[p+1]=h&255,p+2},a.prototype.writeUInt32LE=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,4,4294967295,0),this[p+3]=h>>>24,this[p+2]=h>>>16,this[p+1]=h>>>8,this[p]=h&255,p+4},a.prototype.writeUInt32BE=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,4,4294967295,0),this[p]=h>>>24,this[p+1]=h>>>16,this[p+2]=h>>>8,this[p+3]=h&255,p+4},a.prototype.writeIntLE=function(h,p,x,P){if(h=+h,p=p>>>0,!P){var G=Math.pow(2,8*x-1);Ft(this,h,p,x,G-1,-G)}var V=0,Lt=1,Dt=0;for(this[p]=h&255;++V<x&&(Lt*=256);)h<0&&Dt===0&&this[p+V-1]!==0&&(Dt=1),this[p+V]=(h/Lt>>0)-Dt&255;return p+x},a.prototype.writeIntBE=function(h,p,x,P){if(h=+h,p=p>>>0,!P){var G=Math.pow(2,8*x-1);Ft(this,h,p,x,G-1,-G)}var V=x-1,Lt=1,Dt=0;for(this[p+V]=h&255;--V>=0&&(Lt*=256);)h<0&&Dt===0&&this[p+V+1]!==0&&(Dt=1),this[p+V]=(h/Lt>>0)-Dt&255;return p+x},a.prototype.writeInt8=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,1,127,-128),h<0&&(h=255+h+1),this[p]=h&255,p+1},a.prototype.writeInt16LE=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,2,32767,-32768),this[p]=h&255,this[p+1]=h>>>8,p+2},a.prototype.writeInt16BE=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,2,32767,-32768),this[p]=h>>>8,this[p+1]=h&255,p+2},a.prototype.writeInt32LE=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,4,2147483647,-2147483648),this[p]=h&255,this[p+1]=h>>>8,this[p+2]=h>>>16,this[p+3]=h>>>24,p+4},a.prototype.writeInt32BE=function(h,p,x){return h=+h,p=p>>>0,x||Ft(this,h,p,4,2147483647,-2147483648),h<0&&(h=4294967295+h+1),this[p]=h>>>24,this[p+1]=h>>>16,this[p+2]=h>>>8,this[p+3]=h&255,p+4};function Wt(I,h,p,x,P,G){if(p+x>I.length)throw new RangeError("Index out of range");if(p<0)throw new RangeError("Index out of range")}function Mt(I,h,p,x,P){return h=+h,p=p>>>0,P||Wt(I,h,p,4),E.write(I,h,p,x,23,4),p+4}a.prototype.writeFloatLE=function(h,p,x){return Mt(this,h,p,!0,x)},a.prototype.writeFloatBE=function(h,p,x){return Mt(this,h,p,!1,x)};function T(I,h,p,x,P){return h=+h,p=p>>>0,P||Wt(I,h,p,8),E.write(I,h,p,x,52,8),p+8}a.prototype.writeDoubleLE=function(h,p,x){return T(this,h,p,!0,x)},a.prototype.writeDoubleBE=function(h,p,x){return T(this,h,p,!1,x)},a.prototype.copy=function(h,p,x,P){if(x||(x=0),!P&&P!==0&&(P=this.length),p>=h.length&&(p=h.length),p||(p=0),P>0&&P<x&&(P=x),P===x||h.length===0||this.length===0)return 0;if(p<0)throw new RangeError("targetStart out of bounds");if(x<0||x>=this.length)throw new RangeError("sourceStart out of bounds");if(P<0)throw new RangeError("sourceEnd out of bounds");P>this.length&&(P=this.length),h.length-p<P-x&&(P=h.length-p+x);var G=P-x,V;if(this===h&&x<p&&p<P)for(V=G-1;V>=0;--V)h[V+p]=this[V+x];else if(G<1e3)for(V=0;V<G;++V)h[V+p]=this[V+x];else Uint8Array.prototype.set.call(h,this.subarray(x,x+G),p);return G},a.prototype.fill=function(h,p,x,P){if(typeof h=="string"){if(typeof p=="string"?(P=p,p=0,x=this.length):typeof x=="string"&&(P=x,x=this.length),h.length===1){var G=h.charCodeAt(0);G<256&&(h=G)}if(P!==void 0&&typeof P!="string")throw new TypeError("encoding must be a string");if(typeof P=="string"&&!a.isEncoding(P))throw new TypeError("Unknown encoding: "+P)}else typeof h=="number"&&(h=h&255);if(p<0||this.length<p||this.length<x)throw new RangeError("Out of range index");if(x<=p)return this;p=p>>>0,x=x===void 0?this.length:x>>>0,h||(h=0);var V;if(typeof h=="number")for(V=p;V<x;++V)this[V]=h;else{var Lt=a.isBuffer(h)?h:new a(h,P),Dt=Lt.length;for(V=0;V<x-p;++V)this[V+p]=Lt[V%Dt]}return this};var F=/[^+/0-9A-Za-z-_]/g;function Z(I){if(I=I.trim().replace(F,""),I.length<2)return"";for(;I.length%4!==0;)I=I+"=";return I}function it(I){return I<16?"0"+I.toString(16):I.toString(16)}function pt(I,h){h=h||1/0;for(var p,x=I.length,P=null,G=[],V=0;V<x;++V){if(p=I.charCodeAt(V),p>55295&&p<57344){if(!P){if(p>56319){(h-=3)>-1&&G.push(239,191,189);continue}else if(V+1===x){(h-=3)>-1&&G.push(239,191,189);continue}P=p;continue}if(p<56320){(h-=3)>-1&&G.push(239,191,189),P=p;continue}p=(P-55296<<10|p-56320)+65536}else P&&(h-=3)>-1&&G.push(239,191,189);if(P=null,p<128){if((h-=1)<0)break;G.push(p)}else if(p<2048){if((h-=2)<0)break;G.push(p>>6|192,p&63|128)}else if(p<65536){if((h-=3)<0)break;G.push(p>>12|224,p>>6&63|128,p&63|128)}else if(p<1114112){if((h-=4)<0)break;G.push(p>>18|240,p>>12&63|128,p>>6&63|128,p&63|128)}else throw new Error("Invalid code point")}return G}function bt(I){for(var h=[],p=0;p<I.length;++p)h.push(I.charCodeAt(p)&255);return h}function Q(I,h){for(var p,x,P,G=[],V=0;V<I.length&&!((h-=2)<0);++V)p=I.charCodeAt(V),x=p>>8,P=p%256,G.push(P),G.push(x);return G}function ne(I){return R.toByteArray(Z(I))}function vt(I,h,p,x){for(var P=0;P<x&&!(P+p>=h.length||P>=I.length);++P)h[P+p]=I[P];return P}function oe(I){return I instanceof ArrayBuffer||I!=null&&I.constructor!=null&&I.constructor.name==="ArrayBuffer"&&typeof I.byteLength=="number"}function le(I){return typeof ArrayBuffer.isView=="function"&&ArrayBuffer.isView(I)}function be(I){return I!==I}}).call(d,v(1))},function(f,d){d.byteLength=a,d.toByteArray=b,d.fromByteArray=L;for(var v=[],g=[],R=typeof Uint8Array<"u"?Uint8Array:Array,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=0,w=E.length;k<w;++k)v[k]=E[k],g[E.charCodeAt(k)]=k;g[45]=62,g[95]=63;function m(O){var C=O.length;if(C%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return O[C-2]==="="?2:O[C-1]==="="?1:0}function a(O){return O.length*3/4-m(O)}function b(O){var C,A,J,B,H,St,tt=O.length;H=m(O),St=new R(tt*3/4-H),J=H>0?tt-4:tt;var kt=0;for(C=0,A=0;C<J;C+=4,A+=3)B=g[O.charCodeAt(C)]<<18|g[O.charCodeAt(C+1)]<<12|g[O.charCodeAt(C+2)]<<6|g[O.charCodeAt(C+3)],St[kt++]=B>>16&255,St[kt++]=B>>8&255,St[kt++]=B&255;return H===2?(B=g[O.charCodeAt(C)]<<2|g[O.charCodeAt(C+1)]>>4,St[kt++]=B&255):H===1&&(B=g[O.charCodeAt(C)]<<10|g[O.charCodeAt(C+1)]<<4|g[O.charCodeAt(C+2)]>>2,St[kt++]=B>>8&255,St[kt++]=B&255),St}function u(O){return v[O>>18&63]+v[O>>12&63]+v[O>>6&63]+v[O&63]}function N(O,C,A){for(var J,B=[],H=C;H<A;H+=3)J=(O[H]<<16)+(O[H+1]<<8)+O[H+2],B.push(u(J));return B.join("")}function L(O){for(var C,A=O.length,J=A%3,B="",H=[],St=16383,tt=0,kt=A-J;tt<kt;tt+=St)H.push(N(O,tt,tt+St>kt?kt:tt+St));return J===1?(C=O[A-1],B+=v[C>>2],B+=v[C<<4&63],B+="=="):J===2&&(C=(O[A-2]<<8)+O[A-1],B+=v[C>>10],B+=v[C>>4&63],B+=v[C<<2&63],B+="="),H.push(B),H.join("")}},function(f,d){d.read=function(v,g,R,E,k){var w,m,a=k*8-E-1,b=(1<<a)-1,u=b>>1,N=-7,L=R?k-1:0,O=R?-1:1,C=v[g+L];for(L+=O,w=C&(1<<-N)-1,C>>=-N,N+=a;N>0;w=w*256+v[g+L],L+=O,N-=8);for(m=w&(1<<-N)-1,w>>=-N,N+=E;N>0;m=m*256+v[g+L],L+=O,N-=8);if(w===0)w=1-u;else{if(w===b)return m?NaN:(C?-1:1)*(1/0);m=m+Math.pow(2,E),w=w-u}return(C?-1:1)*m*Math.pow(2,w-E)},d.write=function(v,g,R,E,k,w){var m,a,b,u=w*8-k-1,N=(1<<u)-1,L=N>>1,O=k===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=E?0:w-1,A=E?1:-1,J=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(a=isNaN(g)?1:0,m=N):(m=Math.floor(Math.log(g)/Math.LN2),g*(b=Math.pow(2,-m))<1&&(m--,b*=2),m+L>=1?g+=O/b:g+=O*Math.pow(2,1-L),g*b>=2&&(m++,b/=2),m+L>=N?(a=0,m=N):m+L>=1?(a=(g*b-1)*Math.pow(2,k),m=m+L):(a=g*Math.pow(2,L-1)*Math.pow(2,k),m=0));k>=8;v[R+C]=a&255,C+=A,a/=256,k-=8);for(m=m<<k|a,u+=k;u>0;v[R+C]=m&255,C+=A,m/=256,u-=8);v[R+C-A]|=J*128}},function(f,d){f.exports=function(v){return v.webpackPolyfill||(v.deprecate=function(){},v.paths=[],v.children=[],v.webpackPolyfill=1),v}},function(f,d,v){var g=v(7),R=new g,E={};function k(m){E[m]||(typeof R[m]=="function"?E[m]=function(){return R[m].apply(R,arguments)}:E[m]=R[m])}for(var w in R)k(w);E.initializeTTYs=function(){R.stdin===null&&(R.initializeTTYs(),E.stdin=R.stdin,E.stdout=R.stdout,E.stderr=R.stderr)},R.nextTick(function(){E.initializeTTYs()}),f.exports=E},function(f,d,v){(function(g){var R=this&&this.__extends||function(b,u){for(var N in u)u.hasOwnProperty(N)&&(b[N]=u[N]);function L(){this.constructor=b}b.prototype=u===null?Object.create(u):(L.prototype=u.prototype,new L)},E=v(8),k=null,w=(function(){function b(u,N){this.fun=u,this.array=N}return b.prototype.run=function(){this.fun.apply(null,this.array)},b})(),m=(function(){function b(){this._queue=[],this._draining=!1,this._currentQueue=null,this._queueIndex=-1}return b.prototype.push=function(u){var N=this;this._queue.push(u)===1&&!this._draining&&setTimeout(function(){return N._drainQueue()},0)},b.prototype._cleanUpNextTick=function(){this._draining=!1,this._currentQueue&&this._currentQueue.length?this._queue=this._currentQueue.concat(this._queue):this._queueIndex=-1,this._queue.length&&this._drainQueue()},b.prototype._drainQueue=function(){var u=this;if(!this._draining){var N=setTimeout(function(){return u._cleanUpNextTick()});this._draining=!0;for(var L=this._queue.length;L;){for(this._currentQueue=this._queue,this._queue=[];++this._queueIndex<L;)this._currentQueue&&this._currentQueue[this._queueIndex].run();this._queueIndex=-1,L=this._queue.length}this._currentQueue=null,this._draining=!1,clearTimeout(N)}},b})(),a=(function(b){R(u,b);function u(){b.apply(this,arguments),this.startTime=Date.now(),this._cwd="/",this.platform="browser",this.argv=[],this.execArgv=[],this.stdout=null,this.stderr=null,this.stdin=null,this.domain=null,this._queue=new m,this.execPath=g,this.env={},this.exitCode=0,this._gid=1,this._uid=1,this.version="v5.0",this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"},this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:!1,node_install_waf:!1,node_prefix:"",node_shared_cares:!1,node_shared_http_parser:!1,node_shared_libuv:!1,node_shared_zlib:!1,node_shared_v8:!1,node_use_dtrace:!1,node_use_etw:!1,node_use_openssl:!1,node_shared_openssl:!1,strict_aliasing:!1,target_arch:"x32",v8_use_snapshot:!1,v8_no_strict_aliasing:0,visibility:""}},this.pid=Math.random()*1e3|0,this.title="node",this.arch="x32",this._mask=18,this.connected=void 0}return u.prototype.chdir=function(N){k===null&&(k=v(9)),this._cwd=k.resolve(N)},u.prototype.cwd=function(){return this._cwd},u.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0},u.prototype.nextTick=function(N){for(var L=[],O=1;O<arguments.length;O++)L[O-1]=arguments[O];this._queue.push(new w(N,L))},u.prototype.abort=function(){this.emit("abort")},u.prototype.exit=function(N){this.exitCode=N,this.emit("exit",[N])},u.prototype.getgid=function(){return this._gid},u.prototype.setgid=function(N){typeof N=="number"?this._gid=N:this._gid=1},u.prototype.getuid=function(){return this._uid},u.prototype.setuid=function(N){typeof N=="number"?this._uid=N:this._uid=1},u.prototype.kill=function(N,L){this.emit("kill",[N,L])},u.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}},u.prototype.umask=function(N){N===void 0&&(N=this._mask);var L=this._mask;return this._mask=N,this.emit("umask",[N]),L},u.prototype.hrtime=function(){var N;typeof performance<"u"?N=performance.now():Date.now?N=Date.now():N=new Date().getTime();var L=N/1e3|0;return N-=L*1e3,N=N*1e6|0,[L,N]},u.prototype.initializeTTYs=function(){if(this.stdout===null){var N=v(10);this.stdout=new N,this.stderr=new N,this.stdin=new N}},u.prototype.disconnect=function(){},u})(E.EventEmitter);f.exports=a}).call(d,"/")},function(f,d){function v(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}f.exports=v,v.EventEmitter=v,v.prototype._events=void 0,v.prototype._maxListeners=void 0,v.defaultMaxListeners=10,v.prototype.setMaxListeners=function(w){if(!R(w)||w<0||isNaN(w))throw TypeError("n must be a positive number");return this._maxListeners=w,this},v.prototype.emit=function(w){var m,a,b,u,N,L;if(this._events||(this._events={}),w==="error"&&(!this._events.error||E(this._events.error)&&!this._events.error.length)){if(m=arguments[1],m instanceof Error)throw m;var O=new Error('Uncaught, unspecified "error" event. ('+m+")");throw O.context=m,O}if(a=this._events[w],k(a))return!1;if(g(a))switch(arguments.length){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),a.apply(this,u)}else if(E(a))for(u=Array.prototype.slice.call(arguments,1),L=a.slice(),b=L.length,N=0;N<b;N++)L[N].apply(this,u);return!0},v.prototype.addListener=function(w,m){var a;if(!g(m))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",w,g(m.listener)?m.listener:m),this._events[w]?E(this._events[w])?this._events[w].push(m):this._events[w]=[this._events[w],m]:this._events[w]=m,E(this._events[w])&&!this._events[w].warned&&(k(this._maxListeners)?a=v.defaultMaxListeners:a=this._maxListeners,a&&a>0&&this._events[w].length>a&&(this._events[w].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[w].length),typeof console.trace=="function"&&console.trace())),this},v.prototype.on=v.prototype.addListener,v.prototype.once=function(w,m){if(!g(m))throw TypeError("listener must be a function");var a=!1;function b(){this.removeListener(w,b),a||(a=!0,m.apply(this,arguments))}return b.listener=m,this.on(w,b),this},v.prototype.removeListener=function(w,m){var a,b,u,N;if(!g(m))throw TypeError("listener must be a function");if(!this._events||!this._events[w])return this;if(a=this._events[w],u=a.length,b=-1,a===m||g(a.listener)&&a.listener===m)delete this._events[w],this._events.removeListener&&this.emit("removeListener",w,m);else if(E(a)){for(N=u;N-- >0;)if(a[N]===m||a[N].listener&&a[N].listener===m){b=N;break}if(b<0)return this;a.length===1?(a.length=0,delete this._events[w]):a.splice(b,1),this._events.removeListener&&this.emit("removeListener",w,m)}return this},v.prototype.removeAllListeners=function(w){var m,a;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[w]&&delete this._events[w],this;if(arguments.length===0){for(m in this._events)m!=="removeListener"&&this.removeAllListeners(m);return this.removeAllListeners("removeListener"),this._events={},this}if(a=this._events[w],g(a))this.removeListener(w,a);else if(a)for(;a.length;)this.removeListener(w,a[a.length-1]);return delete this._events[w],this},v.prototype.listeners=function(w){var m;return!this._events||!this._events[w]?m=[]:g(this._events[w])?m=[this._events[w]]:m=this._events[w].slice(),m},v.prototype.listenerCount=function(w){if(this._events){var m=this._events[w];if(g(m))return 1;if(m)return m.length}return 0},v.listenerCount=function(w,m){return w.listenerCount(m)};function g(w){return typeof w=="function"}function R(w){return typeof w=="number"}function E(w){return typeof w=="object"&&w!==null}function k(w){return w===void 0}},function(f,d,v){(function(g){var R=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function E(w){var m=R.exec(w);return m.shift(),m}var k=(function(){function w(){}return w.normalize=function(m){m===""&&(m=".");var a=m.charAt(0)===w.sep;m=w._removeDuplicateSeps(m);for(var b=m.split(w.sep),u=[],N=0;N<b.length;N++){var L=b[N];L!=="."&&(L===".."&&(a||!a&&u.length>0&&u[0]!=="..")?u.pop():u.push(L))}return!a&&u.length<2&&(u.length===1?u[0]===""&&u.unshift("."):u.push(".")),m=u.join(w.sep),a&&m.charAt(0)!==w.sep&&(m=w.sep+m),m},w.join=function(){for(var m=[],a=0;a<arguments.length;a++)m[a-0]=arguments[a];for(var b=[],u=0;u<m.length;u++){var N=m[u];if(typeof N!="string")throw new TypeError("Invalid argument type to path.join: "+typeof N);N!==""&&b.push(N)}return w.normalize(b.join(w.sep))},w.resolve=function(){for(var m=[],a=0;a<arguments.length;a++)m[a-0]=arguments[a];for(var b=[],u=0;u<m.length;u++){var N=m[u];if(typeof N!="string")throw new TypeError("Invalid argument type to path.join: "+typeof N);N!==""&&(N.charAt(0)===w.sep&&(b=[]),b.push(N))}var L=w.normalize(b.join(w.sep));if(L.length>1&&L.charAt(L.length-1)===w.sep)return L.substr(0,L.length-1);if(L.charAt(0)!==w.sep){L.charAt(0)==="."&&(L.length===1||L.charAt(1)===w.sep)&&(L=L.length===1?"":L.substr(2));var O=g.cwd();L!==""?L=this.normalize(O+(O!=="/"?w.sep:"")+L):L=O}return L},w.relative=function(m,a){var b;m=w.resolve(m),a=w.resolve(a);var u=m.split(w.sep),N=a.split(w.sep);N.shift(),u.shift();var L=0,O=[];for(b=0;b<u.length;b++){var C=u[b];if(C!==N[b]){L=u.length-b;break}}O=N.slice(b),u.length===1&&u[0]===""&&(L=0),L>u.length&&(L=u.length);var A="";for(b=0;b<L;b++)A+="../";return A+=O.join(w.sep),A.length>1&&A.charAt(A.length-1)===w.sep&&(A=A.substr(0,A.length-1)),A},w.dirname=function(m){m=w._removeDuplicateSeps(m);var a=m.charAt(0)===w.sep,b=m.split(w.sep);return b.pop()===""&&b.length>0&&b.pop(),b.length>1||b.length===1&&!a?b.join(w.sep):a?w.sep:"."},w.basename=function(m,a){if(a===void 0&&(a=""),m==="")return m;m=w.normalize(m);var b=m.split(w.sep),u=b[b.length-1];if(u===""&&b.length>1)return b[b.length-2];if(a.length>0){var N=u.substr(u.length-a.length);if(N===a)return u.substr(0,u.length-a.length)}return u},w.extname=function(m){m=w.normalize(m);var a=m.split(w.sep);if(m=a.pop(),m===""&&a.length>0&&(m=a.pop()),m==="..")return"";var b=m.lastIndexOf(".");return b===-1||b===0?"":m.substr(b)},w.isAbsolute=function(m){return m.length>0&&m.charAt(0)===w.sep},w._makeLong=function(m){return m},w.parse=function(m){var a=E(m);return{root:a[0],dir:a[0]+a[1].slice(0,-1),base:a[2],ext:a[3],name:a[2].slice(0,a[2].length-a[3].length)}},w.format=function(m){if(m===null||typeof m!="object")throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof m);var a=m.root||"";if(typeof a!="string")throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof m.root);var b=m.dir?m.dir+w.sep:"",u=m.base||"";return b+u},w._removeDuplicateSeps=function(m){return m=m.replace(this._replaceRegex,this.sep),m},w.sep="/",w._replaceRegex=new RegExp("//+","g"),w.delimiter=":",w.posix=w,w.win32=w,w})();f.exports=k}).call(d,v(6))},function(f,d,v){(function(g){var R=this&&this.__extends||function(w,m){for(var a in m)m.hasOwnProperty(a)&&(w[a]=m[a]);function b(){this.constructor=w}w.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)},E=v(11),k=(function(w){R(m,w);function m(){w.call(this),this.isRaw=!1,this.columns=80,this.rows=120,this.isTTY=!0,this._bufferedWrites=[],this._waitingForWrites=!1}return m.prototype.setRawMode=function(a){this.isRaw!==a&&(this.isRaw=a,this.emit("modeChange"))},m.prototype.changeColumns=function(a){a!==this.columns&&(this.columns=a,this.emit("resize"))},m.prototype.changeRows=function(a){a!==this.rows&&(this.rows=a,this.emit("resize"))},m.isatty=function(a){return a&&a instanceof m},m.prototype._write=function(a,b,u){var N;try{var L;typeof a=="string"?L=new g(a,b):L=a,this._bufferedWrites.push(L),this._waitingForWrites&&this._read(1024)}catch(O){N=O}finally{u(N)}},m.prototype._read=function(a){if(this._bufferedWrites.length===0)this._waitingForWrites=!0;else for(;this._bufferedWrites.length>0&&(this._waitingForWrites=this.push(this._bufferedWrites.shift()),!!this._waitingForWrites););},m})(E.Duplex);f.exports=k}).call(d,v(1))},function(f,d,v){f.exports=E;var g=v(8).EventEmitter,R=v(12);R(E,g),E.Readable=v(13),E.Writable=v(27),E.Duplex=v(28),E.Transform=v(29),E.PassThrough=v(30),E.Stream=E;function E(){g.call(this)}E.prototype.pipe=function(k,w){var m=this;function a(A){k.writable&&k.write(A)===!1&&m.pause&&m.pause()}m.on("data",a);function b(){m.readable&&m.resume&&m.resume()}k.on("drain",b),!k._isStdio&&(!w||w.end!==!1)&&(m.on("end",N),m.on("close",L));var u=!1;function N(){u||(u=!0,k.end())}function L(){u||(u=!0,typeof k.destroy=="function"&&k.destroy())}function O(A){if(C(),g.listenerCount(this,"error")===0)throw A}m.on("error",O),k.on("error",O);function C(){m.removeListener("data",a),k.removeListener("drain",b),m.removeListener("end",N),m.removeListener("close",L),m.removeListener("error",O),k.removeListener("error",O),m.removeListener("end",C),m.removeListener("close",C),k.removeListener("close",C)}return m.on("end",C),m.on("close",C),k.on("close",C),k.emit("pipe",m),k}},function(f,d){typeof Object.create=="function"?f.exports=function(g,R){g.super_=R,g.prototype=Object.create(R.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:f.exports=function(g,R){g.super_=R;var E=function(){};E.prototype=R.prototype,g.prototype=new E,g.prototype.constructor=g}},function(f,d,v){(function(g){var R=(function(){try{return v(11)}catch{}})();d=f.exports=v(14),d.Stream=R||d,d.Readable=d,d.Writable=v(22),d.Duplex=v(21),d.Transform=v(25),d.PassThrough=v(26),!g.browser&&g.env.READABLE_STREAM==="disable"&&R&&(f.exports=R)}).call(d,v(6))},function(f,d,v){(function(g){f.exports=B;var R=v(15),E=v(16),k;B.ReadableState=J,v(8).EventEmitter;var w=function(T,F){return T.listeners(F).length},m;(function(){try{m=v(11)}catch{}finally{m||(m=v(8).EventEmitter)}})();var a=v(2).Buffer,b=v(17),u=v(18);u.inherits=v(12);var N=v(19),L=void 0;N&&N.debuglog?L=N.debuglog("stream"):L=function(){};var O=v(20),C;u.inherits(B,m);function A(T,F,Z){if(typeof T.prependListener=="function")return T.prependListener(F,Z);!T._events||!T._events[F]?T.on(F,Z):E(T._events[F])?T._events[F].unshift(Z):T._events[F]=[Z,T._events[F]]}function J(T,F){k=k||v(21),T=T||{},this.objectMode=!!T.objectMode,F instanceof k&&(this.objectMode=this.objectMode||!!T.readableObjectMode);var Z=T.highWaterMark,it=this.objectMode?16:16*1024;this.highWaterMark=Z||Z===0?Z:it,this.highWaterMark=~~this.highWaterMark,this.buffer=new O,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=T.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,T.encoding&&(C||(C=v(24).StringDecoder),this.decoder=new C(T.encoding),this.encoding=T.encoding)}function B(T){if(k=k||v(21),!(this instanceof B))return new B(T);this._readableState=new J(T,this),this.readable=!0,T&&typeof T.read=="function"&&(this._read=T.read),m.call(this)}B.prototype.push=function(T,F){var Z=this._readableState;return!Z.objectMode&&typeof T=="string"&&(F=F||Z.defaultEncoding,F!==Z.encoding&&(T=b.from(T,F),F="")),H(this,Z,T,F,!1)},B.prototype.unshift=function(T){var F=this._readableState;return H(this,F,T,"",!0)},B.prototype.isPaused=function(){return this._readableState.flowing===!1};function H(T,F,Z,it,pt){var bt=z(F,Z);if(bt)T.emit("error",bt);else if(Z===null)F.reading=!1,et(T,F);else if(F.objectMode||Z&&Z.length>0)if(F.ended&&!pt){var Q=new Error("stream.push() after EOF");T.emit("error",Q)}else if(F.endEmitted&&pt){var ne=new Error("stream.unshift() after end event");T.emit("error",ne)}else{var vt;F.decoder&&!pt&&!it&&(Z=F.decoder.write(Z),vt=!F.objectMode&&Z.length===0),pt||(F.reading=!1),vt||(F.flowing&&F.length===0&&!F.sync?(T.emit("data",Z),T.read(0)):(F.length+=F.objectMode?1:Z.length,pt?F.buffer.unshift(Z):F.buffer.push(Z),F.needReadable&&lt(T))),mt(T,F)}else pt||(F.reading=!1);return St(F)}function St(T){return!T.ended&&(T.needReadable||T.length<T.highWaterMark||T.length===0)}B.prototype.setEncoding=function(T){return C||(C=v(24).StringDecoder),this._readableState.decoder=new C(T),this._readableState.encoding=T,this};var tt=8388608;function kt(T){return T>=tt?T=tt:(T--,T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,T|=T>>>16,T++),T}function dt(T,F){return T<=0||F.length===0&&F.ended?0:F.objectMode?1:T!==T?F.flowing&&F.length?F.buffer.head.data.length:F.length:(T>F.highWaterMark&&(F.highWaterMark=kt(T)),T<=F.length?T:F.ended?F.length:(F.needReadable=!0,0))}B.prototype.read=function(T){L("read",T),T=parseInt(T,10);var F=this._readableState,Z=T;if(T!==0&&(F.emittedReadable=!1),T===0&&F.needReadable&&(F.length>=F.highWaterMark||F.ended))return L("read: emitReadable",F.length,F.ended),F.length===0&&F.ended?_t(this):lt(this),null;if(T=dt(T,F),T===0&&F.ended)return F.length===0&&_t(this),null;var it=F.needReadable;L("need readable",it),(F.length===0||F.length-T<F.highWaterMark)&&(it=!0,L("length less than watermark",it)),F.ended||F.reading?(it=!1,L("reading or ended",it)):it&&(L("do read"),F.reading=!0,F.sync=!0,F.length===0&&(F.needReadable=!0),this._read(F.highWaterMark),F.sync=!1,F.reading||(T=dt(Z,F)));var pt;return T>0?pt=K(T,F):pt=null,pt===null?(F.needReadable=!0,T=0):F.length-=T,F.length===0&&(F.ended||(F.needReadable=!0),Z!==T&&F.ended&&_t(this)),pt!==null&&this.emit("data",pt),pt};function z(T,F){var Z=null;return!a.isBuffer(F)&&typeof F!="string"&&F!==null&&F!==void 0&&!T.objectMode&&(Z=new TypeError("Invalid non-string/buffer chunk")),Z}function et(T,F){if(!F.ended){if(F.decoder){var Z=F.decoder.end();Z&&Z.length&&(F.buffer.push(Z),F.length+=F.objectMode?1:Z.length)}F.ended=!0,lt(T)}}function lt(T){var F=T._readableState;F.needReadable=!1,F.emittedReadable||(L("emitReadable",F.flowing),F.emittedReadable=!0,F.sync?R(Tt,T):Tt(T))}function Tt(T){L("emit readable"),T.emit("readable"),U(T)}function mt(T,F){F.readingMore||(F.readingMore=!0,R(Ct,T,F))}function Ct(T,F){for(var Z=F.length;!F.reading&&!F.flowing&&!F.ended&&F.length<F.highWaterMark&&(L("maybeReadMore read 0"),T.read(0),Z!==F.length);)Z=F.length;F.readingMore=!1}B.prototype._read=function(T){this.emit("error",new Error("_read() is not implemented"))},B.prototype.pipe=function(T,F){var Z=this,it=this._readableState;switch(it.pipesCount){case 0:it.pipes=T;break;case 1:it.pipes=[it.pipes,T];break;default:it.pipes.push(T);break}it.pipesCount+=1,L("pipe count=%d opts=%j",it.pipesCount,F);var pt=(!F||F.end!==!1)&&T!==g.stdout&&T!==g.stderr,bt=pt?ne:le;it.endEmitted?R(bt):Z.once("end",bt),T.on("unpipe",Q);function Q(G){L("onunpipe"),G===Z&&le()}function ne(){L("onend"),T.end()}var vt=xt(Z);T.on("drain",vt);var oe=!1;function le(){L("cleanup"),T.removeListener("close",p),T.removeListener("finish",x),T.removeListener("drain",vt),T.removeListener("error",h),T.removeListener("unpipe",Q),Z.removeListener("end",ne),Z.removeListener("end",le),Z.removeListener("data",I),oe=!0,it.awaitDrain&&(!T._writableState||T._writableState.needDrain)&&vt()}var be=!1;Z.on("data",I);function I(G){L("ondata"),be=!1;var V=T.write(G);V===!1&&!be&&((it.pipesCount===1&&it.pipes===T||it.pipesCount>1&&Mt(it.pipes,T)!==-1)&&!oe&&(L("false write response, pause",Z._readableState.awaitDrain),Z._readableState.awaitDrain++,be=!0),Z.pause())}function h(G){L("onerror",G),P(),T.removeListener("error",h),w(T,"error")===0&&T.emit("error",G)}A(T,"error",h);function p(){T.removeListener("finish",x),P()}T.once("close",p);function x(){L("onfinish"),T.removeListener("close",p),P()}T.once("finish",x);function P(){L("unpipe"),Z.unpipe(T)}return T.emit("pipe",Z),it.flowing||(L("pipe resume"),Z.resume()),T};function xt(T){return function(){var F=T._readableState;L("pipeOnDrain",F.awaitDrain),F.awaitDrain&&F.awaitDrain--,F.awaitDrain===0&&w(T,"data")&&(F.flowing=!0,U(T))}}B.prototype.unpipe=function(T){var F=this._readableState;if(F.pipesCount===0)return this;if(F.pipesCount===1)return T&&T!==F.pipes?this:(T||(T=F.pipes),F.pipes=null,F.pipesCount=0,F.flowing=!1,T&&T.emit("unpipe",this),this);if(!T){var Z=F.pipes,it=F.pipesCount;F.pipes=null,F.pipesCount=0,F.flowing=!1;for(var pt=0;pt<it;pt++)Z[pt].emit("unpipe",this);return this}var bt=Mt(F.pipes,T);return bt===-1?this:(F.pipes.splice(bt,1),F.pipesCount-=1,F.pipesCount===1&&(F.pipes=F.pipes[0]),T.emit("unpipe",this),this)},B.prototype.on=function(T,F){var Z=m.prototype.on.call(this,T,F);if(T==="data")this._readableState.flowing!==!1&&this.resume();else if(T==="readable"){var it=this._readableState;!it.endEmitted&&!it.readableListening&&(it.readableListening=it.needReadable=!0,it.emittedReadable=!1,it.reading?it.length&&lt(this):R(Et,this))}return Z},B.prototype.addListener=B.prototype.on;function Et(T){L("readable nexttick read 0"),T.read(0)}B.prototype.resume=function(){var T=this._readableState;return T.flowing||(L("resume"),T.flowing=!0,Zt(this,T)),this};function Zt(T,F){F.resumeScheduled||(F.resumeScheduled=!0,R(j,T,F))}function j(T,F){F.reading||(L("resume read 0"),T.read(0)),F.resumeScheduled=!1,F.awaitDrain=0,T.emit("resume"),U(T),F.flowing&&!F.reading&&T.read(0)}B.prototype.pause=function(){return L("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(L("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function U(T){var F=T._readableState;for(L("flow",F.flowing);F.flowing&&T.read()!==null;);}B.prototype.wrap=function(T){var F=this._readableState,Z=!1,it=this;T.on("end",function(){if(L("wrapped end"),F.decoder&&!F.ended){var Q=F.decoder.end();Q&&Q.length&&it.push(Q)}it.push(null)}),T.on("data",function(Q){if(L("wrapped data"),F.decoder&&(Q=F.decoder.write(Q)),!(F.objectMode&&Q==null)&&!(!F.objectMode&&(!Q||!Q.length))){var ne=it.push(Q);ne||(Z=!0,T.pause())}});for(var pt in T)this[pt]===void 0&&typeof T[pt]=="function"&&(this[pt]=(function(Q){return function(){return T[Q].apply(T,arguments)}})(pt));var bt=["error","close","destroy","pause","resume"];return Wt(bt,function(Q){T.on(Q,it.emit.bind(it,Q))}),it._read=function(Q){L("wrapped _read",Q),Z&&(Z=!1,T.resume())},it},B._fromList=K;function K(T,F){if(F.length===0)return null;var Z;return F.objectMode?Z=F.buffer.shift():!T||T>=F.length?(F.decoder?Z=F.buffer.join(""):F.buffer.length===1?Z=F.buffer.head.data:Z=F.buffer.concat(F.length),F.buffer.clear()):Z=ft(T,F.buffer,F.decoder),Z}function ft(T,F,Z){var it;return T<F.head.data.length?(it=F.head.data.slice(0,T),F.head.data=F.head.data.slice(T)):T===F.head.data.length?it=F.shift():it=Z?Rt(T,F):gt(T,F),it}function Rt(T,F){var Z=F.head,it=1,pt=Z.data;for(T-=pt.length;Z=Z.next;){var bt=Z.data,Q=T>bt.length?bt.length:T;if(Q===bt.length?pt+=bt:pt+=bt.slice(0,T),T-=Q,T===0){Q===bt.length?(++it,Z.next?F.head=Z.next:F.head=F.tail=null):(F.head=Z,Z.data=bt.slice(Q));break}++it}return F.length-=it,pt}function gt(T,F){var Z=b.allocUnsafe(T),it=F.head,pt=1;for(it.data.copy(Z),T-=it.data.length;it=it.next;){var bt=it.data,Q=T>bt.length?bt.length:T;if(bt.copy(Z,Z.length-T,0,Q),T-=Q,T===0){Q===bt.length?(++pt,it.next?F.head=it.next:F.head=F.tail=null):(F.head=it,it.data=bt.slice(Q));break}++pt}return F.length-=pt,Z}function _t(T){var F=T._readableState;if(F.length>0)throw new Error('"endReadable()" called on non-empty stream');F.endEmitted||(F.ended=!0,R(Ft,F,T))}function Ft(T,F){!T.endEmitted&&T.length===0&&(T.endEmitted=!0,F.readable=!1,F.emit("end"))}function Wt(T,F){for(var Z=0,it=T.length;Z<it;Z++)F(T[Z],Z)}function Mt(T,F){for(var Z=0,it=T.length;Z<it;Z++)if(T[Z]===F)return Z;return-1}}).call(d,v(6))},function(f,d,v){(function(g){!g.version||g.version.indexOf("v0.")===0||g.version.indexOf("v1.")===0&&g.version.indexOf("v1.8.")!==0?f.exports=R:f.exports=g.nextTick;function R(E,k,w,m){if(typeof E!="function")throw new TypeError('"callback" argument must be a function');var a=arguments.length,b,u;switch(a){case 0:case 1:return g.nextTick(E);case 2:return g.nextTick(function(){E.call(null,k)});case 3:return g.nextTick(function(){E.call(null,k,w)});case 4:return g.nextTick(function(){E.call(null,k,w,m)});default:for(b=new Array(a-1),u=0;u<b.length;)b[u++]=arguments[u];return g.nextTick(function(){E.apply(null,b)})}}}).call(d,v(6))},function(f,d){var v={}.toString;f.exports=Array.isArray||function(g){return v.call(g)=="[object Array]"}},function(f,d,v){(function(g){var R=v(2),E=R.Buffer,k=R.SlowBuffer,w=R.kMaxLength||2147483647;d.alloc=function(a,b,u){if(typeof E.alloc=="function")return E.alloc(a,b,u);if(typeof u=="number")throw new TypeError("encoding must not be number");if(typeof a!="number")throw new TypeError("size must be a number");if(a>w)throw new RangeError("size is too large");var N=u,L=b;L===void 0&&(N=void 0,L=0);var O=new E(a);if(typeof L=="string")for(var C=new E(L,N),A=C.length,J=-1;++J<a;)O[J]=C[J%A];else O.fill(L);return O},d.allocUnsafe=function(a){if(typeof E.allocUnsafe=="function")return E.allocUnsafe(a);if(typeof a!="number")throw new TypeError("size must be a number");if(a>w)throw new RangeError("size is too large");return new E(a)},d.from=function(a,b,u){if(typeof E.from=="function"&&(!g.Uint8Array||Uint8Array.from!==E.from))return E.from(a,b,u);if(typeof a=="number")throw new TypeError('"value" argument must not be a number');if(typeof a=="string")return new E(a,b);if(typeof ArrayBuffer<"u"&&a instanceof ArrayBuffer){var N=b;if(arguments.length===1)return new E(a);typeof N>"u"&&(N=0);var L=u;if(typeof L>"u"&&(L=a.byteLength-N),N>=a.byteLength)throw new RangeError("'offset' is out of bounds");if(L>a.byteLength-N)throw new RangeError("'length' is out of bounds");return new E(a.slice(N,N+L))}if(E.isBuffer(a)){var O=new E(a.length);return a.copy(O,0,0,a.length),O}if(a){if(Array.isArray(a)||typeof ArrayBuffer<"u"&&a.buffer instanceof ArrayBuffer||"length"in a)return new E(a);if(a.type==="Buffer"&&Array.isArray(a.data))return new E(a.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},d.allocUnsafeSlow=function(a){if(typeof E.allocUnsafeSlow=="function")return E.allocUnsafeSlow(a);if(typeof a!="number")throw new TypeError("size must be a number");if(a>=w)throw new RangeError("size is too large");return new k(a)}}).call(d,(function(){return this})())},function(f,d,v){(function(g){function R(H){return Array.isArray?Array.isArray(H):B(H)==="[object Array]"}d.isArray=R;function E(H){return typeof H=="boolean"}d.isBoolean=E;function k(H){return H===null}d.isNull=k;function w(H){return H==null}d.isNullOrUndefined=w;function m(H){return typeof H=="number"}d.isNumber=m;function a(H){return typeof H=="string"}d.isString=a;function b(H){return typeof H=="symbol"}d.isSymbol=b;function u(H){return H===void 0}d.isUndefined=u;function N(H){return B(H)==="[object RegExp]"}d.isRegExp=N;function L(H){return typeof H=="object"&&H!==null}d.isObject=L;function O(H){return B(H)==="[object Date]"}d.isDate=O;function C(H){return B(H)==="[object Error]"||H instanceof Error}d.isError=C;function A(H){return typeof H=="function"}d.isFunction=A;function J(H){return H===null||typeof H=="boolean"||typeof H=="number"||typeof H=="string"||typeof H=="symbol"||typeof H>"u"}d.isPrimitive=J,d.isBuffer=g.isBuffer;function B(H){return Object.prototype.toString.call(H)}}).call(d,v(1))},function(f,d){},function(f,d,v){v(2).Buffer;var g=v(17);f.exports=R;function R(){this.head=null,this.tail=null,this.length=0}R.prototype.push=function(E){var k={data:E,next:null};this.length>0?this.tail.next=k:this.head=k,this.tail=k,++this.length},R.prototype.unshift=function(E){var k={data:E,next:this.head};this.length===0&&(this.tail=k),this.head=k,++this.length},R.prototype.shift=function(){if(this.length!==0){var E=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,E}},R.prototype.clear=function(){this.head=this.tail=null,this.length=0},R.prototype.join=function(E){if(this.length===0)return"";for(var k=this.head,w=""+k.data;k=k.next;)w+=E+k.data;return w},R.prototype.concat=function(E){if(this.length===0)return g.alloc(0);if(this.length===1)return this.head.data;for(var k=g.allocUnsafe(E>>>0),w=this.head,m=0;w;)w.data.copy(k,m),m+=w.data.length,w=w.next;return k}},function(f,d,v){var g=Object.keys||function(O){var C=[];for(var A in O)C.push(A);return C};f.exports=u;var R=v(15),E=v(18);E.inherits=v(12);var k=v(14),w=v(22);E.inherits(u,k);for(var m=g(w.prototype),a=0;a<m.length;a++){var b=m[a];u.prototype[b]||(u.prototype[b]=w.prototype[b])}function u(O){if(!(this instanceof u))return new u(O);k.call(this,O),w.call(this,O),O&&O.readable===!1&&(this.readable=!1),O&&O.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,O&&O.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",N)}function N(){this.allowHalfOpen||this._writableState.ended||R(L,this)}function L(O){O.end()}},function(f,d,v){(function(g){f.exports=A;var R=v(15),E=!g.browser&&["v0.10","v0.9."].indexOf(g.version.slice(0,5))>-1?setImmediate:R,k;A.WritableState=O;var w=v(18);w.inherits=v(12);var m={deprecate:v(23)},a;(function(){try{a=v(11)}catch{}finally{a||(a=v(8).EventEmitter)}})();var b=v(2).Buffer,u=v(17);w.inherits(A,a);function N(){}function L(j,U,K){this.chunk=j,this.encoding=U,this.callback=K,this.next=null}function O(j,U){k=k||v(21),j=j||{},this.objectMode=!!j.objectMode,U instanceof k&&(this.objectMode=this.objectMode||!!j.writableObjectMode);var K=j.highWaterMark,ft=this.objectMode?16:16*1024;this.highWaterMark=K||K===0?K:ft,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var Rt=j.decodeStrings===!1;this.decodeStrings=!Rt,this.defaultEncoding=j.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(gt){z(U,gt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Zt(this)}O.prototype.getBuffer=function(){for(var U=this.bufferedRequest,K=[];U;)K.push(U),U=U.next;return K},(function(){try{Object.defineProperty(O.prototype,"buffer",{get:m.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch{}})();var C;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(C=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(j){return C.call(this,j)?!0:j&&j._writableState instanceof O}})):C=function(j){return j instanceof this};function A(j){if(k=k||v(21),!C.call(A,this)&&!(this instanceof k))return new A(j);this._writableState=new O(j,this),this.writable=!0,j&&(typeof j.write=="function"&&(this._write=j.write),typeof j.writev=="function"&&(this._writev=j.writev)),a.call(this)}A.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function J(j,U){var K=new Error("write after end");j.emit("error",K),R(U,K)}function B(j,U,K,ft){var Rt=!0,gt=!1;return K===null?gt=new TypeError("May not write null values to stream"):typeof K!="string"&&K!==void 0&&!U.objectMode&&(gt=new TypeError("Invalid non-string/buffer chunk")),gt&&(j.emit("error",gt),R(ft,gt),Rt=!1),Rt}A.prototype.write=function(j,U,K){var ft=this._writableState,Rt=!1,gt=b.isBuffer(j);return typeof U=="function"&&(K=U,U=null),gt?U="buffer":U||(U=ft.defaultEncoding),typeof K!="function"&&(K=N),ft.ended?J(this,K):(gt||B(this,ft,j,K))&&(ft.pendingcb++,Rt=St(this,ft,gt,j,U,K)),Rt},A.prototype.cork=function(){var j=this._writableState;j.corked++},A.prototype.uncork=function(){var j=this._writableState;j.corked&&(j.corked--,!j.writing&&!j.corked&&!j.finished&&!j.bufferProcessing&&j.bufferedRequest&&Tt(this,j))},A.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=U.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((U+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+U);return this._writableState.defaultEncoding=U,this};function H(j,U,K){return!j.objectMode&&j.decodeStrings!==!1&&typeof U=="string"&&(U=u.from(U,K)),U}function St(j,U,K,ft,Rt,gt){K||(ft=H(U,ft,Rt),b.isBuffer(ft)&&(Rt="buffer"));var _t=U.objectMode?1:ft.length;U.length+=_t;var Ft=U.length<U.highWaterMark;if(Ft||(U.needDrain=!0),U.writing||U.corked){var Wt=U.lastBufferedRequest;U.lastBufferedRequest=new L(ft,Rt,gt),Wt?Wt.next=U.lastBufferedRequest:U.bufferedRequest=U.lastBufferedRequest,U.bufferedRequestCount+=1}else tt(j,U,!1,_t,ft,Rt,gt);return Ft}function tt(j,U,K,ft,Rt,gt,_t){U.writelen=ft,U.writecb=_t,U.writing=!0,U.sync=!0,K?j._writev(Rt,U.onwrite):j._write(Rt,gt,U.onwrite),U.sync=!1}function kt(j,U,K,ft,Rt){--U.pendingcb,K?R(Rt,ft):Rt(ft),j._writableState.errorEmitted=!0,j.emit("error",ft)}function dt(j){j.writing=!1,j.writecb=null,j.length-=j.writelen,j.writelen=0}function z(j,U){var K=j._writableState,ft=K.sync,Rt=K.writecb;if(dt(K),U)kt(j,K,ft,U,Rt);else{var gt=mt(K);!gt&&!K.corked&&!K.bufferProcessing&&K.bufferedRequest&&Tt(j,K),ft?E(et,j,K,gt,Rt):et(j,K,gt,Rt)}}function et(j,U,K,ft){K||lt(j,U),U.pendingcb--,ft(),xt(j,U)}function lt(j,U){U.length===0&&U.needDrain&&(U.needDrain=!1,j.emit("drain"))}function Tt(j,U){U.bufferProcessing=!0;var K=U.bufferedRequest;if(j._writev&&K&&K.next){var ft=U.bufferedRequestCount,Rt=new Array(ft),gt=U.corkedRequestsFree;gt.entry=K;for(var _t=0;K;)Rt[_t]=K,K=K.next,_t+=1;tt(j,U,!0,U.length,Rt,"",gt.finish),U.pendingcb++,U.lastBufferedRequest=null,gt.next?(U.corkedRequestsFree=gt.next,gt.next=null):U.corkedRequestsFree=new Zt(U)}else{for(;K;){var Ft=K.chunk,Wt=K.encoding,Mt=K.callback,T=U.objectMode?1:Ft.length;if(tt(j,U,!1,T,Ft,Wt,Mt),K=K.next,U.writing)break}K===null&&(U.lastBufferedRequest=null)}U.bufferedRequestCount=0,U.bufferedRequest=K,U.bufferProcessing=!1}A.prototype._write=function(j,U,K){K(new Error("_write() is not implemented"))},A.prototype._writev=null,A.prototype.end=function(j,U,K){var ft=this._writableState;typeof j=="function"?(K=j,j=null,U=null):typeof U=="function"&&(K=U,U=null),j!=null&&this.write(j,U),ft.corked&&(ft.corked=1,this.uncork()),!ft.ending&&!ft.finished&&Et(this,ft,K)};function mt(j){return j.ending&&j.length===0&&j.bufferedRequest===null&&!j.finished&&!j.writing}function Ct(j,U){U.prefinished||(U.prefinished=!0,j.emit("prefinish"))}function xt(j,U){var K=mt(U);return K&&(U.pendingcb===0?(Ct(j,U),U.finished=!0,j.emit("finish")):Ct(j,U)),K}function Et(j,U,K){U.ending=!0,xt(j,U),K&&(U.finished?R(K):j.once("finish",K)),U.ended=!0,j.writable=!1}function Zt(j){var U=this;this.next=null,this.entry=null,this.finish=function(K){var ft=U.entry;for(U.entry=null;ft;){var Rt=ft.callback;j.pendingcb--,Rt(K),ft=ft.next}j.corkedRequestsFree?j.corkedRequestsFree.next=U:j.corkedRequestsFree=U}}}).call(d,v(6))},function(f,d){(function(v){f.exports=g;function g(E,k){if(R("noDeprecation"))return E;var w=!1;function m(){if(!w){if(R("throwDeprecation"))throw new Error(k);R("traceDeprecation")?console.trace(k):console.warn(k),w=!0}return E.apply(this,arguments)}return m}function R(E){try{if(!v.localStorage)return!1}catch{return!1}var k=v.localStorage[E];return k==null?!1:String(k).toLowerCase()==="true"}}).call(d,(function(){return this})())},function(f,d,v){var g=v(2).Buffer,R=g.isEncoding||function(b){switch(b&&b.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function E(b){if(b&&!R(b))throw new Error("Unknown encoding: "+b)}var k=d.StringDecoder=function(b){switch(this.encoding=(b||"utf8").toLowerCase().replace(/[-_]/,""),E(b),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=m;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:this.write=w;return}this.charBuffer=new g(6),this.charReceived=0,this.charLength=0};k.prototype.write=function(b){for(var u="";this.charLength;){var N=b.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:b.length;if(b.copy(this.charBuffer,this.charReceived,0,N),this.charReceived+=N,this.charReceived<this.charLength)return"";b=b.slice(N,b.length),u=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var O=u.charCodeAt(u.length-1);if(O>=55296&&O<=56319){this.charLength+=this.surrogateSize,u="";continue}if(this.charReceived=this.charLength=0,b.length===0)return u;break}this.detectIncompleteChar(b);var L=b.length;this.charLength&&(b.copy(this.charBuffer,0,b.length-this.charReceived,L),L-=this.charReceived),u+=b.toString(this.encoding,0,L);var L=u.length-1,O=u.charCodeAt(L);if(O>=55296&&O<=56319){var C=this.surrogateSize;return this.charLength+=C,this.charReceived+=C,this.charBuffer.copy(this.charBuffer,C,0,C),b.copy(this.charBuffer,0,0,C),u.substring(0,L)}return u},k.prototype.detectIncompleteChar=function(b){for(var u=b.length>=3?3:b.length;u>0;u--){var N=b[b.length-u];if(u==1&&N>>5==6){this.charLength=2;break}if(u<=2&&N>>4==14){this.charLength=3;break}if(u<=3&&N>>3==30){this.charLength=4;break}}this.charReceived=u},k.prototype.end=function(b){var u="";if(b&&b.length&&(u=this.write(b)),this.charReceived){var N=this.charReceived,L=this.charBuffer,O=this.encoding;u+=L.slice(0,N).toString(O)}return u};function w(b){return b.toString(this.encoding)}function m(b){this.charReceived=b.length%2,this.charLength=this.charReceived?2:0}function a(b){this.charReceived=b.length%3,this.charLength=this.charReceived?3:0}},function(f,d,v){f.exports=w;var g=v(21),R=v(18);R.inherits=v(12),R.inherits(w,g);function E(a){this.afterTransform=function(b,u){return k(a,b,u)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function k(a,b,u){var N=a._transformState;N.transforming=!1;var L=N.writecb;if(!L)return a.emit("error",new Error("no writecb in Transform class"));N.writechunk=null,N.writecb=null,u!=null&&a.push(u),L(b);var O=a._readableState;O.reading=!1,(O.needReadable||O.length<O.highWaterMark)&&a._read(O.highWaterMark)}function w(a){if(!(this instanceof w))return new w(a);g.call(this,a),this._transformState=new E(this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&(typeof a.transform=="function"&&(this._transform=a.transform),typeof a.flush=="function"&&(this._flush=a.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(u,N){m(b,u,N)}):m(b)})}w.prototype.push=function(a,b){return this._transformState.needTransform=!1,g.prototype.push.call(this,a,b)},w.prototype._transform=function(a,b,u){throw new Error("_transform() is not implemented")},w.prototype._write=function(a,b,u){var N=this._transformState;if(N.writecb=u,N.writechunk=a,N.writeencoding=b,!N.transforming){var L=this._readableState;(N.needTransform||L.needReadable||L.length<L.highWaterMark)&&this._read(L.highWaterMark)}},w.prototype._read=function(a){var b=this._transformState;b.writechunk!==null&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0};function m(a,b,u){if(b)return a.emit("error",b);u!=null&&a.push(u);var N=a._writableState,L=a._transformState;if(N.length)throw new Error("Calling transform done when ws.length != 0");if(L.transforming)throw new Error("Calling transform done when still transforming");return a.push(null)}},function(f,d,v){f.exports=E;var g=v(25),R=v(18);R.inherits=v(12),R.inherits(E,g);function E(k){if(!(this instanceof E))return new E(k);g.call(this,k)}E.prototype._transform=function(k,w,m){m(null,k)}},function(f,d,v){f.exports=v(22)},function(f,d,v){f.exports=v(21)},function(f,d,v){f.exports=v(25)},function(f,d,v){f.exports=v(26)},function(f,d,v){var g=v(32),R=v(33),E=v(38),k=v(39),w=v(40),m=v(41),a=v(42),b=Object.prototype.toString;function u(O){if(!(this instanceof u))return new u(O);this.options=R.assign({chunkSize:16384,windowBits:0,to:""},O||{});var C=this.options;C.raw&&C.windowBits>=0&&C.windowBits<16&&(C.windowBits=-C.windowBits,C.windowBits===0&&(C.windowBits=-15)),C.windowBits>=0&&C.windowBits<16&&!(O&&O.windowBits)&&(C.windowBits+=32),C.windowBits>15&&C.windowBits<48&&(C.windowBits&15)===0&&(C.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var A=g.inflateInit2(this.strm,C.windowBits);if(A!==k.Z_OK)throw new Error(w[A]);this.header=new a,g.inflateGetHeader(this.strm,this.header)}u.prototype.push=function(O,C){var A=this.strm,J=this.options.chunkSize,B=this.options.dictionary,H,St,tt,kt,dt,z,et=!1;if(this.ended)return!1;St=C===~~C?C:C===!0?k.Z_FINISH:k.Z_NO_FLUSH,typeof O=="string"?A.input=E.binstring2buf(O):b.call(O)==="[object ArrayBuffer]"?A.input=new Uint8Array(O):A.input=O,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new R.Buf8(J),A.next_out=0,A.avail_out=J),H=g.inflate(A,k.Z_NO_FLUSH),H===k.Z_NEED_DICT&&B&&(typeof B=="string"?z=E.string2buf(B):b.call(B)==="[object ArrayBuffer]"?z=new Uint8Array(B):z=B,H=g.inflateSetDictionary(this.strm,z)),H===k.Z_BUF_ERROR&&et===!0&&(H=k.Z_OK,et=!1),H!==k.Z_STREAM_END&&H!==k.Z_OK)return this.onEnd(H),this.ended=!0,!1;A.next_out&&(A.avail_out===0||H===k.Z_STREAM_END||A.avail_in===0&&(St===k.Z_FINISH||St===k.Z_SYNC_FLUSH))&&(this.options.to==="string"?(tt=E.utf8border(A.output,A.next_out),kt=A.next_out-tt,dt=E.buf2string(A.output,tt),A.next_out=kt,A.avail_out=J-kt,kt&&R.arraySet(A.output,A.output,tt,kt,0),this.onData(dt)):this.onData(R.shrinkBuf(A.output,A.next_out))),A.avail_in===0&&A.avail_out===0&&(et=!0)}while((A.avail_in>0||A.avail_out===0)&&H!==k.Z_STREAM_END);return H===k.Z_STREAM_END&&(St=k.Z_FINISH),St===k.Z_FINISH?(H=g.inflateEnd(this.strm),this.onEnd(H),this.ended=!0,H===k.Z_OK):(St===k.Z_SYNC_FLUSH&&(this.onEnd(k.Z_OK),A.avail_out=0),!0)},u.prototype.onData=function(O){this.chunks.push(O)},u.prototype.onEnd=function(O){O===k.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=R.flattenChunks(this.chunks)),this.chunks=[],this.err=O,this.msg=this.strm.msg};function N(O,C){var A=new u(C);if(A.push(O,!0),A.err)throw A.msg||w[A.err];return A.result}function L(O,C){return C=C||{},C.raw=!0,N(O,C)}d.Inflate=u,d.inflate=N,d.inflateRaw=L,d.ungzip=N},function(f,d,v){var g=v(33),R=v(34),E=v(35),k=v(36),w=v(37),m=0,a=1,b=2,u=4,N=5,L=6,O=0,C=1,A=2,J=-2,B=-3,H=-4,St=-5,tt=8,kt=1,dt=2,z=3,et=4,lt=5,Tt=6,mt=7,Ct=8,xt=9,Et=10,Zt=11,j=12,U=13,K=14,ft=15,Rt=16,gt=17,_t=18,Ft=19,Wt=20,Mt=21,T=22,F=23,Z=24,it=25,pt=26,bt=27,Q=28,ne=29,vt=30,oe=31,le=32,be=852,I=592,h=15,p=h;function x(W){return(W>>>24&255)+(W>>>8&65280)+((W&65280)<<8)+((W&255)<<24)}function P(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new g.Buf16(320),this.work=new g.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function G(W){var st;return!W||!W.state?J:(st=W.state,W.total_in=W.total_out=st.total=0,W.msg="",st.wrap&&(W.adler=st.wrap&1),st.mode=kt,st.last=0,st.havedict=0,st.dmax=32768,st.head=null,st.hold=0,st.bits=0,st.lencode=st.lendyn=new g.Buf32(be),st.distcode=st.distdyn=new g.Buf32(I),st.sane=1,st.back=-1,O)}function V(W){var st;return!W||!W.state?J:(st=W.state,st.wsize=0,st.whave=0,st.wnext=0,G(W))}function Lt(W,st){var _,ct;return!W||!W.state||(ct=W.state,st<0?(_=0,st=-st):(_=(st>>4)+1,st<48&&(st&=15)),st&&(st<8||st>15))?J:(ct.window!==null&&ct.wbits!==st&&(ct.window=null),ct.wrap=_,ct.wbits=st,V(W))}function Dt(W,st){var _,ct;return W?(ct=new P,W.state=ct,ct.window=null,_=Lt(W,st),_!==O&&(W.state=null),_):J}function Pt(W){return Dt(W,p)}var Vt=!0,At,ke;function Qe(W){if(Vt){var st;for(At=new g.Buf32(512),ke=new g.Buf32(32),st=0;st<144;)W.lens[st++]=8;for(;st<256;)W.lens[st++]=9;for(;st<280;)W.lens[st++]=7;for(;st<288;)W.lens[st++]=8;for(w(a,W.lens,0,288,At,0,W.work,{bits:9}),st=0;st<32;)W.lens[st++]=5;w(b,W.lens,0,32,ke,0,W.work,{bits:5}),Vt=!1}W.lencode=At,W.lenbits=9,W.distcode=ke,W.distbits=5}function je(W,st,_,ct){var Bt,ot=W.state;return ot.window===null&&(ot.wsize=1<<ot.wbits,ot.wnext=0,ot.whave=0,ot.window=new g.Buf8(ot.wsize)),ct>=ot.wsize?(g.arraySet(ot.window,st,_-ot.wsize,ot.wsize,0),ot.wnext=0,ot.whave=ot.wsize):(Bt=ot.wsize-ot.wnext,Bt>ct&&(Bt=ct),g.arraySet(ot.window,st,_-ct,Bt,ot.wnext),ct-=Bt,ct?(g.arraySet(ot.window,st,_-ct,ct,0),ot.wnext=ct,ot.whave=ot.wsize):(ot.wnext+=Bt,ot.wnext===ot.wsize&&(ot.wnext=0),ot.whave<ot.wsize&&(ot.whave+=Bt))),0}function We(W,st){var _,ct,Bt,ot,fe,at,Kt,Y,X,$e,Ut,ht,He,Ne,Ht=0,Ot,ie,ue,re,tn,qe,Xt,he,te=new g.Buf8(4),Ie,Se,In=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!W||!W.state||!W.output||!W.input&&W.avail_in!==0)return J;_=W.state,_.mode===j&&(_.mode=U),fe=W.next_out,Bt=W.output,Kt=W.avail_out,ot=W.next_in,ct=W.input,at=W.avail_in,Y=_.hold,X=_.bits,$e=at,Ut=Kt,he=O;t:for(;;)switch(_.mode){case kt:if(_.wrap===0){_.mode=U;break}for(;X<16;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if(_.wrap&2&&Y===35615){_.check=0,te[0]=Y&255,te[1]=Y>>>8&255,_.check=E(_.check,te,2,0),Y=0,X=0,_.mode=dt;break}if(_.flags=0,_.head&&(_.head.done=!1),!(_.wrap&1)||(((Y&255)<<8)+(Y>>8))%31){W.msg="incorrect header check",_.mode=vt;break}if((Y&15)!==tt){W.msg="unknown compression method",_.mode=vt;break}if(Y>>>=4,X-=4,Xt=(Y&15)+8,_.wbits===0)_.wbits=Xt;else if(Xt>_.wbits){W.msg="invalid window size",_.mode=vt;break}_.dmax=1<<Xt,W.adler=_.check=1,_.mode=Y&512?Et:j,Y=0,X=0;break;case dt:for(;X<16;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if(_.flags=Y,(_.flags&255)!==tt){W.msg="unknown compression method",_.mode=vt;break}if(_.flags&57344){W.msg="unknown header flags set",_.mode=vt;break}_.head&&(_.head.text=Y>>8&1),_.flags&512&&(te[0]=Y&255,te[1]=Y>>>8&255,_.check=E(_.check,te,2,0)),Y=0,X=0,_.mode=z;case z:for(;X<32;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}_.head&&(_.head.time=Y),_.flags&512&&(te[0]=Y&255,te[1]=Y>>>8&255,te[2]=Y>>>16&255,te[3]=Y>>>24&255,_.check=E(_.check,te,4,0)),Y=0,X=0,_.mode=et;case et:for(;X<16;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}_.head&&(_.head.xflags=Y&255,_.head.os=Y>>8),_.flags&512&&(te[0]=Y&255,te[1]=Y>>>8&255,_.check=E(_.check,te,2,0)),Y=0,X=0,_.mode=lt;case lt:if(_.flags&1024){for(;X<16;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}_.length=Y,_.head&&(_.head.extra_len=Y),_.flags&512&&(te[0]=Y&255,te[1]=Y>>>8&255,_.check=E(_.check,te,2,0)),Y=0,X=0}else _.head&&(_.head.extra=null);_.mode=Tt;case Tt:if(_.flags&1024&&(ht=_.length,ht>at&&(ht=at),ht&&(_.head&&(Xt=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),g.arraySet(_.head.extra,ct,ot,ht,Xt)),_.flags&512&&(_.check=E(_.check,ct,ht,ot)),at-=ht,ot+=ht,_.length-=ht),_.length))break t;_.length=0,_.mode=mt;case mt:if(_.flags&2048){if(at===0)break t;ht=0;do Xt=ct[ot+ht++],_.head&&Xt&&_.length<65536&&(_.head.name+=String.fromCharCode(Xt));while(Xt&&ht<at);if(_.flags&512&&(_.check=E(_.check,ct,ht,ot)),at-=ht,ot+=ht,Xt)break t}else _.head&&(_.head.name=null);_.length=0,_.mode=Ct;case Ct:if(_.flags&4096){if(at===0)break t;ht=0;do Xt=ct[ot+ht++],_.head&&Xt&&_.length<65536&&(_.head.comment+=String.fromCharCode(Xt));while(Xt&&ht<at);if(_.flags&512&&(_.check=E(_.check,ct,ht,ot)),at-=ht,ot+=ht,Xt)break t}else _.head&&(_.head.comment=null);_.mode=xt;case xt:if(_.flags&512){for(;X<16;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if(Y!==(_.check&65535)){W.msg="header crc mismatch",_.mode=vt;break}Y=0,X=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),W.adler=_.check=0,_.mode=j;break;case Et:for(;X<32;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}W.adler=_.check=x(Y),Y=0,X=0,_.mode=Zt;case Zt:if(_.havedict===0)return W.next_out=fe,W.avail_out=Kt,W.next_in=ot,W.avail_in=at,_.hold=Y,_.bits=X,A;W.adler=_.check=1,_.mode=j;case j:if(st===N||st===L)break t;case U:if(_.last){Y>>>=X&7,X-=X&7,_.mode=bt;break}for(;X<3;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}switch(_.last=Y&1,Y>>>=1,X-=1,Y&3){case 0:_.mode=K;break;case 1:if(Qe(_),_.mode=Wt,st===L){Y>>>=2,X-=2;break t}break;case 2:_.mode=gt;break;case 3:W.msg="invalid block type",_.mode=vt}Y>>>=2,X-=2;break;case K:for(Y>>>=X&7,X-=X&7;X<32;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if((Y&65535)!==(Y>>>16^65535)){W.msg="invalid stored block lengths",_.mode=vt;break}if(_.length=Y&65535,Y=0,X=0,_.mode=ft,st===L)break t;case ft:_.mode=Rt;case Rt:if(ht=_.length,ht){if(ht>at&&(ht=at),ht>Kt&&(ht=Kt),ht===0)break t;g.arraySet(Bt,ct,ot,ht,fe),at-=ht,ot+=ht,Kt-=ht,fe+=ht,_.length-=ht;break}_.mode=j;break;case gt:for(;X<14;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if(_.nlen=(Y&31)+257,Y>>>=5,X-=5,_.ndist=(Y&31)+1,Y>>>=5,X-=5,_.ncode=(Y&15)+4,Y>>>=4,X-=4,_.nlen>286||_.ndist>30){W.msg="too many length or distance symbols",_.mode=vt;break}_.have=0,_.mode=_t;case _t:for(;_.have<_.ncode;){for(;X<3;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}_.lens[In[_.have++]]=Y&7,Y>>>=3,X-=3}for(;_.have<19;)_.lens[In[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,Ie={bits:_.lenbits},he=w(m,_.lens,0,19,_.lencode,0,_.work,Ie),_.lenbits=Ie.bits,he){W.msg="invalid code lengths set",_.mode=vt;break}_.have=0,_.mode=Ft;case Ft:for(;_.have<_.nlen+_.ndist;){for(;Ht=_.lencode[Y&(1<<_.lenbits)-1],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(Ot<=X);){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if(ue<16)Y>>>=Ot,X-=Ot,_.lens[_.have++]=ue;else{if(ue===16){for(Se=Ot+2;X<Se;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if(Y>>>=Ot,X-=Ot,_.have===0){W.msg="invalid bit length repeat",_.mode=vt;break}Xt=_.lens[_.have-1],ht=3+(Y&3),Y>>>=2,X-=2}else if(ue===17){for(Se=Ot+3;X<Se;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}Y>>>=Ot,X-=Ot,Xt=0,ht=3+(Y&7),Y>>>=3,X-=3}else{for(Se=Ot+7;X<Se;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}Y>>>=Ot,X-=Ot,Xt=0,ht=11+(Y&127),Y>>>=7,X-=7}if(_.have+ht>_.nlen+_.ndist){W.msg="invalid bit length repeat",_.mode=vt;break}for(;ht--;)_.lens[_.have++]=Xt}}if(_.mode===vt)break;if(_.lens[256]===0){W.msg="invalid code -- missing end-of-block",_.mode=vt;break}if(_.lenbits=9,Ie={bits:_.lenbits},he=w(a,_.lens,0,_.nlen,_.lencode,0,_.work,Ie),_.lenbits=Ie.bits,he){W.msg="invalid literal/lengths set",_.mode=vt;break}if(_.distbits=6,_.distcode=_.distdyn,Ie={bits:_.distbits},he=w(b,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,Ie),_.distbits=Ie.bits,he){W.msg="invalid distances set",_.mode=vt;break}if(_.mode=Wt,st===L)break t;case Wt:_.mode=Mt;case Mt:if(at>=6&&Kt>=258){W.next_out=fe,W.avail_out=Kt,W.next_in=ot,W.avail_in=at,_.hold=Y,_.bits=X,k(W,Ut),fe=W.next_out,Bt=W.output,Kt=W.avail_out,ot=W.next_in,ct=W.input,at=W.avail_in,Y=_.hold,X=_.bits,_.mode===j&&(_.back=-1);break}for(_.back=0;Ht=_.lencode[Y&(1<<_.lenbits)-1],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(Ot<=X);){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if(ie&&(ie&240)===0){for(re=Ot,tn=ie,qe=ue;Ht=_.lencode[qe+((Y&(1<<re+tn)-1)>>re)],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(re+Ot<=X);){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}Y>>>=re,X-=re,_.back+=re}if(Y>>>=Ot,X-=Ot,_.back+=Ot,_.length=ue,ie===0){_.mode=pt;break}if(ie&32){_.back=-1,_.mode=j;break}if(ie&64){W.msg="invalid literal/length code",_.mode=vt;break}_.extra=ie&15,_.mode=T;case T:if(_.extra){for(Se=_.extra;X<Se;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}_.length+=Y&(1<<_.extra)-1,Y>>>=_.extra,X-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=F;case F:for(;Ht=_.distcode[Y&(1<<_.distbits)-1],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(Ot<=X);){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if((ie&240)===0){for(re=Ot,tn=ie,qe=ue;Ht=_.distcode[qe+((Y&(1<<re+tn)-1)>>re)],Ot=Ht>>>24,ie=Ht>>>16&255,ue=Ht&65535,!(re+Ot<=X);){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}Y>>>=re,X-=re,_.back+=re}if(Y>>>=Ot,X-=Ot,_.back+=Ot,ie&64){W.msg="invalid distance code",_.mode=vt;break}_.offset=ue,_.extra=ie&15,_.mode=Z;case Z:if(_.extra){for(Se=_.extra;X<Se;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}_.offset+=Y&(1<<_.extra)-1,Y>>>=_.extra,X-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){W.msg="invalid distance too far back",_.mode=vt;break}_.mode=it;case it:if(Kt===0)break t;if(ht=Ut-Kt,_.offset>ht){if(ht=_.offset-ht,ht>_.whave&&_.sane){W.msg="invalid distance too far back",_.mode=vt;break}ht>_.wnext?(ht-=_.wnext,He=_.wsize-ht):He=_.wnext-ht,ht>_.length&&(ht=_.length),Ne=_.window}else Ne=Bt,He=fe-_.offset,ht=_.length;ht>Kt&&(ht=Kt),Kt-=ht,_.length-=ht;do Bt[fe++]=Ne[He++];while(--ht);_.length===0&&(_.mode=Mt);break;case pt:if(Kt===0)break t;Bt[fe++]=_.length,Kt--,_.mode=Mt;break;case bt:if(_.wrap){for(;X<32;){if(at===0)break t;at--,Y|=ct[ot++]<<X,X+=8}if(Ut-=Kt,W.total_out+=Ut,_.total+=Ut,Ut&&(W.adler=_.check=_.flags?E(_.check,Bt,Ut,fe-Ut):R(_.check,Bt,Ut,fe-Ut)),Ut=Kt,(_.flags?Y:x(Y))!==_.check){W.msg="incorrect data check",_.mode=vt;break}Y=0,X=0}_.mode=Q;case Q:if(_.wrap&&_.flags){for(;X<32;){if(at===0)break t;at--,Y+=ct[ot++]<<X,X+=8}if(Y!==(_.total&4294967295)){W.msg="incorrect length check",_.mode=vt;break}Y=0,X=0}_.mode=ne;case ne:he=C;break t;case vt:he=B;break t;case oe:return H;case le:default:return J}return W.next_out=fe,W.avail_out=Kt,W.next_in=ot,W.avail_in=at,_.hold=Y,_.bits=X,(_.wsize||Ut!==W.avail_out&&_.mode<vt&&(_.mode<bt||st!==u))&&je(W,W.output,W.next_out,Ut-W.avail_out),$e-=W.avail_in,Ut-=W.avail_out,W.total_in+=$e,W.total_out+=Ut,_.total+=Ut,_.wrap&&Ut&&(W.adler=_.check=_.flags?E(_.check,Bt,Ut,W.next_out-Ut):R(_.check,Bt,Ut,W.next_out-Ut)),W.data_type=_.bits+(_.last?64:0)+(_.mode===j?128:0)+(_.mode===Wt||_.mode===ft?256:0),($e===0&&Ut===0||st===u)&&he===O&&(he=St),he}function Yn(W){if(!W||!W.state)return J;var st=W.state;return st.window&&(st.window=null),W.state=null,O}function Zn(W,st){var _;return!W||!W.state||(_=W.state,(_.wrap&2)===0)?J:(_.head=st,st.done=!1,O)}function Vn(W,st){var _=st.length,ct,Bt,ot;return!W||!W.state||(ct=W.state,ct.wrap!==0&&ct.mode!==Zt)?J:ct.mode===Zt&&(Bt=1,Bt=R(Bt,st,_,0),Bt!==ct.check)?B:(ot=je(W,st,_,_),ot?(ct.mode=oe,H):(ct.havedict=1,O))}d.inflateReset=V,d.inflateReset2=Lt,d.inflateResetKeep=G,d.inflateInit=Pt,d.inflateInit2=Dt,d.inflate=We,d.inflateEnd=Yn,d.inflateGetHeader=Zn,d.inflateSetDictionary=Vn,d.inflateInfo="pako inflate (from Nodeca project)"},function(f,d){var v=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";d.assign=function(E){for(var k=Array.prototype.slice.call(arguments,1);k.length;){var w=k.shift();if(w){if(typeof w!="object")throw new TypeError(w+"must be non-object");for(var m in w)w.hasOwnProperty(m)&&(E[m]=w[m])}}return E},d.shrinkBuf=function(E,k){return E.length===k?E:E.subarray?E.subarray(0,k):(E.length=k,E)};var g={arraySet:function(E,k,w,m,a){if(k.subarray&&E.subarray){E.set(k.subarray(w,w+m),a);return}for(var b=0;b<m;b++)E[a+b]=k[w+b]},flattenChunks:function(E){var k,w,m,a,b,u;for(m=0,k=0,w=E.length;k<w;k++)m+=E[k].length;for(u=new Uint8Array(m),a=0,k=0,w=E.length;k<w;k++)b=E[k],u.set(b,a),a+=b.length;return u}},R={arraySet:function(E,k,w,m,a){for(var b=0;b<m;b++)E[a+b]=k[w+b]},flattenChunks:function(E){return[].concat.apply([],E)}};d.setTyped=function(E){E?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,g)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,R))},d.setTyped(v)},function(f,d){function v(g,R,E,k){for(var w=g&65535|0,m=g>>>16&65535|0,a=0;E!==0;){a=E>2e3?2e3:E,E-=a;do w=w+R[k++]|0,m=m+w|0;while(--a);w%=65521,m%=65521}return w|m<<16|0}f.exports=v},function(f,d){function v(){for(var E,k=[],w=0;w<256;w++){E=w;for(var m=0;m<8;m++)E=E&1?3988292384^E>>>1:E>>>1;k[w]=E}return k}var g=v();function R(E,k,w,m){var a=g,b=m+w;E^=-1;for(var u=m;u<b;u++)E=E>>>8^a[(E^k[u])&255];return E^-1}f.exports=R},function(f,d){var v=30,g=12;f.exports=function(E,k){var w,m,a,b,u,N,L,O,C,A,J,B,H,St,tt,kt,dt,z,et,lt,Tt,mt,Ct,xt,Et;w=E.state,m=E.next_in,xt=E.input,a=m+(E.avail_in-5),b=E.next_out,Et=E.output,u=b-(k-E.avail_out),N=b+(E.avail_out-257),L=w.dmax,O=w.wsize,C=w.whave,A=w.wnext,J=w.window,B=w.hold,H=w.bits,St=w.lencode,tt=w.distcode,kt=(1<<w.lenbits)-1,dt=(1<<w.distbits)-1;t:do{H<15&&(B+=xt[m++]<<H,H+=8,B+=xt[m++]<<H,H+=8),z=St[B&kt];e:for(;;){if(et=z>>>24,B>>>=et,H-=et,et=z>>>16&255,et===0)Et[b++]=z&65535;else if(et&16){lt=z&65535,et&=15,et&&(H<et&&(B+=xt[m++]<<H,H+=8),lt+=B&(1<<et)-1,B>>>=et,H-=et),H<15&&(B+=xt[m++]<<H,H+=8,B+=xt[m++]<<H,H+=8),z=tt[B&dt];n:for(;;){if(et=z>>>24,B>>>=et,H-=et,et=z>>>16&255,et&16){if(Tt=z&65535,et&=15,H<et&&(B+=xt[m++]<<H,H+=8,H<et&&(B+=xt[m++]<<H,H+=8)),Tt+=B&(1<<et)-1,Tt>L){E.msg="invalid distance too far back",w.mode=v;break t}if(B>>>=et,H-=et,et=b-u,Tt>et){if(et=Tt-et,et>C&&w.sane){E.msg="invalid distance too far back",w.mode=v;break t}if(mt=0,Ct=J,A===0){if(mt+=O-et,et<lt){lt-=et;do Et[b++]=J[mt++];while(--et);mt=b-Tt,Ct=Et}}else if(A<et){if(mt+=O+A-et,et-=A,et<lt){lt-=et;do Et[b++]=J[mt++];while(--et);if(mt=0,A<lt){et=A,lt-=et;do Et[b++]=J[mt++];while(--et);mt=b-Tt,Ct=Et}}}else if(mt+=A-et,et<lt){lt-=et;do Et[b++]=J[mt++];while(--et);mt=b-Tt,Ct=Et}for(;lt>2;)Et[b++]=Ct[mt++],Et[b++]=Ct[mt++],Et[b++]=Ct[mt++],lt-=3;lt&&(Et[b++]=Ct[mt++],lt>1&&(Et[b++]=Ct[mt++]))}else{mt=b-Tt;do Et[b++]=Et[mt++],Et[b++]=Et[mt++],Et[b++]=Et[mt++],lt-=3;while(lt>2);lt&&(Et[b++]=Et[mt++],lt>1&&(Et[b++]=Et[mt++]))}}else if((et&64)===0){z=tt[(z&65535)+(B&(1<<et)-1)];continue n}else{E.msg="invalid distance code",w.mode=v;break t}break}}else if((et&64)===0){z=St[(z&65535)+(B&(1<<et)-1)];continue e}else if(et&32){w.mode=g;break t}else{E.msg="invalid literal/length code",w.mode=v;break t}break}}while(m<a&&b<N);lt=H>>3,m-=lt,H-=lt<<3,B&=(1<<H)-1,E.next_in=m,E.next_out=b,E.avail_in=m<a?5+(a-m):5-(m-a),E.avail_out=b<N?257+(N-b):257-(b-N),w.hold=B,w.bits=H}},function(f,d,v){var g=v(33),R=15,E=852,k=592,w=0,m=1,a=2,b=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],N=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],L=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];f.exports=function(C,A,J,B,H,St,tt,kt){var dt=kt.bits,z=0,et=0,lt=0,Tt=0,mt=0,Ct=0,xt=0,Et=0,Zt=0,j=0,U,K,ft,Rt,gt,_t=null,Ft=0,Wt,Mt=new g.Buf16(R+1),T=new g.Buf16(R+1),F=null,Z=0,it,pt,bt;for(z=0;z<=R;z++)Mt[z]=0;for(et=0;et<B;et++)Mt[A[J+et]]++;for(mt=dt,Tt=R;Tt>=1&&Mt[Tt]===0;Tt--);if(mt>Tt&&(mt=Tt),Tt===0)return H[St++]=1<<24|64<<16|0,H[St++]=1<<24|64<<16|0,kt.bits=1,0;for(lt=1;lt<Tt&&Mt[lt]===0;lt++);for(mt<lt&&(mt=lt),Et=1,z=1;z<=R;z++)if(Et<<=1,Et-=Mt[z],Et<0)return-1;if(Et>0&&(C===w||Tt!==1))return-1;for(T[1]=0,z=1;z<R;z++)T[z+1]=T[z]+Mt[z];for(et=0;et<B;et++)A[J+et]!==0&&(tt[T[A[J+et]]++]=et);if(C===w?(_t=F=tt,Wt=19):C===m?(_t=b,Ft-=257,F=u,Z-=257,Wt=256):(_t=N,F=L,Wt=-1),j=0,et=0,z=lt,gt=St,Ct=mt,xt=0,ft=-1,Zt=1<<mt,Rt=Zt-1,C===m&&Zt>E||C===a&&Zt>k)return 1;for(;;){it=z-xt,tt[et]<Wt?(pt=0,bt=tt[et]):tt[et]>Wt?(pt=F[Z+tt[et]],bt=_t[Ft+tt[et]]):(pt=96,bt=0),U=1<<z-xt,K=1<<Ct,lt=K;do K-=U,H[gt+(j>>xt)+K]=it<<24|pt<<16|bt|0;while(K!==0);for(U=1<<z-1;j&U;)U>>=1;if(U!==0?(j&=U-1,j+=U):j=0,et++,--Mt[z]===0){if(z===Tt)break;z=A[J+tt[et]]}if(z>mt&&(j&Rt)!==ft){for(xt===0&&(xt=mt),gt+=lt,Ct=z-xt,Et=1<<Ct;Ct+xt<Tt&&(Et-=Mt[Ct+xt],!(Et<=0));)Ct++,Et<<=1;if(Zt+=1<<Ct,C===m&&Zt>E||C===a&&Zt>k)return 1;ft=j&Rt,H[ft]=mt<<24|Ct<<16|gt-St|0}}return j!==0&&(H[gt+j]=z-xt<<24|64<<16|0),kt.bits=mt,0}},function(f,d,v){var g=v(33),R=!0,E=!0;try{String.fromCharCode.apply(null,[0])}catch{R=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{E=!1}for(var k=new g.Buf8(256),w=0;w<256;w++)k[w]=w>=252?6:w>=248?5:w>=240?4:w>=224?3:w>=192?2:1;k[254]=k[254]=1,d.string2buf=function(a){var b,u,N,L,O,C=a.length,A=0;for(L=0;L<C;L++)u=a.charCodeAt(L),(u&64512)===55296&&L+1<C&&(N=a.charCodeAt(L+1),(N&64512)===56320&&(u=65536+(u-55296<<10)+(N-56320),L++)),A+=u<128?1:u<2048?2:u<65536?3:4;for(b=new g.Buf8(A),O=0,L=0;O<A;L++)u=a.charCodeAt(L),(u&64512)===55296&&L+1<C&&(N=a.charCodeAt(L+1),(N&64512)===56320&&(u=65536+(u-55296<<10)+(N-56320),L++)),u<128?b[O++]=u:u<2048?(b[O++]=192|u>>>6,b[O++]=128|u&63):u<65536?(b[O++]=224|u>>>12,b[O++]=128|u>>>6&63,b[O++]=128|u&63):(b[O++]=240|u>>>18,b[O++]=128|u>>>12&63,b[O++]=128|u>>>6&63,b[O++]=128|u&63);return b};function m(a,b){if(b<65537&&(a.subarray&&E||!a.subarray&&R))return String.fromCharCode.apply(null,g.shrinkBuf(a,b));for(var u="",N=0;N<b;N++)u+=String.fromCharCode(a[N]);return u}d.buf2binstring=function(a){return m(a,a.length)},d.binstring2buf=function(a){for(var b=new g.Buf8(a.length),u=0,N=b.length;u<N;u++)b[u]=a.charCodeAt(u);return b},d.buf2string=function(a,b){var u,N,L,O,C=b||a.length,A=new Array(C*2);for(N=0,u=0;u<C;){if(L=a[u++],L<128){A[N++]=L;continue}if(O=k[L],O>4){A[N++]=65533,u+=O-1;continue}for(L&=O===2?31:O===3?15:7;O>1&&u<C;)L=L<<6|a[u++]&63,O--;if(O>1){A[N++]=65533;continue}L<65536?A[N++]=L:(L-=65536,A[N++]=55296|L>>10&1023,A[N++]=56320|L&1023)}return m(A,N)},d.utf8border=function(a,b){var u;for(b=b||a.length,b>a.length&&(b=a.length),u=b-1;u>=0&&(a[u]&192)===128;)u--;return u<0||u===0?b:u+k[a[u]]>b?u:b}},function(f,d){f.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(f,d){f.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(f,d){function v(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}f.exports=v},function(f,d){function v(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}f.exports=v}])})})(Hn)),Hn.exports}var zs=Us();const Rr=Ps(zs),Wn={STORAGE_KEY:"desktopOS_fileSystem"},ee={IMAGE:"image",TEXT:"text",OTHER:"other"},qn={home:{reeyuki:{Documents:{"INFO.txt":{type:"file",content:"Files you saved in notepad get saved in your browser session.",kind:ee.TEXT,icon:"/static/icons/notepad.webp"}},Pictures:{"wallpaper1.webp":{type:"file",content:"/static/wallpapers/wallpaper1.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper1.webp"},"wallpaper2.webp":{type:"file",content:"/static/wallpapers/wallpaper2.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper2.webp"},"wallpaper3.webp":{type:"file",content:"/static/wallpapers/wallpaper3.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper3.webp"},"wallpaper4.webp":{type:"file",content:"/static/wallpapers/wallpaper4.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper4.webp"},"wallpaper5.webp":{type:"file",content:"/static/wallpapers/wallpaper5.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper5.webp"},"wallpaper6.webp":{type:"file",content:"/static/wallpapers/wallpaper6.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper6.webp"},"wallpaper7.webp":{type:"file",content:"/static/wallpapers/wallpaper7.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper7.webp"},"wallpaper8.webp":{type:"file",content:"/static/wallpapers/wallpaper8.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper8.webp"},"wallpaper9.webp":{type:"file",content:"/static/wallpapers/wallpaper9.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper9.webp"},"wallpaper10.webp":{type:"file",content:"/static/wallpapers/wallpaper10.webp",kind:ee.IMAGE,icon:"/static/wallpapers/wallpaper10.webp"}},Music:{}}}};function Tr(rt,l){for(const f in rt)f in l?typeof rt[f]=="object"&&rt[f]!==null&&!Array.isArray(rt[f])&&Tr(rt[f],l[f]):l[f]=rt[f];return l}class js{constructor(){this.fsReady=this.initFS()}async initFS(){return new Promise(l=>{Rr.configure({fs:"IndexedDB",options:{}},()=>{this.fs=Rr.BFSRequire("fs"),this.loadFromStorage(),l()})})}async loadFromStorage(){if(!await this.exists(Wn.STORAGE_KEY))await this.writeFile(Wn.STORAGE_KEY,JSON.stringify(qn)),this.fileSystem=JSON.parse(JSON.stringify(qn));else{const f=await this.readFile(Wn.STORAGE_KEY),d=JSON.parse(f);this.fileSystem=Tr(qn,d),await this.saveToStorage()}}async saveToStorage(){await this.writeFile(Wn.STORAGE_KEY,JSON.stringify(this.fileSystem))}normalizePath(l){return typeof l=="string"?l.split("/").filter(f=>f):Array.isArray(l)?l.filter(f=>f):[]}getFolder(l){const f=this.normalizePath(l);let d=this.fileSystem;for(const v of f){if(!d[v])throw new Error("Invalid path");if(d[v].type==="file")throw new Error("Not a directory");d=d[v]}return d}inferKind(l){const f=l.split(".").pop().toLowerCase();return["png","jpg","jpeg","gif","webp"].includes(f)?ee.IMAGE:["txt","js","json","md","html","css"].includes(f)?ee.TEXT:ee.OTHER}async createFile(l,f,d="",v=null,g=null){await this.fsReady;const R=this.getFolder(l);if(R[f])throw new Error("Already exists");const E=v||this.inferKind(f),k=g||(E===ee.TEXT?"/static/icons/notepad.webp":"/static/icons/file.png");R[f]={type:"file",content:d,kind:E,icon:k},await this.saveToStorage()}async createFolder(l,f){await this.fsReady;const d=this.getFolder(l);if(d[f])throw new Error("Already exists");d[f]={},await this.saveToStorage()}async deleteItem(l,f){await this.fsReady;const d=this.getFolder(l);delete d[f],await this.saveToStorage()}async renameItem(l,f,d){await this.fsReady;const v=this.getFolder(l);v[d]=v[f],delete v[f],await this.saveToStorage()}async updateFile(l,f,d){await this.fsReady;const v=this.getFolder(l);if(v[f]?.type==="file")v[f].content=d;else{const g=this.inferKind(f),R=g===ee.TEXT?"/static/icons/notepad.webp":"/static/icons/file.png";v[f]={type:"file",content:d,kind:g,icon:R}}await this.saveToStorage()}getFileContent(l,f){const d=this.getFolder(l);return d[f]?.type==="file"?d[f].content:""}async getFileKind(l,f){await this.fsReady;const d=this.getFolder(l);return d[f]?.type==="file"?d[f].kind:null}async getFileIcon(l,f){await this.fsReady;const d=this.getFolder(l);return d[f]?.type==="file"?d[f].icon:null}isFile(l,f){return this.getFolder(l)[f]?.type==="file"}async writeFile(l,f){return new Promise((d,v)=>{this.fs.writeFile(l,f,g=>{g?v(g):d()})})}async readFile(l){return new Promise((f,d)=>{this.fs.readFile(l,"utf8",(v,g)=>{v?d(v):f(g)})})}async exists(l){return new Promise(f=>{this.fs.exists(l,d=>f(d))})}resolvePath(l,f=[]){const d=typeof l=="string"?l.split("/"):[];let v=l.startsWith("/")?[]:[...f];for(const g of d)!g||g==="."||(g===".."?v.pop():v.push(g));return v}}const xr="desktopOS_selectedWallpaper";class fi{static startClock(){const l=()=>{const f=new Date;document.getElementById("clock").textContent=f.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),document.getElementById("date").textContent=f.toLocaleDateString()};setInterval(l,1e3),l()}static setRandomWallpaper(){const l=qn.home.reeyuki.Pictures,f=Object.values(l).filter(v=>v.kind==="image").map(v=>v.content);if(!f.length)return;const d=f[Math.floor(Math.random()*f.length)];this.setWallpaper(d)}static setWallpaper(l){let f=document.getElementById("wallpaper-img");f||(f=document.createElement("img"),f.id="wallpaper-img",Object.assign(f.style,{position:"fixed",inset:"0",width:"100vw",height:"100vh",objectFit:"cover",zIndex:"-1",pointerEvents:"none",userSelect:"none"}),f.addEventListener("contextmenu",d=>d.preventDefault()),document.body.appendChild(f)),f.src=l,localStorage.setItem(xr,l)}static loadWallpaper(){const l=localStorage.getItem(xr);l?this.setWallpaper(l):this.setRandomWallpaper()}}const ce=document.getElementById("context-menu");class Ws{constructor(l,f,d){this.fs=l,this.wm=f,this.notepadApp=d,this.currentPath=["home","reeyuki"],this.fileSelectCallback=null,this.open=this.open.bind(this)}async open(l=null){if(this.fileSelectCallback=l,document.getElementById("explorer-win")){this.wm.bringToFront(document.getElementById("explorer-win"));return}const f=document.createElement("div");f.className="window",f.id="explorer-win",f.dataset.fullscreen="false",f.innerHTML=`
      <div class="window-header">
        <span>File Explorer</span>
        ${this.wm.getWindowControls()}
      </div>
      <div class="explorer-nav">
        <div class="back-btn" id="exp-back">← Back</div>
        <div id="exp-path" style="color:#555"></div>
      </div>
      <div class="explorer-container">
        <div class="explorer-sidebar">
          <div class="start-item" data-path="home/reeyuki/Documents">Documents</div>
          <div class="start-item" data-path="home/reeyuki/Pictures">Pictures</div>
          <div class="start-item" data-path="home/reeyuki/Music">Music</div>
        </div>
        <div class="explorer-main" id="explorer-view"></div>
      </div>
    `,Oe.appendChild(f);const d=f.querySelector("#explorer-view");d.style.width="600px",d.style.height="300px",this.wm.makeDraggable(f),this.wm.makeResizable(f),this.wm.setupWindowControls(f),setTimeout(()=>this.wm.bringToFront(f),0),this.wm.addToTaskbar(f.id,"File Explorer","/static/icons/file.png"),this.setupExplorerControls(f),await this.render()}setupExplorerControls(l){l.querySelector("#exp-back").onclick=async()=>{this.currentPath.length>1&&(this.currentPath.pop(),await this.render())},l.querySelectorAll(".explorer-sidebar .start-item").forEach(d=>{d.onclick=async()=>{const v=d.dataset.path.split("/").filter(g=>g);this.currentPath=v,await this.render()}});const f=l.querySelector("#explorer-view");f.addEventListener("contextmenu",d=>{d.target===f&&this.showBackgroundContextMenu(d)})}async renderMusicPage(l){l&&(l.innerHTML=`
      <div style="display: flex; gap: 20px; flex-wrap: wrap;">
        <iframe src="https://open.spotify.com/embed/playlist/6oK6F4LglYBr4mYLSRDJOa" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
        <iframe src="https://open.spotify.com/embed/playlist/1q7zv2ScwtR2jIxaIRj9iG" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
        <iframe src="https://open.spotify.com/embed/playlist/6q8mgrJZ5L4YxabVQoAZZf" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
      </div>
    `)}async render(){const l=document.getElementById("explorer-view"),f=document.getElementById("exp-path");if(!l)return;if(l.innerHTML="",f.textContent="/"+this.currentPath.join("/"),this.currentPath[2]==="Music"){await this.renderMusicPage(l);return}const d=this.fs.getFolder(this.currentPath);for(const[v,g]of Object.entries(d)){const R=g?.type==="file";let E;R?g.icon?E=g.icon.startsWith("/")?g.icon:`data:image/*;base64,${g.icon}`:E=g.kind===ee.IMAGE?g.content.startsWith("/")?g.content:`data:image/*;base64,${g.content}`:"/static/icons/notepad.webp":E="/static/icons/file.png";const k=document.createElement("div");k.className="file-item",k.innerHTML=`
        <img src="${E}" style="width:64px;height:64px;object-fit:cover">
        <span>${v}</span>
      `,k.ondblclick=async()=>this.openItem(v,R),k.oncontextmenu=async w=>this.showFileContextMenu(w,v,R),l.appendChild(k)}}async openItem(l,f){if(f){if(this.fileSelectCallback){this.fileSelectCallback(this.currentPath,l),this.fileSelectCallback=null;return}const d=await this.fs.getFileContent(this.currentPath,l);await this.fs.getFileKind(this.currentPath,l)===ee.IMAGE?this.openImageViewer(l,d):this.notepadApp.open(l,d,this.currentPath)}else this.currentPath.push(l),await this.render()}openImageViewer(l,f){const d=document.createElement("div");d.className="window",Object.assign(d.style,{width:"500px",height:"400px",left:"150px",top:"150px",zIndex:2e3}),d.innerHTML=`
      <div class="window-header">
        <span>${l}</span>
        ${this.wm.getWindowControls()}
      </div>
      <div style="display:flex;justify-content:center;align-items:center;height:calc(100% - 30px);background:#222">
        <img src="${f}" style="max-width:100%; max-height:100%">
      </div>
    `,Oe.appendChild(d),this.wm.makeDraggable(d),this.wm.makeResizable(d),this.wm.setupWindowControls(d),this.wm.addToTaskbar(d.id,l,"/static/icons/file.png")}async showFileContextMenu(l,f,d){l.preventDefault(),l.stopPropagation(),ce.innerHTML="";const v=(w,m)=>{const a=document.createElement("div");return a.textContent=w,a.onclick=()=>m(),a},g=d?"Open":"Open Folder",R=async()=>{ce.style.display="none",await this.openItem(f,d)};ce.appendChild(v(g,R)),d&&(ce.appendChild(document.createElement("hr")),ce.appendChild(v("Delete",async()=>{ce.style.display="none",await this.fs.deleteItem(this.currentPath,f),await this.render()})),ce.appendChild(v("Rename",async()=>{ce.style.display="none";const w=prompt("Enter new name:",f);w&&w!==f&&(await this.fs.renameItem(this.currentPath,f,w),await this.render())})));const E=d?await this.fs.getFileKind(this.currentPath,f):null,k=d?await this.fs.getFileContent(this.currentPath,f):null;E===ee.IMAGE&&ce.appendChild(v("Set Wallpaper",()=>{ce.style.display="none",fi.setWallpaper(k)})),ce.appendChild(v("Properties",()=>{ce.style.display="none",this.wm.showPopup(`Name: ${f}
Type: ${d?"File":"Folder"}`)})),Object.assign(ce.style,{left:`${l.pageX}px`,top:`${l.pageY}px`,display:"block"})}showBackgroundContextMenu(l){l.preventDefault(),l.stopPropagation(),ce.innerHTML=`
      <div id="ctx-new-file">New File</div>
      <div id="ctx-new-folder">New Folder</div>
      <hr>
      <div id="ctx-refresh">Refresh</div>
    `;const f=(d,v)=>{document.getElementById(d).onclick=async()=>{ce.style.display="none",await v()}};f("ctx-new-file",async()=>{const d=prompt("Enter file name:","NewFile.txt");d&&(await this.fs.createFile(this.currentPath,d),await this.render())}),f("ctx-new-folder",async()=>{const d=prompt("Enter folder name:","NewFolder");d&&(await this.fs.createFolder(this.currentPath,d),await this.render())}),f("ctx-refresh",async()=>await this.render()),Object.assign(ce.style,{left:`${l.pageX}px`,top:`${l.pageY}px`,display:"block"})}}const bn=document.getElementById("window-style");let Fr=bn.parentNode;function Hs(){bn.parentNode&&Fr.removeChild(bn)}function qs(){bn.parentNode||Fr.appendChild(bn)}class Gs{constructor(){this.openWindows=new Map,this.zIndexCounter=1e3,this.gameWindowCount=0}updateTransparency(){this.gameWindowCount>0?Hs():qs()}createWindow(l,f,d="80vw",v="80vh",g=!1){const R=document.createElement("div");R.className="window",R.id=l,R.dataset.fullscreen="false";const E=d!=null?String(d):"80vw",k=v!=null?String(v):"80vh",w=E.includes("vw")?window.innerWidth*parseFloat(E)/100:parseInt(E),m=k.includes("vh")?window.innerHeight*parseFloat(k)/100:parseInt(k);return Object.assign(R.style,{width:`${w}px`,height:`${m}px`,left:`${(window.innerWidth-w)/2}px`,top:`${(window.innerHeight-m)/2}px`,position:"absolute",zIndex:this.zIndexCounter++}),g&&this.gameWindowCount++,this.updateTransparency(),R}addToTaskbar(l,f,d){if(document.getElementById(`taskbar-${l}`))return;const v=document.createElement("div");if(v.id=`taskbar-${l}`,v.className="taskbar-item",d){const E=document.createElement("img");E.src=d,v.appendChild(E)}const g=document.createElement("span");g.textContent=f,v.appendChild(g),v.onclick=()=>{const E=document.getElementById(l);E&&(E.style.display==="none"?(E.style.display="block",v.classList.add("active")):this.bringToFront(E))},v.oncontextmenu=E=>{E.preventDefault();const k=document.getElementById("taskbar-context-menu");k&&k.remove();const w=document.createElement("div");w.id="taskbar-context-menu",w.className="kde-menu";const m=document.getElementById(l),a=(L,O)=>{const C=document.createElement("div");C.textContent=L,C.className="kde-item",C.onclick=()=>{O(),w.remove()},w.appendChild(C)};a(m.style.display==="none"?"Restore":"Minimize",()=>{m.style.display==="none"?m.style.display="block":this.minimizeWindow(m),this.bringToFront(m)}),a(m.dataset.fullscreen==="true"?"Restore Size":"Maximize",()=>{this.toggleFullscreen(m),this.bringToFront(m)}),a("Bring to Front",()=>this.bringToFront(m)),a("Properties",()=>{const L=this.openWindows.get(l);if(!L)return;const O=document.getElementById(l);if(!O)return;const C=O.dataset,A=O.getBoundingClientRect(),B=[`Window ID: ${l}`,`Title: ${L.title}`,C.appType?`Type: ${C.appType}`:"",C.appId?`App ID: ${C.appId}`:"",C.swf?`SWF Path: ${C.swf}`:"",C.rom?`ROM: ${C.rom}`:"",C.core?`Core: ${C.core}`:"",C.externalUrl?`URL: ${C.externalUrl}`:"",`Width: ${Math.round(A.width)}px`,`Height: ${Math.round(A.height)}px`,`Left: ${Math.round(A.left)}px`,`Top: ${Math.round(A.top)}px`,`Z-Index: ${O.style.zIndex}`,`Fullscreen: ${C.fullscreen==="true"?"Yes":"No"}`].filter(Boolean).map(St=>`<div style="margin:2px 0;">${St}</div>`).join(""),H=this.createWindow(`${l}-props`,`Properties: ${L.title}`,"40vw","40vh");H.innerHTML=`
          <div class="window-header">
            <span>Properties: ${L.title}</span>
            ${this.wm.getWindowControls()}
          </div>
          <div class="window-content" style="width:100%; height:100%; overflow:auto; user-select:text;">
            ${B}
          </div>
        `,Oe.appendChild(H),this.makeDraggable(H),this.makeResizable(H),this.setupWindowControls(H)}),a("Close Window",()=>{this.removeFromTaskbar(l),m&&m.remove()}),document.body.appendChild(w);const b=w.getBoundingClientRect();let u=E.pageX,N=window.innerHeight-E.pageY;u+b.width>window.innerWidth&&(u=window.innerWidth-b.width-10),N+b.height>window.innerHeight&&(N=10),w.style.setProperty("--ctx-left",`${u}px`),w.style.setProperty("--ctx-bottom",`${N}px`),document.addEventListener("click",function L(){w.remove(),document.removeEventListener("click",L)})},document.getElementById("taskbar-windows").appendChild(v),this.openWindows.set(l,{taskbarItem:v,title:f})}registerCloseWindow(l,f){l.addEventListener("click",()=>{const d=document.getElementById(f);if(d)d.remove();else return;this.removeFromTaskbar(f)})}removeFromTaskbar(l){const f=document.getElementById(`taskbar-${l}`);f&&f.remove(),this.openWindows.delete(l)}bringToFront(l){l&&(l.style.zIndex=this.zIndexCounter++)}minimizeWindow(l){l.style.display="none";const f=document.getElementById(`taskbar-${l.id}`);f&&(f.style.background="#1a1a1a")}toggleFullscreen(l){const f=l.dataset.fullscreen==="true",d=l.querySelector(".window-header");if(f)document.fullscreenElement===l&&document.exitFullscreen(),Object.assign(l.style,{width:l.dataset.prevWidth,height:l.dataset.prevHeight,left:l.dataset.prevLeft,top:l.dataset.prevTop}),d&&(d.style.display=""),l.dataset.fullscreen="false";else{Object.assign(l.dataset,{prevWidth:l.style.width,prevHeight:l.style.height,prevLeft:l.style.left,prevTop:l.style.top});const v=()=>{Object.assign(l.style,{width:"100vw",height:"100vh",left:"0",top:"0"}),d&&(d.style.display="none")};l.requestFullscreen?l.requestFullscreen().then(v).catch(v):v(),l.dataset.fullscreen="true";const g=()=>{document.fullscreenElement||(d&&(d.style.display=""),l.dataset.fullscreen="false",document.removeEventListener("fullscreenchange",g))};document.addEventListener("fullscreenchange",g)}}setupWindowControls(l){l.querySelector(".close-btn").onclick=()=>{this.removeFromTaskbar(l.id),l.remove(),l.dataset.isGame==="true"&&(this.gameWindowCount=Math.max(0,this.gameWindowCount-1)),this.updateTransparency()},l.querySelector(".minimize-btn").onclick=()=>this.minimizeWindow(l),l.querySelector(".maximize-btn").onclick=()=>this.toggleFullscreen(l);const f=l.querySelector(".close-btn");f&&this.registerCloseWindow(f),l.addEventListener("mousedown",()=>this.bringToFront(l))}makeDraggable(l){const f=l.querySelector(".window-header");f.onmousedown=d=>{if(d.target.tagName==="BUTTON")return;const v=d.clientX-l.offsetLeft,g=d.clientY-l.offsetTop;document.onmousemove=R=>{l.style.left=`${R.clientX-v}px`,l.style.top=`${R.clientY-g}px`},document.onmouseup=()=>document.onmousemove=null}}makeResizable(l){const d=v=>{const g=l.getBoundingClientRect();let R="";return v.clientY-g.top<10?R+="n":g.bottom-v.clientY<10&&(R+="s"),v.clientX-g.left<10?R+="w":g.right-v.clientX<10&&(R+="e"),R};l.addEventListener("mousemove",v=>{const g=d(v),R={n:"n-resize",s:"s-resize",w:"w-resize",e:"e-resize",nw:"nw-resize",ne:"ne-resize",sw:"sw-resize",se:"se-resize","":"default"};l.style.cursor=R[g]||"default"}),l.addEventListener("mousedown",v=>{const g=d(v);if(!g)return;v.preventDefault();const R=v.clientX,E=v.clientY,k=l.getBoundingClientRect(),w=k.width,m=k.height,a=k.left,b=k.top,u=L=>{let O=w,C=m,A=a,J=b;g.includes("e")&&(O=w+(L.clientX-R)),g.includes("s")&&(C=m+(L.clientY-E)),g.includes("w")&&(O=w-(L.clientX-R),A=a+(L.clientX-R)),g.includes("n")&&(C=m-(L.clientY-E),J=b+(L.clientY-E));const B=300;O>B&&(l.style.width=`${O}px`,l.style.left=`${A}px`),C>B&&(l.style.height=`${C}px`,l.style.top=`${J}px`)},N=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",N)};document.addEventListener("mousemove",u),document.addEventListener("mouseup",N)})}getWindowControls(){return`<div class="window-controls">
              <button class="minimize-btn" title="Minimize">−</button>
              <button class="maximize-btn" title="Maximize">□</button>
              <button class="close-btn" title="Close">X</button>
            </div>
    `}showPopup(l){const f=document.createElement("div");f.textContent=l,Object.assign(f.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"20px 40px",backgroundColor:"rgba(0,0,0,0.8)",color:"#fff",fontSize:"18px",borderRadius:"10px",textAlign:"center",zIndex:9999,cursor:"pointer",boxShadow:"0 4px 15px rgba(0,0,0,0.3)"}),f.addEventListener("click",()=>{f.remove()}),document.body.appendChild(f)}}class Xs{constructor(l){this.wm=l,this.history=[],this.historyIndex=-1,this.currentURL="https://www.google.com/webhp?igu=1"}open(){if(document.getElementById("browser-win")){this.wm.bringToFront(document.getElementById("browser-win"));return}const l=document.createElement("div");l.className="window",l.id="browser-win",l.dataset.fullscreen="false",l.innerHTML=`
      <div class="window-header">
        <span>Browser</span>
        <div class="window-controls">
          <button class="minimize-btn" title="Minimize">−</button>
          <button class="maximize-btn" title="Maximize">□</button>
          <button class="close-btn" title="Close">X</button>
        </div>
      </div>
      <nav class="browser-nav">
        <div>
          <button id="back-btn" disabled aria-label="Click to go back" title="Click to go back">
            ←
          </button>
          <button id="forward-btn" disabled aria-label="Click to go forward" title="Click to go forward">
            →
          </button>
          <button id="reload-btn" aria-label="Reload this page" title="Reload this page">
            ⟳
          </button>
        </div>
        <input id="address-bar" type="url" value="${this.currentURL}" aria-label="Address" enterkeyhint="go">
      </nav>
      <nav class="bookmark-bar">
      <button data-url="https://www.google.com/webhp?igu=1">Google</button>
      <button data-url="https://reeyuki.github.io">Reeyuki Site</button>
      <button data-url="https://liventcord.github.io">LiventCord</button>
      <button data-url="https://www.wikipedia.org">Wikipedia</button>
      <button data-url="https://www.mixconvert.com">Mix Convert</button>
      <button data-url="https://dustinbrett.com/Program%20Files/Browser/dino/index.html">T-Rex Dino</button>
      <button onclick="window.open('https://dn721809.ca.archive.org/0/items/youtube-xvFZjo5PgG0/xvFZjo5PgG0.mp4','_blank')">Click me</button>
      <button data-url="https://bluemaxima.org/flashpoint">Flashpoint Archive</button>
      <button data-url="https://jsfiddle.net">JS Fiddle</button>
      <a href="https://emupedia.net/beta/emuos/">EmuOS</a>
      </nav>
      <iframe id="browser-frame" src="${this.currentURL}" style="width:100%;height:calc(100% - 88px);border:none"></iframe>
    `,Oe.appendChild(l),this.wm.makeDraggable(l),this.wm.makeResizable(l),this.wm.setupWindowControls(l),this.wm.addToTaskbar(l.id,"Browser","/static/icons/chromium.webp"),l.querySelector(".close-btn").onclick=()=>l.remove(),this.frame=l.querySelector("#browser-frame"),this.addressInput=l.querySelector("#address-bar"),this.backBtn=l.querySelector("#back-btn"),this.forwardBtn=l.querySelector("#forward-btn"),this.reloadBtn=l.querySelector("#reload-btn"),l.style.width="70vw",l.style.height="70vh",l.style.left="15vw",l.style.top="15vh",this.setupControls(l)}setupControls(l){this.backBtn.onclick=()=>this.goBack(),this.forwardBtn.onclick=()=>this.goForward(),this.reloadBtn.onclick=()=>this.frame.src=this.currentURL,this.addressInput.addEventListener("keydown",f=>{f.key==="Enter"&&this.navigate(this.addressInput.value)}),l.querySelectorAll(".bookmark-bar button").forEach(f=>{f.addEventListener("click",()=>{this.navigate(f.dataset.url)})})}navigate(l){if(!l){console.error("No url found");return}!l.startsWith("http")&&!l.startsWith("chrome")&&(l="https://"+l),this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.push(l),this.historyIndex++,this.updateNavigation()}goBack(){this.historyIndex>0&&(this.historyIndex--,this.updateNavigation())}goForward(){this.historyIndex<this.history.length-1&&(this.historyIndex++,this.updateNavigation())}updateNavigation(){this.currentURL=this.history[this.historyIndex],this.frame.src=this.currentURL,this.addressInput.value=this.currentURL,this.backBtn.disabled=this.historyIndex<=0,this.forwardBtn.disabled=this.historyIndex>=this.history.length-1}}const Or="kdeFavorites";function un(){return JSON.parse(localStorage.getItem(Or))||[]}function Nr(rt){localStorage.setItem(Or,JSON.stringify(rt))}function Ys(rt){let l=un();l.includes(rt)||(l.push(rt),Nr(l),hi(),Cr(rt,!0))}function Zs(rt){let l=un();l=l.filter(f=>f!==rt),Nr(l),hi(),Cr(rt,!1)}function Dr(rt){const l=document.createElement("span");return l.textContent="★",l.className="star",l.style.color=un().includes(rt)?"gold":"#ccc",l.addEventListener("click",f=>{f.stopPropagation(),un().includes(rt)?Zs(rt):Ys(rt)}),l.dataset.app=rt,l}function Cr(rt,l){document.querySelectorAll(`.kde-item[data-app="${rt}"] span`).forEach(d=>{d.textContent==="★"&&(d.style.color=l?"gold":"#ccc")});const f=document.querySelector(`.kde-item[data-app="${rt}"]`);f&&(f.style.background=l?"rgba(255, 215, 0, 0.1)":"transparent")}function hi(rt){if(!rt){console.error("No app launcher");return}const l=document.querySelector('.kde-page[data-page="favorites"]');l.innerHTML="";const f=un();if(f.length===0){const d=document.createElement("div");d.textContent="No favorite apps",d.style.padding="10px",d.style.color="#888",l.appendChild(d);return}f.forEach(d=>{const v=document.querySelector(`.kde-item[data-app="${d}"]`);if(!v)return;const g=v.cloneNode(!0);g.style.position="relative",g.style.background="rgba(255, 215, 0, 0.1)",g.onclick=()=>rt.launch(d);const R=g.querySelector(".star");R&&R.remove(),g.appendChild(Dr(d)),l.appendChild(g)})}function Vs(){document.querySelectorAll(".kde-page:not([data-page='favorites']) .kde-item").forEach(rt=>{const l=rt.dataset.app;rt.style.position="relative";const f=Dr(l);f.style.opacity="0",f.style.transition="opacity 0.2s",rt.appendChild(f),rt.addEventListener("mouseenter",()=>f.style.opacity="1"),rt.addEventListener("mouseleave",()=>f.style.opacity="0"),un().includes(l)&&(rt.style.background="rgba(255, 215, 0, 0.1)")})}function Ks(){document.querySelectorAll(".kde-cat").forEach(rt=>{rt.onclick=()=>{document.querySelectorAll(".kde-cat").forEach(l=>l.classList.remove("active")),document.querySelectorAll(".kde-page").forEach(l=>l.classList.remove("active")),rt.classList.add("active"),document.querySelector(`.kde-page[data-page="${rt.dataset.cat}"]`).classList.add("active")}}),document.getElementById("kde-search").addEventListener("input",rt=>{const l=rt.target.value.toLowerCase();document.querySelectorAll(".kde-item").forEach(f=>{f.style.display=f.textContent.toLowerCase().includes(l)?"":"none"})}),Vs()}function Js(rt){return rt.replace(/(?:^\w|[A-Z]|\b\w)/g,function(l,f){return f===0?l.toLowerCase():l.toUpperCase()}).replace(/\s+/g,"")}function Ar(rt){if(rt=Js(rt),rt==="explorer")return"/static/icons/file.png";if(rt==="computer")return"/static/icons/pc.webp";try{return document.querySelector(`#desktop div[data-app="${rt}"]`)?.querySelector("img")?.src||null}catch(l){return console.error(l),null}}function Qs(rt){const l={system:document.querySelector('.kde-page[data-page="system"]'),apps:document.querySelector('.kde-page[data-page="apps"]'),games:document.querySelector('.kde-page[data-page="games"]'),favorites:document.querySelector('.kde-page[data-page="favorites"]')};["system","apps","games"].forEach(f=>{l[f]&&(l[f].innerHTML="")}),Object.entries(rt.appMap).forEach(([f,d])=>{const v=document.createElement("div");v.classList.add("kde-item"),v.dataset.app=f;const g=Ar(f),R=document.createElement("img");R.classList.add("kde-item-icon"),g?(R.src=g,R.alt=""):R.style.display="none";const E=f.charAt(0).toUpperCase()+f.slice(1),k=document.createElement("span");k.textContent=E,v.appendChild(R),v.appendChild(k),v.addEventListener("click",()=>rt.launch(f)),d.type==="system"?l.system?.appendChild(v):d.type==="game"||d.type==="swf"?l.games?.appendChild(v):l.apps?.appendChild(v)})}class $s{constructor(l,f,d,v,g,R,E,k){this.wm=l,this.fs=f,this.musicPlayer=d,this.explorerApp=v,this.terminalApp=g,this.notepadApp=R,this.browserApp=E,this.cameraApp=k,this.pageLoadTime=Date.now(),this.TRANSPARENCY_ALLOWED_APP_IDS=new Set(["paint","vscode","liventcord"]);const w=this._getAnalyticsBase("hit-page");this.sendAnalytics({...w,event:"start"}),this.appMap={return:{type:"system",action:()=>window.location.href="/"},explorer:{type:"system",action:()=>this.explorerApp.open()},computer:{type:"system",action:()=>this.explorerApp.open()},terminal:{type:"system",action:()=>this.terminalApp.open()},notepad:{type:"system",action:()=>this.notepadApp.open()},browser:{type:"system",action:()=>this.browserApp.open()},cameraApp:{type:"system",action:()=>this.cameraApp.open()},music:{type:"system",action:()=>this.musicPlayer.open(this.wm)},photopea:{type:"game",url:"https://www.photopea.com"},sonic:{type:"swf",swf:"/static/games/swfGames/sonic.swf"},flight:{type:"swf",swf:"/static/games/swfGames/flight.swf"},swarmQueen:{type:"swf",swf:"/static/games/swfGames/swarmQueen.swf"},paint:{type:"game",url:"https://paint.js.org/"},pacman:{type:"game",url:"https://pacman-e281c.firebaseapp.com"},pvz:{type:"game",url:"https://emupedia.net/emupedia-game-pvz"},pvz2:{type:"remote",url:"https://play.pvzge.com"},pvzHybrid:{type:"remote",url:"https://www.miniplay.com/embed/plants-vs-zombies-hybrid-story"},tetris:{type:"game",url:"https://turbowarp.org/embed.html?autoplay#31651654"},roads:{type:"game",url:"https://slowroads.io"},vscode:{type:"game",url:"https://emupedia.net/emupedia-app-vscode"},isaac:{type:"game",url:"https://emupedia.net/emupedia-game-binding-of-isaac"},mario:{type:"game",url:"https://emupedia.net/emupedia-game-mario"},papaGames:{type:"game",url:"https://papasgamesfree.io"},zombieTd:{type:"swf",swf:"/static/games/swfGames/zombietd.swf"},zombotron:{type:"swf",swf:"/static/games/zombotron/zombotron.swf"},zombotron2:{type:"swf",swf:"/static/games/zombotron/zombotron2.swf"},zombotron2Time:{type:"game",url:"/static/rfiv.html?game=zombotron"},breach:{type:"swf",swf:"/static/games/swfGames/breach.swf"},fancyPants:{type:"swf",swf:"/static/games/swfGames/fancypantsadventure.swf"},fancyPants2:{type:"swf",swf:"/static/games/swfGames/fancypantsadventure2.swf"},fancyPants3:{type:"swf",swf:"/static/games/swfGames/fancypantsadventure3.swf"},strikeForce:{type:"swf",swf:"https://cache.armorgames.com/files/games/strikeforce-kitty-16008.swf?v=1404201513"},strikeForce2:{type:"swf",swf:"https://cache.armorgames.com/files/games/strikeforce-kitty-2-17643.swf?v=1423725280"},baloonsTd5:{type:"swf",swf:"/static/games/swfGames/baloonstd5.swf"},baloonsTd6:{type:"swf",swf:"https://truffled.lol/iframe.html?url=%2Fgames%2Fbtd6%2Findex.html"},trinitas:{type:"game",url:"/static/games/trinitas"},jojo:{type:"game",url:"https://www.retrogames.cc/embed/8843-jojos-bizarre-adventure%3A-heritage-for-the-future-jojo-no-kimyou-na-bouken%3A-mirai-e-no-isan-japan-990927-no-cd.html"},gtaVc:{type:"game",url:"/static/vciframe.html"},subwaySurfers:{type:"game",url:"https://g.igroutka.ru/games/164/Xm2W5MIcPqrF1Y90/12/subway_surfers_easter_edinburgh"},mutantFighting:{type:"swf",swf:"https://cache.armorgames.com/files/games/mutant-fighting-cup-14425.swf?v=1373587528"},mutantFighting2:{type:"swf",swf:"/static/games/swfGames/mutantfightingcup2.swf"},finnAndBones:{type:"game",url:"/static/flashpointarchive.html?fpGameName=finnAndBones"},obama:{type:"game",url:"/static/flashpointarchive.html?fpGameName=obama-alien-defense"},intrusion2:{type:"swf",swf:"/static/games/swfGames/intrusion2.swf"},dan:{type:"game",url:"https://www.silvergames.com/en/dan-the-man/gameframe"},infectonator:{type:"swf",swf:"https://cache.armorgames.com/files/games/infectonator-5020.swf?v=1373587522"},infectonator2:{type:"swf",swf:"https://cache.armorgames.com/files/games/infectonator-2-13150.swf?v=1373587527"},newyorkShark:{type:"swf",swf:"https://cache.armorgames.com/files/games/new-york-shark-12969.swf?v=1373587527"},swordsSouls:{type:"swf",swf:"https://cache.armorgames.com/files/games/swordssouls-17817.swf?v=1464609285"},corporationInc:{type:"swf",swf:"https://cache.armorgames.com/files/games/corporation-inc-7348.swf?v=1373587524"},aground:{type:"game",url:"https://cache.armorgames.com/files/games/aground-18245/index.html?v=1591832301"},mobyDick:{type:"swf",swf:"https://cache.armorgames.com/files/games/moby-dick-the-video--7199.swf?v=1373587524"},mobyDick2:{type:"swf",swf:"https://cache.armorgames.com/files/games/moby-dick-2-12662.swf?v=1373587526"},elfStory:{type:"swf",swf:"https://cache.armorgames.com/files/games/elf-story-14680.swf?v=1373587528"},frogDares:{type:"swf",swf:"https://cache.armorgames.com/files/games/frog-dares-12672.swf?v=1373587526"},kamikazePigs:{type:"swf",swf:"https://cache.armorgames.com/files/games/kamikaze-pigs-13545.swf?v=1373587527"},icyFishes:{type:"swf",swf:"https://cache.armorgames.com/files/games/icy-fishes-12977.swf?v=1373587527"},feedUs6:{type:"swf",swf:"/static/games/swfGames/feeduslostisland.swf"},superrobotwar:{type:"game",url:"/static/flashpointarchive.html?fpGameName=super-robot-war"},feedUsPirates:{type:"swf",swf:"/static/games/swfGames/feeduspirates.swf"},epicbossfighter2:{type:"swf",swf:"/static/games/swfGames/EpicBossFighter2.swf"},avatarFortressFight2:{type:"swf",swf:"/static/games/swfGames/avatarFortressFight2.swf"},incredibles:{type:"swf",swf:"/static/games/swfGames/incredibles.swf"},cactusMcCoy:{type:"game",url:"https://papasgamesfree.io/cactus-mccoy-1"},jackSmith:{type:"game",url:"https://papasgamesfree.io/jacksmith"},pokemonRed:{type:"gba",url:"pokemon-red.gba"},pokemonEmerald:{type:"gba",url:"pokemon-emerald.gba"},pokemonPlatinum:{type:"nds",url:"pokemon-platinum.nds"},pokemonHeartgold:{type:"nds",url:"pokemon-heartgold.nds"},pokemonWhite:{type:"nds",url:"pokemon-white.nds"},pokemonWhite2:{type:"nds",url:"pokemon-white-2.zip"},minecraft:{type:"remote",url:"https://eaglercraft.com/play"},liventcord:{type:"game",url:"https://liventcord.github.io"},fnaf:{type:"game",url:"/static/games/fnaf"},geometryDash:{type:"game",url:"https://emupedia.net/emupedia-game-geometry-dash"},cutTheRope:{type:"game",url:"https://emupedia.net/emupedia-game-cut-the-rope2"},game2048:{type:"game",url:"https://emupedia.net/emupedia-game-2048"},pinball:{type:"game",url:"https://emupedia.net/emupedia-game-space-cadet-pinball"},flappyBird:{type:"game",url:"https://emupedia.net/emupedia-game-flappy-bird"},jetpack:{type:"game",url:"https://emupedia.net/emupedia-game-jetpack-joyride"},happyWheels:{type:"game",url:"https://emupedia.net/emupedia-game-happy-wheels/flash"},fistPunch:{type:"game",url:"/static/flashpointarchive.html?fpGameName=fistPunch"},hollowKnight:{type:"game",url:"/static/hollowknight.html"},slimeRancher:{type:"game",url:"https://dev.snubby.top"},kindergarten:{type:"game",url:"https://truffled.lol/games/kindergarten/1/index.html"},kindergarten2:{type:"game",url:"https://truffled.lol/games/kindergarten/2/index.html"},cuphead:{type:"game",url:"https://truffled.lol/games/Cuphead/index.html"},raft:{type:"game",url:"https://truffled.lol/games/raft/index.html"},celeste:{type:"game",url:"https://truffled.lol/games/celeste/index.html"},terraria:{type:"game",url:"https://truffled.lol/games/terraria/terraria-wrapper.html"},yandereSim:{type:"game",url:"https://truffled.lol/gamefile/yandere.html"},undertale:{type:"game",url:"https://truffled.lol/games/bts"},balatro:{type:"game",url:"https://truffled.lol/games/balatro/index.html"},granny:{type:"game",url:"https://truffled.lol/gamefile/Granny.html"},bendy:{type:"game",url:"https://truffled.lol/games/BATIM/BATIM/index.html"},tattletail:{type:"game",url:"https://truffled.lol/games/tattletail/index.html"}},Qs(this)}launch(l){const f=this.appMap[l];if(!f){console.error(`App ${l} not found.`);return}console.log("Starting app : ",l);const d=this._getAnalyticsBase(l);this.sendAnalytics({...d,event:"launch"}),{system:()=>f.action(),swf:()=>this.openRuffleApp(l,f.swf,d),gba:()=>this.openEmulatorApp(l,f.url,"gba",d),nds:()=>this.openEmulatorApp(l,f.url,"nds",d),game:()=>this.openGameApp(l,f.url,d),html:()=>this.openHtmlApp(l,f.html,d,f),remote:()=>this.openRemoteApp(f.url)}[f.type]?.()}_getAnalyticsBase(l){let f="Unknown";try{const k=document.createElement("canvas"),w=k.getContext("webgl")||k.getContext("experimental-webgl");if(w){const m=w.getExtension("WEBGL_debug_renderer_info");f=m?w.getParameter(m.UNMASKED_RENDERER_WEBGL):w.getParameter(w.RENDERER)}}catch(k){console.error(k)}const d=Date.now()-this.pageLoadTime,v=Math.floor(d/36e5),g=Math.floor(d%36e5/6e4),R=`${v}h, ${g}m`,E=/Brave\//.test(navigator.userAgent)||window.navigator.brave&&typeof window.navigator.brave.isBrave=="function";return{app:l,timestamp:Date.now(),browser:{userAgent:navigator.userAgent,isBrave:E,language:navigator.language,platform:navigator.platform,screenWidth:window.screen.width,screenHeight:window.screen.height,uptime:R,gpu:f,ram:navigator.deviceMemory?`${navigator.deviceMemory} GB`:"Unknown",cpuCores:navigator.hardwareConcurrency||"Unknown",dnt:navigator.doNotTrack==="1"||window.doNotTrack==="1"?"Enabled":"Disabled"}}}sendAnalytics(l){window.location.hostname!=="localhost"&&fetch("https://analytics.liventcord-a60.workers.dev/analytics",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})}recordUsage(l,f){const d=Date.now(),v=document.getElementById(l),g=()=>{const R=Date.now()-d;this.sendAnalytics({...f,event:"usage",durationMs:R})};v.querySelector(".close-btn").addEventListener("click",g),v.addEventListener("blur",g)}openRemoteApp(l){const f=this._getAnalyticsBase(l);this.sendAnalytics({...f,event:"launch"}),window.open(l,"_blank","noopener,noreferrer")}openHtmlApp(l,f,d){if(document.getElementById(`${l}-win`)){this.wm.bringToFront(document.getElementById(`${l}-win`));return}this.createWindow(l,l.replace(/([A-Z])/g," $1").replace(/^./,v=>v.toUpperCase()),f,null,l,d)}openRuffleApp(l,f){if(!f)return;const d=document.querySelector(`[data-app="${l}"] div`);d&&(l=d.textContent);const v=f.replace(/[^a-zA-Z0-9]/g,"");if(document.getElementById(`${v}-win`)){this.wm.bringToFront(document.getElementById(`${v}-win`));return}const g=`<embed src="${f}" width="100%" height="100%">`;this.createWindow(v,l.toUpperCase(),g,null,l,{type:"swf",swf:f})}openEmulatorApp(l,f,d){const v=document.querySelector(`[data-app="${l}"] div`);v&&(l=v.textContent);const g=`${d}-${f.replace(/\W/g,"")}-${Date.now()}`;if(document.getElementById(g)){this.wm.bringToFront(document.getElementById(g));return}const R=`/static/emulatorjs.html?rom=${encodeURIComponent(f)}&core=${encodeURIComponent(d)}&color=%230064ff`,E=`<iframe src="${R}" style="width:100%; height:100%; border:none;" allow="autoplay; fullscreen; clipboard-write; encrypted-media; picture-in-picture" sandbox="allow-forms allow-downloads allow-modals allow-pointer-lock allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation"></iframe>`;this.createWindow(g,l,E,R,l,{type:d,rom:f,core:d})}openGameApp(l,f){let d;const v=document.querySelector(`[data-app="${l}"] div`);if(v&&(d=v.textContent),document.getElementById(`${l}-win`)){this.wm.bringToFront(document.getElementById(`${l}-win`));return}const g=`<iframe src="${f}" style="width:100%; height:100%; border:none;" allow="autoplay; fullscreen; clipboard-write; encrypted-media; picture-in-picture" sandbox="allow-forms allow-downloads allow-modals allow-pointer-lock allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation"></iframe>`;this.createWindow(l,d,g,f,l,{type:"game"})}isTransparencyBlocked(l,f){return!(f.type==="system"||this.TRANSPARENCY_ALLOWED_APP_IDS.has(l))}createWindow(l,f,d,v=null,g=null,R={}){const E=this.isTransparencyBlocked(g,R),k=this.wm.createWindow(`${l}-win`,f,"80vw","80vh",E);k.dataset.appType=R.type||"",k.dataset.externalUrl=v||"",k.dataset.appId=g||"",k.dataset.swf=R.swf||"",k.dataset.isGame=E,k.dataset.rom=R.rom||"",k.dataset.core=R.core||"",console.log(`Id: ${l}, ${g}, appMeta ${R.toString()}, title: ${f}`),k.innerHTML=`
      <div class="window-header">
        <span>${f}</span>
        <div class="window-controls">
          <button class="minimize-btn" title="Minimize">−</button>
          ${v?'<button class="external-btn" title="Open in External">↗</button>':""}
          <button class="maximize-btn" title="Maximize">□</button>
          <button class="close-btn" title="Close">X</button>
        </div>
      </div>
      <div class="window-content" style="width:100%; height:100%;">
        ${d}
      </div>
    `,Oe.appendChild(k),this.wm.makeDraggable(k),this.wm.makeResizable(k),this.wm.setupWindowControls(k),this.wm.bringToFront(k),v&&k.querySelector(".external-btn").addEventListener("click",()=>this.openRemoteApp(v));const w=Ar(g||l);this.wm.addToTaskbar(k.id,f,w),this.recordUsage(`${l}-win`)}}class ta{constructor(l,f){this.fs=l,this.wm=f}setExplorer(l){this.explorerApp=l}open(l="Untitled",f="",d=null){const v=`notepad-${l.replace(/\s/g,"")}`;if(document.getElementById(v)){this.wm.bringToFront(document.getElementById(v));return}const g=this.wm.createWindow(v,`${l} - Notepad`,"600px","400px");Object.assign(g.style,{left:"250px",top:"150px"}),g.innerHTML=`
      <div class="window-header">
        <span>${l} - Notepad</span>
        <div class="window-controls">
          <button class="minimize-btn" title="Minimize">−</button>
          <button class="maximize-btn" title="Maximize">□</button>
          <button class="close-btn" title="Close">X</button>
        </div>
      </div>
      <div class="notepad-menu">
        <button class="notepad-btn" data-action="save">Save</button>
        <button class="notepad-btn" data-action="saveAs">Save As</button>
        <button class="notepad-btn" data-action="open">Open</button>
      </div>
      <div class="window-content">
        <textarea class="notepad-textarea" style="width:100%; height:calc(100% - 40px); border:none; padding:10px; font-family:monospace;">${f}</textarea>
      </div>
    `,Oe.appendChild(g),this.wm.makeDraggable(g),this.wm.makeResizable(g),this.wm.setupWindowControls(g),this.wm.addToTaskbar(g.id,`${l} - Notepad`,"/static/icons/music.png"),this.setupNotepadControls(g,l,d)}setupNotepadControls(l,f,d){const v=l.querySelector(".notepad-textarea");l.querySelectorAll(".notepad-btn").forEach(R=>{R.onclick=()=>{const E=R.dataset.action;E==="save"?this.saveFile(l,v,f,d):E==="saveAs"?this.saveAsFile(v):E==="open"&&this.openFileDialog()}})}saveFile(l,f,d,v){if(!v){this.saveAsFile(f);return}const g=f.value;this.fs.updateFile(v,d,g),alert(`File saved: ${d}`)}saveAsFile(l){const f=prompt("Enter file name:","NewFile.txt");if(!f)return;const d=prompt("Enter path (e.g., home/reeyuki/Documents):","home/reeyuki/Documents");if(!d)return;const v=d.split("/").filter(R=>R),g=l.value;try{this.fs.createFile(v,f,g),alert(`File saved: ${f} at /${d}`)}catch(R){console.error(R),alert("Error saving file. Please check the path.")}}openFileDialog(){this.explorerApp.open(async(l,f)=>{const d=await this.fs.getFileContent(l,f);this.open(f,d,l)})}}class ea{constructor(l){this.wm=l,this.stream=null,this.mediaRecorder=null,this.recordedChunks=[],this.recordings=[],this.recordingInterval=null,this.historyWin=null}open(){if(document.getElementById("camera-win")){this.wm.bringToFront(document.getElementById("camera-win"));return}const l=document.createElement("div");l.className="window",l.id="camera-win",l.dataset.fullscreen="false",l.innerHTML=`
      <div class="window-header">
        <span>Camera</span>
        ${this.wm.getWindowControls()}
      </div>
      <div style="padding:10px; display:flex; flex-direction:column; align-items:center; position:relative;">
        <div style="position:relative; width:100%; max-width:600px;">
          <video id="camera-video" autoplay playsinline style="width:100%; border:1px solid #ccc; border-radius:8px;"></video>
          <span id="recording-icon" style="position:absolute; top:10px; left:10px; width:15px; height:15px; border-radius:50%; background:red; display:none;"></span>
          <span id="recording-timer" style="position:absolute; top:10px; right:10px; font-weight:bold;"></span>
        </div>
        <div style="margin-top:10px; display:flex; gap:10px;">
          <button id="take-photo-btn" style="padding:5px 15px;">Take Photo</button>
          <button id="start-record-btn" style="padding:5px 15px;">Start Recording</button>
          <button id="stop-record-btn" style="padding:5px 15px;" disabled>Stop Recording</button>
          <button id="open-history-btn" style="padding:5px 15px;">History</button>
        </div>
        <a id="download-link" style="display:none; margin-top:10px;"></a>
      </div>
    `,Oe.appendChild(l),this.wm.makeDraggable(l),this.wm.makeResizable(l),this.wm.setupWindowControls(l),this.wm.addToTaskbar(l.id,"Camera","/static/icons/camera.svg"),l.querySelector(".close-btn").onclick=()=>{this.stopCamera(),l.remove(),this.historyWin&&this.historyWin.remove()},this.video=l.querySelector("#camera-video"),this.takePhotoBtn=l.querySelector("#take-photo-btn"),this.startRecordBtn=l.querySelector("#start-record-btn"),this.stopRecordBtn=l.querySelector("#stop-record-btn"),this.downloadLink=l.querySelector("#download-link"),this.recordingIcon=l.querySelector("#recording-icon"),this.recordingTimer=l.querySelector("#recording-timer"),this.historyBtn=l.querySelector("#open-history-btn"),l.style.width="50vw",l.style.height="70vh",l.style.left="25vw",l.style.top="15vh",this.startCamera(),this.takePhotoBtn.onclick=()=>this.takePhoto(),this.startRecordBtn.onclick=()=>this.startRecording(),this.stopRecordBtn.onclick=()=>this.stopRecording(),this.historyBtn.onclick=()=>this.openHistoryWindow()}async startCamera(){try{this.stream=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),this.video.srcObject=this.stream}catch(l){alert("Camera access denied or not available."),console.error(l)}}takePhoto(){const l=document.createElement("canvas");l.width=this.video.videoWidth,l.height=this.video.videoHeight,l.getContext("2d").drawImage(this.video,0,0);const f=l.toDataURL("image/png");this.downloadLink.href=f,this.downloadLink.download="photo.png",this.downloadLink.textContent="Download Photo",this.downloadLink.style.display="block"}startRecording(){this.stream&&(this.recordedChunks=[],this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.ondataavailable=l=>{l.data.size>0&&this.recordedChunks.push(l.data)},this.mediaRecorder.onstop=()=>{const l=new Blob(this.recordedChunks,{type:"video/webm"}),f=URL.createObjectURL(l);this.addRecording(f),this.downloadLink.href=f,this.downloadLink.download=`video-${Date.now()}.webm`,this.downloadLink.textContent="Download Video",this.downloadLink.style.display="block",this.historyWin&&this.renderHistory()},this.mediaRecorder.start(),this.startRecordBtn.disabled=!0,this.stopRecordBtn.disabled=!1,this.recordingIcon.style.display="block",this.startTimer())}stopRecording(){this.mediaRecorder&&this.mediaRecorder.state!=="inactive"&&(this.mediaRecorder.stop(),this.startRecordBtn.disabled=!1,this.stopRecordBtn.disabled=!0,this.recordingIcon.style.display="none",this.stopTimer())}startTimer(){let l=0;this.recordingTimer.textContent="00:00",this.recordingInterval=setInterval(()=>{l++;const f=String(Math.floor(l/60)).padStart(2,"0"),d=String(l%60).padStart(2,"0");this.recordingTimer.textContent=`${f}:${d}`},1e3)}stopTimer(){clearInterval(this.recordingInterval),this.recordingTimer.textContent=""}addRecording(l){this.recordings.unshift(l),this.recordings.length>5&&this.recordings.pop()}openHistoryWindow(){if(this.historyWin){this.wm.bringToFront(this.historyWin);return}this.historyWin=document.createElement("div"),this.historyWin.className="window",this.historyWin.id="history-win",this.historyWin.innerHTML=`
      <div class="window-header">
        <span>Recordings History</span>
        ${this.wm.getWindowControls()}
      </div>
      <div id="history-list" style="padding:10px; display:flex; flex-direction:column; gap:5px; overflow-y:auto; height:calc(100% - 30px);"></div>
    `,Oe.appendChild(this.historyWin),this.wm.makeDraggable(this.historyWin),this.wm.makeResizable(this.historyWin),this.wm.setupWindowControls(this.historyWin),this.wm.bringToFront(this.historyWin),this.historyWin.querySelector(".close-btn").onclick=()=>{this.historyWin.remove(),this.historyWin=null},this.historyWin.style.width="30vw",this.historyWin.style.height="50vh",this.historyWin.style.left="60vw",this.historyWin.style.top="20vh",this.renderHistory()}renderHistory(){if(!this.historyWin)return;const l=this.historyWin.querySelector("#history-list");l.innerHTML="",this.recordings.forEach((f,d)=>{const v=document.createElement("div");v.textContent=`Recording ${this.recordings.length-d}`,v.style.cursor="pointer",v.style.padding="5px",v.style.borderBottom="1px solid #ccc",v.onclick=()=>this.playRecording(f),l.appendChild(v)})}playRecording(l){const f=document.createElement("div");f.className="window",f.innerHTML=`
      <div class="window-header">
        <span>Playback</span>
        <div class="window-controls">
          <button class="close-btn">X</button>
        </div>
      </div>
      <video controls autoplay style="width:100%; height:90%;"></video>
    `,Oe.appendChild(f),this.wm.makeDraggable(f),this.wm.makeResizable(f),this.wm.bringToFront(f),f.querySelector(".close-btn").onclick=()=>f.remove();const d=f.querySelector("video");d.src=l,f.style.width="50vw",f.style.height="50vh",f.style.left="30vw",f.style.top="25vh"}stopCamera(){this.stream&&this.stream.getTracks().forEach(l=>l.stop())}}class na{constructor(){}open(l){if(document.getElementById("music-win")){console.log("bringing window to front"),l.bringToFront(document.getElementById("music-win"));return}console.log("Creating window");const f=l.createWindow("music-win","MUSIC");f.innerHTML=`
    <div class="window-header">
      <span>MUSIC</span>
      ${l.getWindowControls()}
    </div>
    <div class="window-content" style="width:100%; height:100%;">
      <div id="player-container" style="display:flex; flex-direction:column; align-items:center; gap:10px; padding:10px;"></div>
      </div>
    </div>`,Gn.appendChild(f),ze.renderMusicPage(document.getElementById("player-container")),l.makeDraggable(f),l.makeResizable(f),l.setupWindowControls(f),l.addToTaskbar(f.id,"MUSIC","/static/icons/music.png")}}class ia{constructor(l){this.appLauncher=l,this.desktop=document.getElementById("desktop"),this.startButton=document.getElementById("start-button"),this.startMenu=document.getElementById("start-menu"),this.contextMenu=document.getElementById("context-menu"),this.selectionBox=document.getElementById("selection-box"),this.clipboardCurrentCopied=null,this.isDragging=!1,this.draggedIcons=[],this.dragOffsets=[],this.setupEventListeners()}setupEventListeners(){this.startButton.addEventListener("click",l=>{l.stopPropagation(),this.startMenu.style.display=this.startMenu.style.display==="flex"?"none":"flex",hi(this.appLauncher)}),this.startMenu.addEventListener("click",l=>l.stopPropagation()),document.addEventListener("click",()=>{this.startMenu.style.display="none",this.contextMenu.style.display="none"}),this.desktop.addEventListener("contextmenu",l=>{l.target.classList.contains("selectable")?(l.preventDefault(),this.showIconContextMenu(l,l.target)):l.target===this.desktop&&(l.preventDefault(),this.showDesktopContextMenu(l))}),this.setupIconHandlers(),this.setupSelectionBox(),this.setupStartMenu()}setupIconHandlers(){document.querySelectorAll(".icon.selectable").forEach(l=>{this.makeIconDraggable(l)})}makeIconDraggable(l){l.draggable=!1,Object.assign(l.style,{userSelect:"none",webkitUserDrag:"none"}),l.addEventListener("dblclick",d=>{d.stopPropagation(),this.appLauncher.launch(l.dataset.app,l)});let f={x:0,y:0};l.addEventListener("mousedown",d=>{f={x:d.clientX,y:d.clientY},d.ctrlKey?l.classList.toggle("selected"):l.classList.contains("selected")||(document.querySelectorAll(".icon.selectable").forEach(E=>E.classList.remove("selected")),l.classList.add("selected"));const v=Array.from(document.querySelectorAll(".icon.selectable.selected"));this.draggedIcons=v,this.dragOffsets=v.map(E=>({x:d.clientX-E.offsetLeft,y:d.clientY-E.offsetTop}));const g=E=>{Math.sqrt(Math.pow(E.clientX-f.x,2)+Math.pow(E.clientY-f.y,2))>5&&!this.isDragging&&(this.isDragging=!0,this.draggedIcons.forEach(w=>{w.style.opacity="0.7",w.style.zIndex="1000"})),this.isDragging&&this.draggedIcons.forEach((w,m)=>{const a=E.clientX-this.dragOffsets[m].x,b=E.clientY-this.dragOffsets[m].y;w.style.left=`${Math.max(0,a)}px`,w.style.top=`${Math.max(0,b)}px`})},R=()=>{this.isDragging&&(this.draggedIcons.forEach(m=>{const a=parseInt(m.style.left),b=parseInt(m.style.top),u=85,N=105;let L=Math.round(a/u)*u+5,O=Math.round(b/N)*N+5;for(;this.isPositionOccupied(L,O,m);){const C=this.desktop.clientHeight;O+=N,O+100>C&&(O=5,L+=u)}m.style.left=`${L}px`,m.style.top=`${O}px`,m.style.opacity="1",m.style.zIndex="1"}),this.isDragging=!1),this.draggedIcons=[],this.dragOffsets=[],document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",R)};document.addEventListener("mousemove",g),document.addEventListener("mouseup",R)})}isPositionOccupied(l,f,d){const v=Array.from(document.querySelectorAll(".icon.selectable")),g=10;return v.some(R=>{if(R===d)return!1;const E=parseInt(R.style.left)||0,k=parseInt(R.style.top)||0;return Math.abs(E-l)<g&&Math.abs(k-f)<g})}showIconContextMenu(l,f){const d=Array.from(document.querySelectorAll(".icon.selectable.selected"));d.includes(f)||(document.querySelectorAll(".icon.selectable").forEach(g=>g.classList.remove("selected")),f.classList.add("selected"));const v=Array.from(document.querySelectorAll(".icon.selectable.selected")).pop();this.contextMenu.innerHTML=`
      <div id="ctx-open">Open</div>
      <div id="ctx-cut">Cut</div>
      <div id="ctx-copy">Copy</div>
      <div id="ctx-delete">Delete</div>
      <div id="ctx-properties">Properties</div>
    `,document.getElementById("ctx-open").onclick=()=>{this.contextMenu.style.display="none",this.appLauncher.launch(v.dataset.app,v)},document.getElementById("ctx-cut").onclick=()=>{this.clipboardCurrentCopied={action:"cut",icons:d.map(g=>({element:g,data:{app:g.dataset.app,name:g.dataset.name,path:g.dataset.path,innerHTML:g.innerHTML,className:g.className}}))},this.contextMenu.style.display="none"},document.getElementById("ctx-copy").onclick=()=>{this.clipboardCurrentCopied={action:"copy",icons:d.map(g=>({data:{app:g.dataset.app,name:g.dataset.name,path:g.dataset.path,innerHTML:g.innerHTML,className:g.className}}))},this.contextMenu.style.display="none"},document.getElementById("ctx-delete").onclick=()=>{d.forEach(g=>{g.remove()}),this.contextMenu.style.display="none"},document.getElementById("ctx-properties").onclick=()=>{this.showPropertiesDialog(v),this.contextMenu.style.display="none"},Object.assign(this.contextMenu.style,{left:`${l.pageX}px`,top:`${l.pageY}px`,display:"block"})}showPropertiesDialog(l){const f=l.id||`icon-${Date.now()}`,d=l.dataset,v=l.getBoundingClientRect(),g=d.app,R=this.appLauncher?.appMap?.[g]||{},k=[`Name: ${d.name||"Unknown"}`,`Type: ${d.app||"Application"}`,d.path?`Path: ${d.path}`:"",R.type?`App Type: ${R.type}`:"",R.swf?`SWF Path: ${R.swf}`:"",R.url?`URL: ${R.url}`:"",d.core?`Core: ${d.core}`:"",`Width: ${Math.round(v.width)}px`,`Height: ${Math.round(v.height)}px`,`Left: ${Math.round(v.left)}px`,`Top: ${Math.round(v.top)}px`,`Z-Index: ${l.style.zIndex||"0"}`].filter(Boolean).map(m=>`<div style="margin:2px 0;">${m}</div>`).join(""),w=this.appLauncher.wm.createWindow(`${f}-props`,`Properties: ${d.name||"Unknown"}`,"300px","auto");w.innerHTML=`
        <div class="window-header">
            <span>Properties: ${d.name||"Unknown"}</span>
            <div class="window-controls">
                <button class="minimize-btn" title="Minimize">−</button>
                <button class="maximize-btn" title="Maximize">□</button>
                <button class="close-btn" title="Close">X</button>
            </div>
        </div>
        <div class="window-content" style="width:100%; height:100%; overflow:auto; user-select:text; padding:10px;">
            ${k}
        </div>
    `,Gn.appendChild(w),this.appLauncher.wm.makeDraggable(w),this.appLauncher.wm.makeResizable(w),this.appLauncher.wm.setupWindowControls(w)}showDesktopContextMenu(l){const f=['<div id="ctx-new-notepad">New Notepad</div>','<div id="ctx-open-explorer">Open File Explorer</div>'];this.clipboardCurrentCopied&&f.push('<div id="ctx-paste">Paste</div>'),f.push("<hr>",'<div id="ctx-refresh">Refresh</div>'),this.contextMenu.innerHTML=f.join(""),document.getElementById("ctx-new-notepad").onclick=()=>{this.contextMenu.style.display="none",kn.open()},document.getElementById("ctx-open-explorer").onclick=()=>{this.contextMenu.style.display="none",ze.open()},this.clipboardCurrentCopied&&(document.getElementById("ctx-paste").onclick=()=>{this.pasteIcons(l.pageX,l.pageY),this.contextMenu.style.display="none"}),document.getElementById("ctx-refresh").onclick=()=>{this.contextMenu.style.display="none",location.reload()},Object.assign(this.contextMenu.style,{left:`${l.pageX}px`,top:`${l.pageY}px`,display:"block"})}pasteIcons(l,f){if(!this.clipboardCurrentCopied)return;const{action:d,icons:v}=this.clipboardCurrentCopied;v.forEach((g,R)=>{const E=document.createElement("div");E.className=g.data.className,E.innerHTML=g.data.innerHTML,E.dataset.app=g.data.app,E.dataset.name=g.data.name,E.dataset.path=g.data.path,Object.assign(E.style,{position:"absolute",left:`${l+R*10}px`,top:`${f+R*10}px`,userSelect:"none",webkitUserDrag:"none"}),this.makeIconDraggable(E),this.desktop.appendChild(E),d==="cut"&&g.element&&g.element.remove()}),d==="cut"&&(this.clipboardCurrentCopied=null)}setupSelectionBox(){let l,f;this.desktop.addEventListener("mousedown",d=>{if(d.target!==this.desktop)return;l=d.pageX,f=d.pageY,Object.assign(this.selectionBox.style,{left:`${l}px`,top:`${f}px`,width:"0px",height:"0px",display:"block"});const v=document.querySelectorAll(".icon.selectable");v.forEach(E=>E.classList.remove("selected"));const g=E=>{const k=Math.abs(E.pageX-l),w=Math.abs(E.pageY-f),m=Math.min(E.pageX,l),a=Math.min(E.pageY,f);Object.assign(this.selectionBox.style,{width:`${k}px`,height:`${w}px`,left:`${m}px`,top:`${a}px`});const b=this.selectionBox.getBoundingClientRect();v.forEach(u=>{const N=u.getBoundingClientRect();!(N.right<b.left||N.left>b.right||N.bottom<b.top||N.top>b.bottom)?u.classList.add("selected"):u.classList.remove("selected")})},R=()=>{this.selectionBox.style.display="none",document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",R)};document.addEventListener("mousemove",g),document.addEventListener("mouseup",R)})}setupStartMenu(){this.startMenu.querySelectorAll(".start-item").forEach(l=>{l.onclick=f=>{f.stopPropagation();const d=l.dataset.app;d==="documents"?(ze.open(),ze.navigate(["home","reeyuki","Documents"])):d==="pictures"?(ze.open(),ze.navigate(["home","reeyuki","Pictures"])):d==="notes"&&kn.open(),this.startMenu.style.display="none"}})}}const Gn=document.getElementById("desktop"),Xn=new js,fn=new Gs,kn=new ta(Xn,fn,null),ze=new Ws(Xn,fn,kn),ra=new Xs(fn);kn.setExplorer(ze);const oa=new Ms(Xn,fn),sa=new na,aa=new ea(fn),Mr=new $s(fn,Xn,sa,ze,oa,kn,ra,aa);new ia(Mr);fi.startClock();fi.setRandomWallpaper();const ca=window.location.search,la=new URLSearchParams(ca),Lr=la.get("game");Lr&&setTimeout(()=>{Mr.launch(Lr)},100);const ua=Gn.querySelectorAll(".icon");function Pr(){const rt=Gn.clientHeight,l=80,f=100,d=5;let v=d,g=d;ua.forEach(R=>{(!R.style.left||!R.style.top)&&(R.style.position="absolute",R.style.left=`${v}px`,R.style.top=`${g}px`,g+=f+d,g+f>rt&&(g=d,v+=l+d))})}window.addEventListener("load",Pr);window.addEventListener("resize",Pr);console.log("Howdy, devtools user! the source of this site is available at: https://github.com/Reeyuki/reeyuki.github.io");Ks();As({immediate:!0});
